var _____WB$wombat$assign$function_____ = function(name) {return (self._wb_wombat && self._wb_wombat.local_init && self._wb_wombat.local_init(name)) || self[name]; };
if (!self.__WB_pmw) { self.__WB_pmw = function(obj) { this.__WB_source = obj; return this; } }
{
  let window = _____WB$wombat$assign$function_____("window");
  let self = _____WB$wombat$assign$function_____("self");
  let document = _____WB$wombat$assign$function_____("document");
  let location = _____WB$wombat$assign$function_____("location");
  let top = _____WB$wombat$assign$function_____("top");
  let parent = _____WB$wombat$assign$function_____("parent");
  let frames = _____WB$wombat$assign$function_____("frames");
  let opener = _____WB$wombat$assign$function_____("opener");

!function(){var t=function(){this._callbackArray=[]};t.prototype={add:function(t){return"function"!=typeof t||this.has(t)?!1:(this._callbackArray.push(t),t)},remove:function(t){if("function"==typeof t){var n=this.index(t);if(n>-1)return t=this._callbackArray.splice(n,1)}return!1},has:function(t){return this.index(t)>-1},index:function(t){if(this._callbackArray)for(var n=0,r=this._callbackArray.length;r>n;n++)if(t===this._callbackArray[n])return n;return-1},fire:function(){}};var n=function(){};n.prototype=new t,n.prototype.fire=function(t,n){for(var r=0,e=this._callbackArray.length,i=$.extend({},n);e>r;r++){var a=this._callbackArray[r],o=a(t,i);"object"==typeof o&&(i=$.extend({},i,o))}return i};var r=function(){};r.prototype=new t,r.prototype.fire=function(t){for(var n=0,r=this._callbackArray.length;r>n;n++){var e=this._callbackArray[n],i=e(t);if("string"==typeof i&&i.length)return i;if("string"==typeof i&&0===i.length)return"NOT_SHOW_WARNING"}return""};var e=$.Callbacks("unique"),i=$.Callbacks("unique"),a=new n,o=new r;_.Module.define({path:"poster/widget/post_manager",sub:{initial:function(){},addPostSuccess:function(t){return"function"==typeof t?(e.add(t),!0):!1},firePostSuccess:function(t){var n=$.extend({},PosterContext,t);e.fire(n)},addEditorReady:function(t){return"function"==typeof t?(i.add(t),!0):!1},fireEditorReady:function(t){i.fire(t)},addPostDataProcess:function(t){return"function"==typeof t?(a.add(t),!0):!1},firePostDataProcess:function(t,n){return a.fire(t,n)},addPostValidate:function(t){return"function"==typeof t?(o.add(t),!0):!1},firePostValidate:function(t){return o.fire(t)}}})}(window);_.Module.define({path:"bawu/widget/complaint_bar_owner/complaint_bar_owner_template",sub:{wrapper:['<div class="complaint_wrapper">','    <div class="complaint_hd">',"        <p>",'            <span class="required_symbol">*</span> \u60a8\u7684\u6295\u8bc9\u4fe1\u606f\u53ea\u6709\u7ba1\u7406\u5458\u548c\u60a8\u81ea\u5df1\u80fd\u770b\u5230\uff0c\u5176\u4ed6\u7528\u6237\u65e0\u6cd5\u83b7\u53d6\uff0c\u8bf7\u60a8\u653e\u5fc3\u6295\u8bc9\u3002',"        </p>","    </div>",'    <div class="complaint_bd">','        <div class="row">','            <label class="label">\u5427\u4e3bID\uff1a</label>',"        <% if (uname) { %>",'            <input class="bar_owner_id j_bar_owner_id text_readonly" readonly  value="<%=uname%>" type="text">',"        <%} else {%>",'            <input class="bar_owner_id j_bar_owner_id" value="" type="text">',"        <% } %>","        </div>",'        <div class="id_remind"></div>','        <div class="container_layer bar_type j_bar_type">',"        </div>",'        <div class="row">','            <label class="label">\u6295\u8bc9\u7c7b\u578b\uff1a</label>',"        </div>",'        <div class="row j_complaint_type">','            <input id="type5" type="radio" name="reason" class="radio first_radio" value="illegal_delpost">','            <label for="type5">\u5427\u4e3b\u8fdd\u89c4\u5c01\u7981\u5220\u5e16</label>','            <input id="type6" type="radio" name="reason" class="radio" value="illegal_addpost">','            <label for="type6">\u5427\u4e3b\u8fdd\u89c4\u53d1\u8d34\u64cd\u4f5c</label>','            <input id="type7" type="radio" name="reason" class="radio" value="illegal_interest">','            <label for="type7">\u5427\u4e3b\u6d89\u5acc\u8c0b\u79c1\u83b7\u5229</label><br>','            <input id="type8" type="radio" name="reason" class="radio first_radio" value="illegal_post_info">','            <label for="type8">\u5427\u5185\u5b58\u5728\u5927\u91cf\u8fdd\u89c4\u4fe1\u606f</label>','            <input id="type3" type="radio"  name="reason" class="radio" value="sex">','            <label for="type3">\u5427\u5185\u5b58\u5728\u9ec4\u8272\u7b49\u8fdd\u6cd5\u4fe1\u606f</label><br>','            <input id="type4" type="radio" name="reason"  class="radio first_radio" value="else">','            <label for="type4">\u5427\u4e3b\u5176\u4ed6\u8fdd\u89c4\u884c\u4e3a</label>','            <input id="type1" type="radio" name="reason" class="radio" value="nologin">','            <label for="type1">\u5427\u4e3b\u957f\u671f\u672a\u767b\u5f55</label>',"        </div>",'        <div class="container_layer complaint_reason j_complaint_reason">','            <span class="arrow"></span>','            <div class="container_hd"></div>','            <div class="container_bd">','                <label><span class="required_symbol">*</span>\u6295\u8bc9\u7406\u7531\uff1a</label>  <span></span>','                <textarea class="textarea" id="" name="" cols="30" rows="10"></textarea>',"            </div>",'            <div class="container_ft"></div>',"        </div>","    </div>",'    <div class="complaint_ft">','        <a class="submit_btn j_submit_btn disable"  href="javascript:;">\u63d0\u4ea4</a>',"    </div>","</div>"].join(""),barItem:['<span class="arrow"></span>','<div class="container_hd"></div>','<div class="container_bd">','   <label><span class="required_symbol">*</span>\u8d34\u5427\u540d\u79f0\uff1a</label>','<div class="radio_panel">',"<% for (var i = 0; i < roles.length; i++) {%>",'   <input type="radio" id="forum<%=i%>" name="type" <% if (i === 0 && roles.length === 1) {%> checked=true<%}%> class="radio" value="<%=roles[i]["forum_id"] %>" data-name="<%=roles[i]["forum_name"] %>" >','   <label title="<%:=roles[i]["forum_name"] %>" for="forum<%=i%>"><%:=roles[i]["forum_name"] %></label>',"   <% if (i === 2) {%>","       </br>","    <%}%>","<% } %>","</div>","</div>",'<div class="container_ft"></div>'].join(""),success:['<div class="complaint_success">','   <h3 class="title">\u6295\u8bc9\u4fe1\u606f\u63d0\u4ea4\u6210\u529f</h3>','   <div class="j_result">\u6211\u4eec\u5c06\u5728\u5ba1\u6838\u5b8c\u6bd5\u540e2-3\u4e2a\u5de5\u4f5c\u65e5\u5185\u5904\u7406\u60a8\u7684\u6295\u8bc9\u3002\u5904\u7406\u7ed3\u679c\u5c06\u901a\u8fc7','       <a href="https://web.archive.org/web/20201117141157/http://msg.baidu.com/msg/sys#msgcontent" target="_blank">\u7cfb\u7edf\u901a\u77e5</a>\u53d1\u9001\u7ed9\u60a8\u3002\u60a8\u4e5f\u53ef\u4ee5\u53bb<a target="_blank" href="//web.archive.org/web/20201117141157/https://tieba.baidu.com/f?kw=%e5%85%a8%e6%b0%91%e4%b8%be%e6%8a%a5&fr=ala0">\u5168\u6c11\u4e3e\u62a5\u5427</a>\u53cd\u9988\u95ee\u9898\u3002',"   </div>",'   <a class="j_close_btn close_btn"  href="javascript:;">\u5173\u95ed</a>',"</div>"].join(""),fail:['<div class="complaint_fail">','   <h3 class="title">\u6295\u8bc9\u4fe1\u606f\u63d0\u4ea4\u5931\u8d25</h3>','   <div class="j_result">','       <p class="j_error_remind error_remind"></p>','       <a class="j_back_btn"  href="javascript:;">\u8fd4\u56de</a>\u4e0a\u4e00\u7ea7\u9875\u9762<br/>\u60a8\u53ef\u4ee5\u53bb','       <a target="_blank" href="//web.archive.org/web/20201117141157/https://tieba.baidu.com/f?kw=%CC%F9%B0%C9%BC%E0%BF%D8&fr=ala0">\u8d34\u5427\u76d1\u63a7\u5427</a>\u53cd\u9988\u95ee\u9898\u3002',"   </div>",'   <a class="j_close_btn close_btn"  href="javascript:;">\u5173\u95ed</a>',"</div>"].join("")}}),_.Module.define({path:"bawu/widget/complaint_bar_owner",requires:["bawu/widget/complaint_bar_owner/complaint_bar_owner_template"],sub:{isAddDialogTop:!1,initial:function(a){this.options=$.extend({uname:""},a),this.template=this.requireInstance("bawu/widget/complaint_bar_owner/complaint_bar_owner_template"),this.complaintWrapperTemplate=baidu.template(this.template.wrapper,this.options),this.complaintFailTemplate=this.template.fail,this.complaintSuccessTemplate=this.template.success,this.barItemTemplate=this.template.barItem,this.defaultFormData={manager_uid:"",manager_uname:"",forum_id:"",forum_name:"",complaint_type:"",reason:"",tbs:PageData.tbs},this.initDialog(),this._bindEvent()},initDialog:function(){if(this.$dialog)this.$dialog.setContent(this.complaintWrapperTemplate);else{this.$dialog=new $.dialog({html:this.complaintWrapperTemplate,title:"\u6295\u8bc9\u5427\u4e3b",show:!1,width:500,holderClassName:"complaint_bar_owner_dialog"});var a=this;this.$dialog.bind("onclose",function(e){return e.stopImmediatePropagation(),a.$dialog.hide(),!1});var e=this.$dialog.hide;this.$dialogElement=this.$dialog.element,this.$dialogElement.css("z-index",51e3),this.$dialog.hide=function(){a.isAddDialogTop&&(a.$dialogElement.css("top",parseInt(a.$dialogElement.css("top"),10)+70),a.isAddDialogTop=!1),e.call(a.$dialog)}}this.$submitBtn=this.$dialogElement.find(".submit_btn"),this.$barTypeList=this.$dialogElement.find(".j_bar_type"),this.$complaintReasonLayer=this.$dialogElement.find(".j_complaint_reason"),this.formData=$.extend({},this.defaultFormData)},_bindEvent:function(){var a=this,e=a.$dialogElement;e.on("blur",".j_bar_owner_id",function(e){var t=$(e.currentTarget),i=$.trim(t.val());a.checkBarOwnerName(i)}).on("keyup",".j_complaint_reason .textarea",function(e){var t=$(e.currentTarget);a.formData.reason=window.encodeURI($.trim(t.val())),a.checkCanSubmit()}).delegate(".radio","click",function(t){var i=$(t.currentTarget);"type"===i.tbattr("name")?(a.formData.forum_id=i.val(),a.formData.forum_name=window.encodeURI(i.data("name"))):(a.$complaintReasonLayer.show(),a.formData.complaint_type=i.val(),a.isAddDialogTop||(e.css("top",parseInt(e.css("top"),10)-70),a.isAddDialogTop=!0)),a.checkCanSubmit()}).delegate(".j_submit_btn","click",function(){if(a.checkCanSubmit()){var e=a.formData;$.post("/pmc/tousu/commitTousu",e,function(e){var t;if(t=0===e.errno?a.complaintSuccessTemplate:a.complaintFailTemplate,a.$resultDialog?a.$resultDialog.setContent(t):(a.$resultDialog=new $.dialog({html:t,title:"\u6295\u8bc9\u5427\u4e3b",show:!1,width:500}),a.$resultDialog.element.delegate(".j_back_btn","click",function(){a.$dialog.show(),a.$resultDialog.hide()}).delegate(".j_close_btn","click",function(){a.$dialog.hide(),a.$resultDialog.hide(),a.formData=$.extend({},this.defaultFormData)}).bind("onclose",function(e){return e.stopImmediatePropagation(),a.$resultDialog.hide(),!1})),e.data&&e.data.text){var i=a.$resultDialog.element.find(".j_result")[0];i.innerHTML=a.htmlDecode(e.data.text)}a.$resultDialog.show(),a.$dialog.hide()},"json")}})},checkBarOwnerName:function(a){var e=this;return a?(a=window.encodeURI(a),void $.get("/pmc/tousu/getRole",{manager_uname:a},function(t){var i=$.extend({},e.defaultFormData),l=t.data,s=t.errno;if(0===s)i={manager_uid:l.manager_uid,manager_uname:a},e.$barTypeList.html(baidu.template(e.barItemTemplate,l)),e.$dialogElement.removeClass("check_error"),1===l.roles.length&&(i.forum_id=l.roles[0].forum_id,i.forum_name=window.encodeURI($("<span>"+l.roles[0].forum_name+"</span>").text()));else{var o={207:"\u8be5\u5427\u4e3b\u4e3a\u5b98\u65b9\u6307\u5b9a\u5427\u4e3b\uff0c\u6709\u4e13\u95e8\u4eba\u5458\u8fdb\u884c\u76d1\u7763\uff0c\u76ee\u524d\u4e0d\u63a5\u53d7\u7528\u6237</br>\u6295\u8bc9\u54e6~",204:"\u6b64\u4eba\u4e0d\u662f\u5427\u4e3b\u54e6~"},n=e.$dialogElement.find(".id_remind");e.$dialogElement.addClass("check_error"),o[s]&&n.html(o[s]),e.$barTypeList.html("")}$.extend(e.formData,i),e.checkCanSubmit()},"json")):(e.formData.manager_uname="",e.$barTypeList.html(""),void e.checkCanSubmit())},checkCanSubmit:function(){var a=this;for(var e in a.formData)if(a.formData.hasOwnProperty(e)){var t=a.formData[e];if(void 0!==t&&""===t)return a.$submitBtn.removeClass("j_submit_btn").addClass("disable"),!1}return a.$submitBtn.removeClass("disable").addClass("j_submit_btn"),!0},showDialog:function(){this.initDialog(),this.$dialog.show(),this.options&&this.options.uname&&this.checkBarOwnerName(this.options.uname)},htmlDecode:function(a){var e="";return 0===a.length?"":(e=a.replace(/&lt;/g,"<"),e=e.replace(/&gt;/g,">"),e=e.replace(/&nbsp;/g," "),e=e.replace(/&#39;/g,"'"),e=e.replace(/&quot;/g,'"'),e=e.replace(/<br>/g,"\n"))}}});_.Module.define({path:"poster/widget/rich_poster",requires:["tbui/widget/bubble_tip","tbui/widget/login_dialog","bawu/widget/complaint_bar_owner","poster/widget/post_manager","tbui/widget/placeholder","tbui/widget/word_limit","poster/widget/post_prefix","poster/widget/topic_suggestion","poster/widget/post_service","poster/widget/share_thread","poster/widget/mouse_pwd","poster/widget/post_signature","encourage-payment/widget/pay_member","yunying/widget/snowflow"],sub:{_options:{},_windowScrollTimer:"",_windowHeight:0,_payMemberTpl:'<a href="javascript:;" class="j-placeholder-pay-member" style="color:#999; text-decoration:none;margin-left: 80px;margin-top:12px;display:block;">\u5f00\u901a\u8d85\u7ea7\u4f1a\u5458\u53d1\u8d346\u500d\u7ecf\u9a8c</a>',_olympicTpl:'<a href="javascript:;" class="j-placeholder-olympic" style="color:#999; text-decoration:none;font-size:14px;display:block;">\u4e00\u697c\u732e\u7ed9\u56fd\u5bb6</a>',tbsUrl:"//web.archive.org/web/20201117141157/https://tieba.baidu.com/dc/common/imgtbs",uploadUrl:"https:"===$.tb.location.getProtocol()?"https://web.archive.org/web/20201117141157/https://uploadphotos.baidu.com/upload/pic":"https://web.archive.org/web/20201117141157/http://upload.tieba.baidu.com/upload/pic",PIC_URL_PATH:"/forum/pic/item/",isOlympic:function(){var t=(new Date).setHours(0,0,0,0),e=new Date("2016/8/6").setHours(0,0,0,0);return t===e},initial:function(t){if(this.initUploadUrl(),"frs"===PosterContext.getContext().product&&"1"==PosterContext.context.is_zone_forum&&"1"!=PosterContext.context.is_user_has_zone_right){var e=document.getElementById("j_use_core_icon"),i=document.getElementById("j_use_core_cont");document.getElementById("j_use_core_x").onclick=function(){i.style.display="none"},e.onmouseover=function(){i.style.display="block"}}this.initData(t),this.bindInitEvent()},initData:function(t){this._options=t,this._windowHeight=screen.height},bindInitEvent:function(){this.bindTabChange(),this.bindWannaPost(),this.bindTousuEvent(),this.bindScrollEvent()},initBubbleTips:function(){try{!localStorage.getItem("postShareForFRS")&&this.initShareTips(),!localStorage.getItem("postFullscreenForFRS")&&this.initFullScreen()}catch(t){}},initShareTips:function(){var t={arrow_dir:"down",bubble_css:{top:-45,left:0,width:200,height:50,zIndex:6e4},arrow_pos:{},wrap:$(".j_poster_share"),closeBtn:!0,content:"\u52fe\u9009\u6b64\u5904\uff0c\u53d1\u8868\u540e\u9a6c\u4e0a\u5206\u4eab\u672c\u8d34~"},e=this;this.$root.find("#ueditor_replace").one("click",function(){self._shareBubble=e.requireInstance("tbui/widget/bubble_tip",[t]),self._shareBubble.showBubble(),localStorage.setItem("postShareForFRS",1),e.addShareTipsEvents()})},initFullScreen:function(){var t={arrow_dir:"up",bubble_css:{top:30,right:-10,width:150,height:50,zIndex:6e4},arrow_pos:{right:10},wrap:$(".edui-btn-toolbar"),closeBtn:!0,content:"\u5168\u5c4f\u53d1\u8d34\u4f53\u9a8c\u4f1a\u66f4\u597d\u54e6~"};self._fullscreenBubble=this.requireInstance("tbui/widget/bubble_tip",[t]),self._fullscreenBubble.showBubble(),localStorage.setItem("postFullscreenForFRS",1),this.bindFullScreenEvent()},bindFullScreenEvent:function(){$editorContainer=this.$root.find(".ueditor_container"),$editorContainer.on("onSetFullScreen",function(){self._fullscreenBubble&&self._fullscreenBubble.closeBubble()})},addShareTipsEvents:function(){$(".j_use_share").on("change",function(){self._shareBubble&&self._shareBubble.closeBubble()})},isInitPage:0,bindTabChange:function(){var t=this,e=this._options.pagelet;this.isInitPage="frs"===this._options.initPage||"category"===this._options.initPage||"main"===this._options.initPage||"corearea"===this._options.initPage,e&&e.on("tab_change",function(e){var i=e.tab||"frs";t.isInitPage="frs"===i||"category"===i||"main"===this._options.initPage||"corearea"===this._options.initPage})},bindWannaPost:function(){var t=this;this.observe("wanna_post",function(){PosterContext.getAuthorities().float_editor?t.enableFloatingPoster():$(window).scrollTop($("body").height()),setTimeout(function(){t.focus()},300)})},bindTousuEvent:function(){var t=this;$("#frs_footer_tieba_report").on("click",function(e){if(PageData.user.is_login){var i=t.requireInstance("bawu/widget/complaint_bar_owner");i.showDialog()}else e.preventDefault(),t.requireInstance("tbui/widget/login_dialog")})},bindScrollEvent:function(){var t=this;$("body").height()<=2*t._windowHeight&&this.isInitPage?t.init():$(window).bind("scroll",[t],t.scrollHandler)},unbindScrollEvent:function(){var t=this;$(window).unbind("scroll",t.scrollHandler)},scrollHandler:function(t){var e=t.data[0];e._windowScrollTimer&&clearTimeout(e._windowScrollTimer),e._windowScrollTimer=setTimeout(function(){$(window).scrollTop()+2*e._windowHeight>=$("body").height()&&e.isInitPage&&(e.init(),e.unbindScrollEvent())},200)},init:function(){var t=$("#tb_rich_poster_container"),e=this._options;this.$container=t,this.$root=t.find("#rich_ueditor_tpl"),this.$window=$(window),this.$editorContainer=this.$root.find(".ueditor_container"),this.prefix=e.prefix,this.hotTopic=e.hotTopic?"#"+e.hotTopic+"#":e.hotTopic,this.feedback=e.feedback,this.isFrs="frs"===PosterContext.getContext().product,this.isPb="pb"===PosterContext.getContext().product,this.isQinglang=e.isQinglang,this.QinglangData=e.QinglangData,this.redirectAfterPost=e.redirectAfterPost||!1,this.hideHolder=0,this.user=$.extend({memberLevel:0},e.user),this.postManager=this.requireInstance("poster/widget/post_manager"),this.isFrs&&(this.$title=this.$root.find(".j_title"),this.initTitle()),this.initPostService(),this.initDraft(),this.initEditor(),this.initEditorReady(),this.initAntiSpamming(),this.initEvent(),this.initPlaceHolder(),PosterContext.getAuthorities().long_editor&&this.initFloatingToolbar(),this.initMousePwd(),this.initBskUserBehavior(),this.initSignature(),this.initOther()},initOther:function(){if(PosterContext.context.user.isLogin&&!PosterContext.isPostAllowed())$.browser.msie&&6==$.browser.version||this.editor.ready(function(){this.disable()}),this.showWarning(PosterContext.getPostRejectedMessage()),this.toggleSubmitButton(!0),this.$title&&this.$title.tbprop("disabled",!0);else{if(this.isFrs){var t="";if(this.QinglangData&&this.QinglangData.title)t=this.QinglangData.title;else{var e=this.user.memberLevel?"\u4eb2\u7231\u7684\u4f1a\u5458\uff0c\u8bf7\u8f93\u5165\u60a8\u7684\u6807\u9898":"\u8bf7\u586b\u5199\u6807\u9898";t=e}this.requireInstance("tbui/widget/placeholder",[this.$title,t,{color:"#bfbfbf"}])}this.editor.ready(function(){this.restoreDraft()})}this.initBubbleTips()},initTitle:function(){this.initTitleWordLimit(),this.initTitlePrefix(),this.initTitleTopic(),this.hotTopic&&this.$title.val(this.hotTopic)},initTitleWordLimit:function(){var t=this,e=$("#tb_rich_poster"),i={inputObj:this.$title,checkDelay:200,showLimit:10,maxNum:60,isLimitInput:!0},o=this.requireInstance("tbui/widget/word_limit",i);o.init(),o.bind("wlshowing",function(){$("html").hasClass("tb-ueditor-fullscreen")||(e.find(".j_surveillance").hide(),t.$root.hasClass("tb_floating_poster")&&o.holder.css("zIndex",1e4))}),o.bind("wlhiding",function(){$("html").hasClass("tb-ueditor-fullscreen")||(e.find(".j_surveillance").show(),o.holder.css("zIndex","auto"))})},initTitlePrefix:function(){var t={$target:this.$title,prefix:this.prefix,hotTopic:this.hotTopic};this.requireInstance("poster/widget/post_prefix",t)},initTitleTopic:function(t){t||this.requireInstance("poster/widget/topic_suggestion",{$input:this.$root.find(".j_topic_sug_input"),$btn:this.$root.find(".j_topic_add_btn")})},initPostService:function(){{var t=this;!(!window.history||!window.history.pushState)}this.postService=this.requireInstance("poster/widget/post_service",[t._options.blockInfo]),this.postService.success(function(e,i){$.stats.track("frs\u53d1\u8868\u6309\u94ae\u70b9\u51fb\u91cf","\u65b0\u53d1\u8d34\u4f18\u5316\u7edf\u8ba1","frs","click"),t.editor.setContent(""),t.editor.clearDraft(),t.showPostSuccess(),t.initTitle(),t.postManager.firePostSuccess({context:PosterContext,response:i});var o=Math.ceil(10*Math.random());o>8&&($.stats.track("pb-list\u6700\u4e0b_F90","PC\u7aef\u5f69\u7968pb\u53d1\u5e16\u8bd5\u9a8c","pb","view",{obj_url:"//web.archive.org/web/20201117141157/https://tb1.bdstatic.com/tb/cms/com/icon/F90_icon.gif"}),$.tb.Storage.set("pb_show_ad_f90","Y",(new Date).getTime()+8e3)),setTimeout(function(){t.redirectAfterPost?$.tb.location.setHref(t.redirectAfterPost):t.successHandler()},1e3),setTimeout(function(){$(".tb_poster_info").remove(),t.togglePostState(!1);var e=$(window).scrollTop();e>0&&(window.scrollTo(0,1),setTimeout(function(){window.scrollTo(0,0)},0))},2e3);var s=i.data.is_thread_visible||0;s||setTimeout(function(){t.editor.execCommand("clearfullscreen");var e=$(".j_submit").data("fullscreen")||"\u9ed8\u8ba4";if($(".j_use_share").is(":checked")){$.stats.track("\u53d1\u5e16\u6210\u529f-\u9009\u4e2d\u5206\u4eab-"+e,"\u65b0\u53d1\u8d34\u4f18\u5316\u7edf\u8ba1","frs","view");var o=i.data,s=i.postData.title+"_"+o.fname+"\u5427_\u767e\u5ea6\u8d34\u5427#\u4e0a\u8d34\u5427\uff0c\u627e\u7ec4\u7ec7~#";t.shareThread=t.requireInstance("poster/widget/share_thread"),t.shareThread.setShareContent({desc:s,text:s,url:$.tb.location.getOrigin()+"/p/"+o.tid+"?ie=utf-8"})}else $.stats.track("\u53d1\u5e16\u6210\u529f-\u672a\u9009\u4e2d\u5206\u4eab"+e,"\u65b0\u53d1\u8d34\u4f18\u5316\u7edf\u8ba1","frs","view")},1e3),window._BSK.userBehavior.resetBSKUserBehaviorData(),window._BSK.userBehavior.bindBSKEvent(),t.initBskUserBehavior()}).complete(function(){t.togglePostState(!1)})},initDraft:function(){var t=this,e=this.$root.find(".j_draft"),i=e.children(".j_content"),o=e.children(".j_clear");this.$root.on("saved.draft",function(){i.text("\u4f60\u6b63\u5728\u8f93\u5165\u7684\u5185\u5bb9\u5df2\u81ea\u52a8\u4fdd\u5b58, "+$.dateFormat(new Date,"HH:mm:ss")),e.show()}),this.$root.on("restored.draft",function(){i.text("\u4f60\u4e0a\u6b21\u672a\u53d1\u8868\u7684\u5185\u5bb9\u5df2\u81ea\u52a8\u6062\u590d"),e.show()}),o.on("click",function(){t.editor.clearDraft(),t.editor.setContent(""),e.hide(),t.trigger("draft_clean")})},initEditor:function(){var t=2===this.user.memberLevel;if(t&&(this.hideHolder=1),PosterContext.isPostAllowed()){var e={};e.excludePlugins=["medal"],e.contentWidth=708,e.initialFrameWidth=720,PosterContext.getAuthorities().long_editor&&(e.autoFloatEnabled=!0,e.topOffset=this.isFrs?40:0,e.heightLimit=!1),this.editor=UE.getEditor("ueditor_replace",e)}else this.editor=UE.getEditor("ueditor_replace",{toolbar:"",contentWidth:708,initialFrameWidth:720});window.test_editor=this.editor,window.test_poster=this},initEditorReady:function(){var t=this;this.editor.ready(function(){t.postManager.fireEditorReady({editor:t.editor,context:PosterContext,poster:t})})},initAntiSpamming:function(){},initEvent:function(){var t=this,e=this.$root.find(".ueditor_container .j_error");this.$submit=this.$root.find(".j_submit").click(function(i){e.text("").show(),i.preventDefault(),t.$submit.is(".btn_disable")||(window._BSK.userBehavior.sendByClick=!0,t.MousePwd.MOUSEPWD_CLICK=1,t.post())}),this.$root.on("keyup",function(e){e.ctrlKey&&13==e.keyCode&&(window._BSK.userBehavior.sendByKeyBoard=!0,t.post())}),this.$root.find(".add_vote_btn").click(function(){if(!PosterContext.getContext().user.canVote){var t=PosterContext.getContext().forum.nameEncoded;return $.tb.alert({title:"\u53d1\u8d77\u6295\u7968",message:'\u83b7\u5f97<a target="_blank" href="/f/like/level?ie=utf8&kw='+t+'">3\u7ea7\u5934\u8854</a>\u624d\u53ef\u53d1\u8d77\u6295\u7968\u54e6~~<br />\u7533\u8bf7\u52a0\u5165\u4f1a\u5458\uff0c\u9a6c\u4e0a\u53d1\u8d77\u6295\u7968\uff01\uff08\u66f4\u591a\u4f1a\u5458\u7279\u6743<a target="_blank" href="/f/like/level?ie=utf8&kw='+t+'">\u70b9\u6b64\u67e5\u770b</a>\uff09',buttons:{text:"\u786e\u5b9a"}}),!1}}),this.$root.find(".j_disable_float").click(function(){t.disableFloatingPoster()}),this.observe("insertimage",function(e,i){t.editor.execCommand("insertimage",[i])}),this.observe("file_added.attachment",function(){t.togglePostState(!0)}),this.observe("upload_complete.attachment",function(){t.togglePostState(!1)})},initPlaceHolder:function(){var t=this,e=0;if(this.$placeholder=$('<div class="tb_poster_placeholder"></div>'),this.$placeholder.click(function(e){$(e.target).is("a")||(t.$placeholder.hide(),t.editor.focus())}),this.editor.ready(function(){t.$placeholder.prependTo(t.$root.find(".edui-container")),t.editor.addListener("focus",function(){t.$placeholder.hide(),t.isOlympic()&&this.setContent("\u4e00\u697c\u732e\u7ed9\u56fd\u5bb6")}),t.editor.addListener("blur",function(){e||t.showPlaceHolder()}),t.showPlaceHolder()}),this.$root.on("restored.draft",function(){t.$placeholder.hide()}),this.isOlympic())this.$placeholder.css({left:"11px",top:"52px"}),this.$placeholder.html(this._olympicTpl);else if(this.QinglangData&&this.QinglangData.content&&PageData.user.is_login){this.$placeholder.css({left:15,top:55});var i='<p style="width:565px;line-height:25px;">'+this.QinglangData.content+"</p>";this.$placeholder.html(i)}else this.$placeholder.html(this._payMemberTpl),this.bindSuperMemberExpUpTrack();this.$editorContainer.on("setbackground",function(i,o){return"default"!==o&&o?(t.hideHolder=1,void t.$placeholder.hide()):void(e||t.showPlaceHolder())}),this.$placeholder.find("a").on("click",function(){var t="";"frs"==PageData.product?t="frs":"pb"==PageData.product&&(t="pb"),$.stats.track("\u53d1\u8868\u56de\u590d\u6846PlaceHolder","\u8d34\u5427PC\u9875\u9762\u4f18\u5316",t,"click")}),PosterContext.getContext().user.isLogin&&"\u8d34\u5427\u610f\u89c1\u53cd\u9988"==PosterContext.getContext().forum.name&&this.$placeholder.addClass("tb_poster_plain_placeholder").html(this.feedback)},initMousePwd:function(){this.MousePwd=this.requireInstance("poster/widget/mouse_pwd"),this.MousePwd.start(["editor_content_wrapper"])},recordKeyup:function(t){var e=this;window._BSK.userBehavior.keyUpArr.length<window._BSK.userBehavior.keyUpArrMax?window._BSK.userBehavior.keyUpArr.push(t.keyCode):$(".poster_body.editor_wrapper").unbind("keyup",e.recordKeyup)},initBskUserBehavior:function(){var t=this;$(".poster_body.editor_wrapper").unbind("keyup",t.recordKeyup).on("keyup",t.recordKeyup)},initFloatingToolbar:function(){function t(){s.removeClass("poster_floating_toolbar").removeClass("poster_locked_toolbar"),i=!1}var e=this,i=!1,o=this.$root.find(".editor_bottom_panel"),s=this.$root.find(".j_floating");if(this.$window.scroll(function(){if(e.editor.$container.height()>e.$window.height()){var n=e._viewPortOn(e.$root);if(n.isOnScreen){var r=e._viewPortOn(o);r.bottomToBottom>=0?i&&t():n.topToBottom>400?(s.addClass("poster_floating_toolbar").removeClass("poster_locked_toolbar"),i=!0):(s.addClass("poster_locked_toolbar").removeClass("poster_floating_toolbar"),i=!0)}else i&&t()}else i&&t()}),this.bind("draft_clean",t),this.bind("poster_float",t),"1"!=$.tb.Storage.get("close_long_editor_bubble")){var n={content:"\u5df2\u4e3a\u4f60\u5f00\u542f\u8d85\u957f\u53d1\u8d34\u6846\u529f\u80fd\uff0c\u4e86\u89e3\u66f4\u591a\u6216\u5173\u95ed\u6b64\u529f\u80fd<a href='//web.archive.org/web/20201117141157/https://tieba.baidu.com/mo/q/topic_page/219_1' target='_blank'>\u70b9\u51fb\u8fd9\u91cc</a>",arrow_dir:"down",bubble_css:{top:80,left:100,width:179},wrap:this.$root.find(".j_bubble_container"),closeBtn:!0},r=new UiBubbleTipBase(n);r.bind("onclose",function(){$.tb.Storage.set("close_long_editor_bubble","1",(new Date).getTime()+2592e6),r.closeBubble()}),r.showBubble()}},initSignature:function(){var t=this,e=this.$root.find(".j_poster_signature");e.hide(),PosterContext.getContext().user.isLogin&&this.$root.find("#ueditor_replace").one("click",function(){var i=t.requireInstance("poster/widget/post_signature",{$container:e,$is_zone_forum:PosterContext.context.is_zone_forum});i.init(),e.show().css("display","inline-block")})},showPlaceHolder:function(){var t=this.editor.getContent();0!=t.length||this.hideHolder||this.$placeholder.show()},showPostSuccess:function(){var t="";this.user.memberLevel&&(t="\u5c0a\u656c\u7684\u4f1a\u5458\uff0c");var e=this.getPosterSuccessContent(t);$(e).appendTo(this.$editorContainer),this.showAddExp($(".poster_submit"))},showAddExp:function(){$(".post_success_exp").fadeIn()},bindSuperMemberExpUpTrack:function(){var t=$(".j-placeholder-pay-member");if(-1!=t.html().indexOf("\u5f00\u901a\u8d85\u7ea7\u4f1a\u5458\u53d1\u8d346\u500d\u7ecf\u9a8c")){var e=this;e.$placeholder.on("click","a",function(){if(!PageData.user.is_login)return e.requireInstance("tbui/widget/login_dialog"),!1;var t=e.requireInstance("encourage-payment/widget/pay_member"),i={fr:"\u53d1\u5e16\u6846\u5f00\u901a\u4f1a\u5458\u70b9\u51fb\u91cf",scene_id:1007001003};t.showCashier(i),$.stats.track("\u53d1\u5e16\u6846\u5f00\u901a\u4f1a\u5458\u70b9\u51fb\u91cf","\u4f1a\u5458\u52a0\u901f2.0")})}},getPosterSuccessContent:function(t){var e=['<div class="tb_poster_info poster_success">','<div class="poster_success_content clearfix #{className}">','<div class="post_success_tip">#{headCrown}\u53d1\u8868\u6210\u529f\uff01</div>','<div class="post_success_exp">','<span class="post_success_exp_name">\u7ecf\u9a8c</span>','<b class="post_success_exp_plus">+#{experience}</b>',"</div>","</div>","#{footTip}","</div>"].join(""),i=2==this.user.memberLevel,o={className:t?"poster_success_content_mem":""},s={experience:6,footTip:"",headCrown:'<i class="middle_size_crown"></i>'},n={experience:1,footTip:'<div class="success-foot-tip"><i class="middle_size_crown"></i>\u5f00\u901a\u8d85\u7ea7\u4f1a\u5458\u53d1\u8d346\u500d\u7ecf\u9a8c</div>',headCrown:""};if(i)var r=$.extend(o,s);else var r=$.extend(o,n);var a=$.tb.format(e,r);return a},togglePostState:function(t){var e=this.$root.find(".j_posting_status");e.toggleClass("poster_posting_status_loading",t),this.toggleSubmitButton(t)},toggleSubmitButton:function(t){this.$submit.toggleClass("btn_default",!t),this.$submit.toggleClass("btn_disable",t)},post:function(t){var e=this.validateContent();if(e){var i=this.getPostData();if(!i)return!1;$(".j_use_core").is(":checked")&&(i.pro_zone=1),i.nick_name=this.user.user_nickname,"object"==typeof postObj&&"object"==typeof t&&$.extend(i,t),!this.postService.isPosting()&&e&&(PosterContext.context.user.isLogin?($.cookie("GET_TOPIC","-",{expires:-1,path:"/"}),this.postService.post(this.getPostType(),i,PosterContext.getContext()),this.togglePostState(!0),this.requireInstance("yunying/widget/snowflow",$.extend({content:i.content,page:PosterContext.getContext().product,postType:"rich_poster"},this._options.snowflow))):this.requireInstance("tbui/widget/login_dialog",["","editor",function(){$.stats.track("\u53d1\u8868\u6309\u94ae_\u767b\u5f55\u6210\u529f","\u975e\u767b\u5f55\u7528\u6237\u53d1\u5e16"),$.tb.location.reload()}]))}},getTitle:function(){return this.$title?this.$title.val():""},getContent:function(){return this.editor.getContent()},getContentUbb:function(){return this.editor.getContentUbb()},getPostType:function(){var t=this.isFrs?"thread":"reply";return this.editor.getExtendContent().hasLocalVideo&&(t="thread"==t?"vpostThread":"vpostReply"),t},showWarning:function(t){t&&void 0==this.$warning&&(this.$warning=$('<div class="tb_poster_info poster_warning"></div>').appendTo(this.$editorContainer)),this.$warning.html(t)},initUploadUrl:function(){var t=this,e=$.ajax({url:t.tbsUrl,dataType:"json"});e.done(function(e){0===Number(e.no)&&(t.uploadUrl+="?tbs="+e.data.tbs+"&fid="+(PosterContext.getContext().forum.id||"")+"&save_yun_album=1")})},escapeHTML:function(t){return"string"!=typeof t?t:t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\s/g,"&nbsp;").replace(/'/g,"&#039;").replace(/"/g,"&quot;")},picAllUpload:function(t){var e=this,i=this.$root.find("#ueditor_replace"),o=e.getContent(),s=$("<div>"+o+"</div>"),n=this.$root.find(".ueditor_container .j_error"),r=[],a=s.find("img.BDE_Image");a.remove("pic_upload_error");var l=!1;if(a&&a.length>0){if(a.length>this._options.ImgNum)return l=!0,n.text("\u56fe\u7247\u6570\u91cf\u8d85\u51fa\u9650\u5236").show(),!1;for(var c=0;c<a.length;c++)"1"!==a[c].dataset.isupload&&$(a[c]).attr("width")&&r.push(a[c].src);if(r.length>0){var d=null;$.ajax({url:e.uploadUrl,data:{filetype:"url",file:"",urls:r},xhrFields:{withCredentials:!0},crossDomain:!0,type:"POST",async:!1,success:function(o){if(0===o.err_no)for(var s=0;s<o.urls.length;s++){var r=o.urls[s].origin_url,a="https://"+o.urls[s].host+e.PIC_URL_PATH+o.urls[s].pic_id_encode+".jpg",c=i.find("img[src='"+r+"']");0==c.length&&(c=i.find("img[src='"+r.slice(r.indexOf("://")+1)+"']"),d=!0),0==o.urls[s].err_no?(c[0].src=a,c.attr("data-isupload",1),t=t.replace(e.escapeHTML(r),a),t=d?t.replace(e.escapeHTML(r.slice(r.indexOf("://")+1)),a):t.replace(e.escapeHTML(r),a)):(c.addClass("pic_upload_error"),l=!0,n.text("\u8d34\u5b50\u4e2d\u6807\u7ea2\u56fe\u7247\u4e0a\u4f20\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5").show())}else l=!0,n.text(o.err_msg).show()},error:function(){l=!0,n.text("\u4e0a\u4f20\u56fe\u7247\u5931\u8d25\uff0c\u8bf7\u7a0d\u5019\u91cd\u8bd5!").show()},dataType:"json"})}}return l?!1:t},getPostData:function(){var t=this.editor.getExtendContent(),e=this.picAllUpload(this.getContentUbb());if(e===!1)return!1;var i={content:e};if(this.isFrs){var o=this.getTitle(),s=this.$title.data("prefix");-1==o.indexOf(s)&&(s=""),o=o.replace(/\u2006/g,""),o=o.replace(s,""),i.title=o,i.prefix=s}var n=this.postManager.firePostDataProcess({editorExtendContent:t,context:PosterContext},i);i=$.extend({},i,n);var r=this.$root.find(".j_sign_id"),a=this.$root.find(".j_use_signature");return a.tbattr("checked")&&r.size()>0&&r.val()&&(i.sign_id=r.val()),this.$root.find(".j_poster_to_profile_in_frs").tbattr("checked")&&(i.is_personal_thread=1),i.mouse_pwd=this.MousePwd.report().c,i.mouse_pwd_t=this.MousePwd.time,i.mouse_pwd_isclick=this.MousePwd.MOUSEPWD_CLICK,i},validateContent:function(){var t=this.isFrs?3e4:1e4,e=this.editor.getContentByteLength(),i=this.editor.getExtendContent(),o=this.$root.find(".ueditor_container .j_error"),s="",n=this;if(this.isFrs){{var r=$.trim(this.getTitle());this.$title.data("prefix")}if(0===r.length)return this.$root.find(".title_container .j_error").text("\u6807\u9898\u4e0d\u80fd\u4e3a\u7a7a").show(),this.$title.focus(),this.$window.scrollTop(this.$title.offset().top-60),!1;if(""==$.trim(r.replace(/#([^#]+)#/g,"")))return this.$root.find(".title_container .j_error").text("\u53ea\u6709#\u8bdd\u9898#\u662f\u4e0d\u884c\u7684\u54df~\u8bf7\u5728\u8bdd\u9898\u540e\u586b\u5199\u6b63\u5f0f\u6807\u9898\uff01").show(),this.$title.focus(),this.$window.scrollTop(this.$title.offset().top-60),!1}return 0!==e||this.isFrs?e>t?(s="\u62b1\u6b49\uff0c\u60a8\u7684\u8d34\u5b50\u8d85\u8fc7"+t/2+"\u5b57\uff0c\u5efa\u8bae\u60a8\u7cbe\u7b80\u6216\u5206\u6bb5\u540e\u518d\u63d0\u4ea4",o.text(s).show(),!1):(s=this.postManager.firePostValidate({context:PosterContext,editorExtendContent:i,poster:n}),"string"==typeof s&&"NOT_SHOW_WARNING"===s?!1:"string"==typeof s&&s.length?(o.text(s).show(),!1):(this.$root.find(".j_error").hide(),!0)):(o.text("\u56de\u590d\u5185\u5bb9\u4e0d\u80fd\u4e3a\u7a7a").show(),!1)},refresh:function(){var t=$.tb.location.getHref();t=t.replace(/#\w*$/,""),$.tb.location.setHref(t)},successHandler:function(){this.initTitle(!0),Bigpipe.broadcast("postSuccess",{})},focus:function(){this.isFrs?this.$title.focus():$.browser.msie&&$.browser.version<=7||this.editor.focus()},enableFloatingPoster:function(){var t=this;if(!this.$root.hasClass("tb_floating_poster")&&(this.editor.enableHeightLimit(this.$window.height()-450),this.trigger("poster_float"),this.$root.hide().addClass("tb_floating_poster"),this.position&&this.$root.css(this.position),this.$root.fadeIn(function(){t.$root.draggable({handle:t.$root.find(".poster_head"),start:function(){t.$root.css({right:"auto",bottom:"auto"})}})}),"1"!=$.tb.Storage.get("close_float_draggable_bubble"))){var e={content:"\u6d6e\u52a8\u53d1\u8d34\u6846\u53ef\u4ee5<span class='ui_text_emphasize'>\u62d6\u62fd</span>\u4e86\uff0c\u8d76\u5feb\u62d6\u52a8\u6807\u9898\u8bd5\u8bd5\uff01\u66f4\u591a\u8be6\u60c5<a href='//web.archive.org/web/20201117141157/https://tieba.baidu.com/mo/q/topic_page/219_1' target='_blank'>\u70b9\u51fb\u8fd9\u91cc</a>",arrow_dir:"down",bubble_css:{top:0,left:10,width:179},wrap:this.$root.find(".j_bubble_container"),closeBtn:!0},i=new UiBubbleTipBase(e);i.bind("onclose",function(){$.tb.Storage.set("close_float_draggable_bubble","1",(new Date).getTime()+2592e6),i.closeBubble()}),i.showBubble()}},disableFloatingPoster:function(){var t=this;t.$root.fadeOut(function(){t.position={left:t.$root.css("left"),top:t.$root.css("top")},t.$root.draggable("destroy").css({left:"auto",top:"auto"}),t.$root.removeClass("tb_floating_poster").show(),PosterContext.getAuthorities().long_editor?t.editor.disableHeightLimit():t.editor.enableHeightLimit()})},_viewPortOn:function(t){var e=this.$window.scrollTop(),i=e+this.$window.height(),o=t.offset().top,s=o+t.height();return{isOnScreen:i>o&&s>e,topToBottom:i-o,bottomToTop:s-e,topToTop:o-e,bottomToBottom:i-s}}}});_.Module.define({path:"ueditor/widget/ueditor_base",sub:{initial:function(){window.UE||(this.initUEditor(),this.initUEditorConfig(),this.initUEditorLang(),this.initExtendUtils())},initUEditor:function(){!function(){function e(e,t,n){var r;return t=t.toLowerCase(),(r=e.__allListeners||n&&(e.__allListeners={}))&&(r[t]||n&&(r[t]=[]))}UEDITOR_CONFIG=window.UEDITOR_CONFIG||{},window.UE={plugins:{},commands:{},instants:{},I18N:{},version:"mini1.0.0.0"};var t=UE.dom={},n=UE.browser=function(){var e=navigator.userAgent.toLowerCase(),t=window.opera,n={ie:!!window.ActiveXObject,opera:!!t&&t.version,webkit:e.indexOf(" applewebkit/")>-1,mac:e.indexOf("macintosh")>-1,quirks:"BackCompat"==document.compatMode};n.gecko="Gecko"==navigator.product&&!n.webkit&&!n.opera;var r=0;if(n.ie&&(r=parseFloat(e.match(/msie (\d+)/)[1]),n.ie9Compat=9==document.documentMode,n.ie8=!!document.documentMode,n.ie8Compat=8==document.documentMode,n.ie7Compat=7==r&&!document.documentMode||7==document.documentMode,n.ie6Compat=7>r||n.quirks,n.ie9above=r>8,n.ie9below=9>r),n.gecko){var i=e.match(/rv:([\d\.]+)/);i&&(i=i[1].split("."),r=1e4*i[0]+100*(i[1]||0)+1*(i[2]||0))}return/chrome\/(\d+\.\d)/i.test(e)&&(n.chrome=+RegExp.$1),/(\d+\.\d)?(?:\.\d)?\s+safari\/?(\d+\.\d+)?/i.test(e)&&!/chrome/i.test(e)&&(n.safari=+(RegExp.$1||RegExp.$2)),n.opera&&(r=parseFloat(t.version())),n.webkit&&(r=parseFloat(e.match(/ applewebkit\/(\d+)/)[1])),n.version=r,n.isCompatible=!n.mobile&&(n.ie&&r>=6||n.gecko&&r>=10801||n.opera&&r>=9.5||n.air&&r>=1||n.webkit&&r>=522||!1),n}(),r=n.ie,i=(n.webkit,n.gecko,n.opera,UE.utils={each:function(e,t,n){if(null!=e)if(e.length===+e.length){for(var r=0,i=e.length;i>r;r++)if(t.call(n,e[r],r,e)===!1)return!1}else for(var o in e)if(e.hasOwnProperty(o)&&t.call(n,e[o],o,e)===!1)return!1},makeInstance:function(e){var t=new Function;return t.prototype=e,e=new t,t.prototype=null,e},extend:function(e,t,n){if(t)for(var r in t)n&&e.hasOwnProperty(r)||(e[r]=t[r]);return e},extend2:function(e){for(var t=arguments,n=1;n<t.length;n++){var r=t[n];for(var i in r)e.hasOwnProperty(i)||(e[i]=r[i])}return e},inherits:function(e,t){var n=e.prototype,r=i.makeInstance(t.prototype);return i.extend(r,n,!0),e.prototype=r,r.constructor=e},bind:function(e,t){return function(){return e.apply(t,arguments)}},defer:function(e,t,n){var r;return function(){n&&clearTimeout(r),r=setTimeout(e,t)}},indexOf:function(e,t,n){var r=-1;return n=this.isNumber(n)?n:0,this.each(e,function(e,i){return i>=n&&e===t?(r=i,!1):void 0}),r},removeItem:function(e,t){for(var n=0,r=e.length;r>n;n++)e[n]===t&&(e.splice(n,1),n--)},trim:function(e){return e.replace(/(^[ \t\n\r]+)|([ \t\n\r]+$)/g,"")},listToMap:function(e){if(!e)return{};e=i.isArray(e)?e:e.split(",");for(var t,n=0,r={};t=e[n++];)r[t.toUpperCase()]=r[t]=1;return r},unhtml:function(e,t){return e?e.replace(t||/[&<">'](?:(amp|lt|quot|gt|#39|nbsp);)?/g,function(e,t){return t?e:{"<":"&lt;","&":"&amp;",'"':"&quot;",">":"&gt;","'":"&#39;"}[e]}):""},html:function(e){return e?e.replace(/&((g|l|quo)t|amp|#39);/g,function(e){return{"&lt;":"<","&amp;":"&","&quot;":'"',"&gt;":">","&#39;":"'"}[e]}):""},cssStyleToDomStyle:function(){var e=document.createElement("div").style,t={"float":void 0!=e.cssFloat?"cssFloat":void 0!=e.styleFloat?"styleFloat":"float"};return function(e){return t[e]||(t[e]=e.toLowerCase().replace(/-./g,function(e){return e.charAt(1).toUpperCase()}))}}(),loadFile:function(){function e(e,n){try{for(var r,i=0;r=t[i++];)if(r.doc===e&&r.url==(n.src||n.href))return r}catch(o){return null}}var t=[];return function(n,r,i){var o=e(n,r);if(o)return void(o.ready?i&&i():o.funs.push(i));if(t.push({doc:n,url:r.src||r.href,funs:[i]}),!n.body){var a=[];for(var s in r)"tag"!=s&&a.push(s+'="'+r[s]+'"');return void n.write("<"+r.tag+" "+a.join(" ")+" ></"+r.tag+">")}if(!r.id||!n.getElementById(r.id)){var l=n.createElement(r.tag);delete r.tag;for(var s in r)l.setAttribute(s,r[s]);l.onload=l.onreadystatechange=function(){if(!this.readyState||/loaded|complete/.test(this.readyState)){if(o=e(n,r),o.funs.length>0){o.ready=1;for(var t;t=o.funs.pop();)t()}l.onload=l.onreadystatechange=null}},l.onerror=function(){throw Error("The load "+(r.href||r.src)+" fails,check the url settings of file ueditor.config.js ")},n.getElementsByTagName("head")[0].appendChild(l)}}}(),isEmptyObject:function(e){if(null==e)return!0;if(this.isArray(e)||this.isString(e))return 0===e.length;for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},fixColor:function(e,t){if(/color/i.test(e)&&/rgba?/.test(t)){var n=t.split(",");if(n.length>3)return"";t="#";for(var r,i=0;r=n[i++];)r=parseInt(r.replace(/[^\d]/gi,""),10).toString(16),t+=1==r.length?"0"+r:r;t=t.toUpperCase()}return t},clone:function(e,t){var n;t=t||{};for(var r in e)e.hasOwnProperty(r)&&(n=e[r],"object"==typeof n?(t[r]=i.isArray(n)?[]:{},i.clone(e[r],t[r])):t[r]=n);return t},transUnitToPx:function(e){if(!/(pt|cm)/.test(e))return e;var t;switch(e.replace(/([\d.]+)(\w+)/,function(n,r,i){e=r,t=i}),t){case"cm":e=25*parseFloat(e);break;case"pt":e=Math.round(96*parseFloat(e)/72)}return e+(e?"px":"")},domReady:function(){function e(e){e.isReady=!0;for(var n;n=t.pop();n());}var t=[];return function(r,i){i=i||window;var o=i.document;r&&t.push(r),"complete"===o.readyState?e(o):(o.isReady&&e(o),n.ie?(!function(){if(!o.isReady){try{o.documentElement.doScroll("left")}catch(t){return void setTimeout(arguments.callee,0)}e(o)}}(),i.attachEvent("onload",function(){e(o)})):(o.addEventListener("DOMContentLoaded",function(){o.removeEventListener("DOMContentLoaded",arguments.callee,!1),e(o)},!1),i.addEventListener("load",function(){e(o)},!1)))}}(),cssRule:n.ie?function(e,t,n){var r,i;n=n||document,r=n.indexList?n.indexList:n.indexList={};var o;if(r[e])o=n.styleSheets[r[e]];else{if(void 0===t)return"";o=n.createStyleSheet("",i=n.styleSheets.length),r[e]=i}return void 0===t?o.cssText:void(o.cssText=t||"")}:function(e,t,n){n=n||document;var r,i=n.getElementsByTagName("head")[0];if(!(r=n.getElementById(e))){if(void 0===t)return"";r=n.createElement("style"),r.id=e,i.appendChild(r)}return void 0===t?r.innerHTML:void(""!==t?r.innerHTML=t:i.removeChild(r))}});i.each(["String","Function","Array","Number","RegExp","Object"],function(e){UE.utils["is"+e]=function(t){return Object.prototype.toString.apply(t)=="[object "+e+"]"}});var o=UE.EventBase=function(){};o.prototype={addListener:function(t,n){t=i.trim(t).split(" ");for(var r,o=0;r=t[o++];)e(this,r,!0).push(n)},removeListener:function(t,n){t=i.trim(t).split(" ");for(var r,o=0;r=t[o++];)i.removeItem(e(this,r)||[],n)},fireEvent:function(){var t=arguments[0];t=i.trim(t).split(" ");for(var n,r=0;n=t[r++];){var o,a,s,l=e(this,n);if(l)for(s=l.length;s--;)if(l[s]){if(a=l[s].apply(this,arguments),a===!0)return a;void 0!==a&&(o=a)}(a=this["on"+n.toLowerCase()])&&(o=a.apply(this,arguments))}return o}};var a=t.dtd=function(){function e(e){for(var t in e)e[t.toUpperCase()]=e[t];return e}var t=i.extend2,n=e({isindex:1,fieldset:1}),r=e({input:1,button:1,select:1,textarea:1,label:1}),o=t(e({a:1}),r),a=t({iframe:1},o),s=e({hr:1,ul:1,menu:1,div:1,blockquote:1,noscript:1,table:1,center:1,address:1,dir:1,pre:1,h5:1,dl:1,h4:1,noframes:1,h6:1,ol:1,h1:1,h3:1,h2:1}),l=e({ins:1,del:1,script:1,style:1}),d=t(e({b:1,acronym:1,bdo:1,"var":1,"#":1,abbr:1,code:1,br:1,i:1,cite:1,kbd:1,u:1,strike:1,s:1,tt:1,strong:1,q:1,samp:1,em:1,dfn:1,span:1}),l),c=t(e({sub:1,img:1,embed:1,object:1,sup:1,basefont:1,map:1,applet:1,font:1,big:1,small:1}),d),u=t(e({p:1}),c),f=t(e({iframe:1}),c,r),h=e({img:1,embed:1,noscript:1,br:1,kbd:1,center:1,button:1,basefont:1,h5:1,h4:1,samp:1,h6:1,ol:1,h1:1,h3:1,h2:1,form:1,font:1,"#":1,select:1,menu:1,ins:1,abbr:1,label:1,code:1,table:1,script:1,cite:1,input:1,iframe:1,strong:1,textarea:1,noframes:1,big:1,small:1,span:1,hr:1,sub:1,bdo:1,"var":1,div:1,object:1,sup:1,strike:1,dir:1,map:1,dl:1,applet:1,del:1,isindex:1,fieldset:1,ul:1,b:1,acronym:1,a:1,blockquote:1,i:1,u:1,s:1,tt:1,address:1,q:1,pre:1,p:1,em:1,dfn:1}),p=t(e({a:0}),f),m=(e({tr:1}),e({"#":1}),t(e({param:1}),h),t(e({form:1}),n,a,s,u),e({li:1,ol:1,ul:1}),e({style:1,script:1})),g=e({base:1,link:1,meta:1,title:1}),v=(t(g,m),e({head:1,body:1})),y=e({html:1}),b=e({address:1,blockquote:1,center:1,dir:1,div:1,dl:1,fieldset:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,hr:1,isindex:1,menu:1,noframes:1,ol:1,p:1,pre:1,table:1,ul:1}),C=e({area:1,base:1,basefont:1,br:1,col:1,command:1,dialog:1,embed:1,hr:1,img:1,input:1,isindex:1,keygen:1,link:1,meta:1,param:1,source:1,track:1,wbr:1});return e({$nonBodyContent:t(y,v,g),$block:b,$inline:p,$inlineWithA:t(e({a:1}),p),$body:t(e({script:1,style:1}),b),$cdata:e({script:1,style:1}),$empty:C,$nonChild:e({iframe:1,textarea:1}),$listItem:e({dd:1,dt:1,li:1}),$list:e({ul:1,ol:1,dl:1}),$isNotEmpty:e({table:1,ul:1,ol:1,dl:1,iframe:1,area:1,base:1,col:1,hr:1,img:1,embed:1,input:1,link:1,meta:1,param:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1}),$removeEmpty:e({a:1,abbr:1,acronym:1,address:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,s:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,"var":1}),$removeEmptyBlock:e({p:1,div:1}),$tableContent:e({caption:1,col:1,colgroup:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1,table:1}),$notTransContent:e({pre:1,script:1,style:1,textarea:1}),p:t(e({a:1}),p)})}(),s=r&&n.version<9?{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder"}:{tabindex:"tabIndex",readonly:"readOnly"},l=i.listToMap(["-webkit-box","-moz-box","block","list-item","table","table-row-group","table-header-group","table-footer-group","table-row","table-column-group","table-column","table-cell","table-caption"]),d=t.domUtils={NODE_ELEMENT:1,NODE_DOCUMENT:9,NODE_TEXT:3,NODE_COMMENT:8,NODE_DOCUMENT_FRAGMENT:11,POSITION_IDENTICAL:0,POSITION_DISCONNECTED:1,POSITION_FOLLOWING:2,POSITION_PRECEDING:4,POSITION_IS_CONTAINED:8,POSITION_CONTAINS:16,fillChar:r&&"6"==n.version?"\ufeff":"\u200b",keys:{8:1,46:1,16:1,17:1,18:1,37:1,38:1,39:1,40:1,13:1},breakParent:function(e,t){var n,r,i,o=e,a=e;do{for(o=o.parentNode,r?(n=o.cloneNode(!1),n.appendChild(r),r=n,n=o.cloneNode(!1),n.appendChild(i),i=n):(r=o.cloneNode(!1),i=r.cloneNode(!1));n=a.previousSibling;)r.insertBefore(n,r.firstChild);for(;n=a.nextSibling;)i.appendChild(n);a=o}while(t!==o);return n=t.parentNode,n.insertBefore(r,t),n.insertBefore(i,t),n.insertBefore(e,i),d.remove(t),e},trimWhiteTextNode:function(e){function t(t){for(var n;(n=e[t])&&3==n.nodeType&&d.isWhitespace(n);)e.removeChild(n)}t("firstChild"),t("lastChild")},getPosition:function(e,t){if(e===t)return 0;var n,r=[e],i=[t];for(n=e;n=n.parentNode;){if(n===t)return 10;r.push(n)}for(n=t;n=n.parentNode;){if(n===e)return 20;i.push(n)}if(r.reverse(),i.reverse(),r[0]!==i[0])return 1;for(var o=-1;o++,r[o]===i[o];);for(e=r[o],t=i[o];e=e.nextSibling;)if(e===t)return 4;return 2},getNodeIndex:function(e,t){for(var n=e,r=0;n=n.previousSibling;)t&&3==n.nodeType?n.nodeType!=n.nextSibling.nodeType&&r++:r++;return r},inDoc:function(e,t){return 10==d.getPosition(e,t)},findParent:function(e,t,n){if(e&&!d.isBody(e))for(e=n?e:e.parentNode;e;){if(!t||t(e)||d.isBody(e))return t&&!t(e)&&d.isBody(e)?null:e;e=e.parentNode}return null},findParentByTagName:function(e,t,n,r){return t=i.listToMap(i.isArray(t)?t:[t]),d.findParent(e,function(e){return t[e.tagName]&&!(r&&r(e))},n)},findParents:function(e,t,n,r){for(var i=t&&(n&&n(e)||!n)?[e]:[];e=d.findParent(e,n);)i.push(e);return r?i:i.reverse()},insertAfter:function(e,t){return e.parentNode.insertBefore(t,e.nextSibling)},remove:function(e,t){var n,r=e.parentNode;if(r){if(t&&e.hasChildNodes())for(;n=e.firstChild;)r.insertBefore(n,e);r.removeChild(e)}return e},isBookmarkNode:function(e){return 1==e.nodeType&&e.id&&/^_baidu_bookmark_/i.test(e.id)},getWindow:function(e){var t=e.ownerDocument||e;return t.defaultView||t.parentWindow},split:function(e,t){var r=e.ownerDocument;if(n.ie&&t==e.nodeValue.length){var i=r.createTextNode("");return d.insertAfter(e,i)}var o=e.splitText(t);if(n.ie8){var a=r.createTextNode("");d.insertAfter(o,a),d.remove(a)}return o},isWhitespace:function(e){return!new RegExp("[^ 	\n\r"+d.fillChar+"]").test(e.nodeValue)},getXY:function(e){for(var t=0,n=0;e.offsetParent;)n+=e.offsetTop,t+=e.offsetLeft,e=e.offsetParent;return{x:t,y:n}},on:function(e,t,n){var r=i.isArray(t)?t:[t],o=r.length;if(o)for(;o--;)if(t=r[o],e.addEventListener)e.addEventListener(t,n,!1);else{n._d||(n._d={els:[]});var a=t+n.toString(),s=i.indexOf(n._d.els,e);n._d[a]&&-1!=s||(-1==s&&n._d.els.push(e),n._d[a]||(n._d[a]=function(e){return n.call(e.srcElement,e||window.event)}),e.attachEvent("on"+t,n._d[a]))}e=null},un:function(e,t,n){var r=i.isArray(t)?t:[t],o=r.length;if(o)for(;o--;)if(t=r[o],e.removeEventListener)e.removeEventListener(t,n,!1);else{var a=t+n.toString();try{e.detachEvent("on"+t,n._d?n._d[a]:n)}catch(s){}if(n._d&&n._d[a]){var l=i.indexOf(n._d.els,e);-1!=l&&n._d.els.splice(l,1),0==n._d.els.length&&delete n._d[a]}}},isEmptyInlineElement:function(e){if(1!=e.nodeType||!a.$removeEmpty[e.tagName])return 0;for(e=e.firstChild;e;){if(d.isBookmarkNode(e))return 0;if(1==e.nodeType&&!d.isEmptyInlineElement(e)||3==e.nodeType&&!d.isWhitespace(e))return 0;e=e.nextSibling}return 1},isBlockElm:function(e){return 1==e.nodeType&&(a.$block[e.tagName]||l[d.getComputedStyle(e,"display")])&&!a.$nonChild[e.tagName]},getElementsByTagName:function(e,t,n){if(n&&i.isString(n)){var r=n;n=function(e){var t=!1;return $.each(i.trim(r).replace(/[ ]{2,}/g," ").split(" "),function(n,r){return $(e).hasClass(r)?(t=!0,!1):void 0}),t}}t=i.trim(t).replace(/[ ]{2,}/g," ").split(" ");for(var o,a=[],s=0;o=t[s++];)for(var l,d=e.getElementsByTagName(o),c=0;l=d[c++];)(!n||n(l))&&a.push(l);return a},unSelectable:r||n.opera?function(e){e.onselectstart=function(){return!1},e.onclick=e.onkeyup=e.onkeydown=function(){return!1},e.unselectable="on",e.setAttribute("unselectable","on");for(var t,n=0;t=e.all[n++];)switch(t.tagName.toLowerCase()){case"iframe":case"textarea":case"input":case"select":break;default:t.unselectable="on",e.setAttribute("unselectable","on")}}:function(e){e.style.MozUserSelect=e.style.webkitUserSelect=e.style.KhtmlUserSelect="none"},removeAttributes:function(e,t){t=i.isArray(t)?t:i.trim(t).replace(/[ ]{2,}/g," ").split(" ");for(var r,o=0;r=t[o++];){switch(r=s[r]||r){case"className":e[r]="";break;case"style":e.style.cssText="",!n.ie&&e.removeAttributeNode(e.getAttributeNode("style"))}e.removeAttribute(r)}},createElement:function(e,t,n){return d.setAttributes(e.createElement(t),n)},setAttributes:function(e,t){for(var n in t)if(t.hasOwnProperty(n)){var r=t[n];switch(n){case"class":e.className=r;break;case"style":e.style.cssText=e.style.cssText+";"+r;break;case"innerHTML":e[n]=r;break;case"value":e.value=r;break;default:e.setAttribute(s[n]||n,r)}}return e},getComputedStyle:function(e,t){return i.transUnitToPx(i.fixColor(t,$(e).css(t)))},preventDefault:function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},getStyle:function(e,t){var n=e.style[i.cssStyleToDomStyle(t)];return i.fixColor(t,n)},setStyle:function(e,t,n){e.style[i.cssStyleToDomStyle(t)]=n,i.trim(e.style.cssText)||this.removeAttributes(e,"style")},removeDirtyAttr:function(e){for(var t,n=0,r=e.getElementsByTagName("*");t=r[n++];)t.removeAttribute("_moz_dirty");e.removeAttribute("_moz_dirty")},getChildCount:function(e,t){var n=0,r=e.firstChild;for(t=t||function(){return 1};r;)t(r)&&n++,r=r.nextSibling;return n},isEmptyNode:function(e){return!e.firstChild||0==d.getChildCount(e,function(e){return!d.isBr(e)&&!d.isBookmarkNode(e)&&!d.isWhitespace(e)})},isBr:function(e){return 1==e.nodeType&&"BR"==e.tagName},isFillChar:function(e,t){return 3==e.nodeType&&!e.nodeValue.replace(new RegExp((t?"^":"")+d.fillChar),"").length},isEmptyBlock:function(e,t){if(1!=e.nodeType)return 0;if(t=t||new RegExp("[ 	\r\n"+d.fillChar+"]","g"),e[n.ie?"innerText":"textContent"].replace(t,"").length>0)return 0;for(var r in a.$isNotEmpty)if(e.getElementsByTagName(r).length)return 0;return 1},isCustomeNode:function(e){return 1==e.nodeType&&e.getAttribute("_ue_custom_node_")},fillNode:function(e,t){var r=n.ie?e.createTextNode(d.fillChar):e.createElement("br");t.innerHTML="",t.appendChild(r)},isBoundaryNode:function(e,t){for(var n;!d.isBody(e);)if(n=e,e=e.parentNode,n!==e[t])return!1;return!0},isFillChar:function(e,t){return 3==e.nodeType&&!e.nodeValue.replace(new RegExp((t?"^":"")+d.fillChar),"").length}},c=new RegExp(d.fillChar,"g");!function(){function e(e){e.collapsed=e.startContainer&&e.endContainer&&e.startContainer===e.endContainer&&e.startOffset==e.endOffset}function r(e){return!e.collapsed&&1==e.startContainer.nodeType&&e.startContainer===e.endContainer&&e.endOffset-e.startOffset==1}function i(t,n,r,i){return 1==n.nodeType&&(a.$empty[n.tagName]||a.$nonChild[n.tagName])&&(r=d.getNodeIndex(n)+(t?0:1),n=n.parentNode),t?(i.startContainer=n,i.startOffset=r,i.endContainer||i.collapse(!0)):(i.endContainer=n,i.endOffset=r,i.startContainer||i.collapse(!1)),e(i),i}function o(e,t){try{if(u&&d.inDoc(u,e))if(u.nodeValue.replace(c,"").length)u.nodeValue=u.nodeValue.replace(c,"");else{var r=u.parentNode;for(d.remove(u);r&&d.isEmptyInlineElement(r)&&(n.safari?!(d.getPosition(r,t)&d.POSITION_CONTAINS):!r.contains(t));)u=r.parentNode,d.remove(r),r=u}}catch(i){}}function s(e,t){var n;for(e=e[t];e&&d.isFillChar(e);)n=e[t],d.remove(e),e=n}function l(e,t){var n,r,i=e.startContainer,o=e.endContainer,a=e.startOffset,s=e.endOffset,l=e.document,c=l.createDocumentFragment();if(1==i.nodeType&&(i=i.childNodes[a]||(n=i.appendChild(l.createTextNode("")))),1==o.nodeType&&(o=o.childNodes[s]||(r=o.appendChild(l.createTextNode("")))),i===o&&3==i.nodeType)return c.appendChild(l.createTextNode(i.substringData(a,s-a))),t&&(i.deleteData(a,s-a),e.collapse(!0)),c;for(var u,f,h=c,p=d.findParents(i,!0),m=d.findParents(o,!0),g=0;p[g]==m[g];)g++;for(var v,y=g;v=p[y];y++){for(u=v.nextSibling,v==i?n||(3==e.startContainer.nodeType?(h.appendChild(l.createTextNode(i.nodeValue.slice(a))),t&&i.deleteData(a,i.nodeValue.length-a)):h.appendChild(t?i:i.cloneNode(!0))):(f=v.cloneNode(!1),h.appendChild(f));u&&u!==o&&u!==m[y];)v=u.nextSibling,h.appendChild(t?u:u.cloneNode(!0)),u=v;h=f}h=c,p[g]||(h.appendChild(p[g-1].cloneNode(!1)),h=h.firstChild);for(var b,y=g;b=m[y];y++){if(u=b.previousSibling,b==o?r||3!=e.endContainer.nodeType||(h.appendChild(l.createTextNode(o.substringData(0,s))),t&&o.deleteData(0,s)):(f=b.cloneNode(!1),h.appendChild(f)),y!=g||!p[g])for(;u&&u!==i;)b=u.previousSibling,h.insertBefore(t?u:u.cloneNode(!0),h.firstChild),u=b;h=f}return t&&e.setStartBefore(m[g]?p[g]?m[g]:p[g-1]:m[g-1]).collapse(!0),n&&d.remove(n),r&&d.remove(r),c}var u,f=0,h=d.fillChar,p=t.Range=function(e,t){var n=this;n.startContainer=n.startOffset=n.endContainer=n.endOffset=null,n.document=e,n.collapsed=!0,n.body=t};p.prototype={deleteContents:function(){var e;return this.collapsed||l(this,1),n.webkit&&(e=this.startContainer,3!=e.nodeType||e.nodeValue.length||(this.setStartBefore(e).collapse(!0),d.remove(e))),this},inFillChar:function(){var e=this.startContainer;return this.collapsed&&3==e.nodeType&&e.nodeValue.replace(new RegExp("^"+d.fillChar),"").length+1==e.nodeValue.length?!0:!1},setStart:function(e,t){return i(!0,e,t,this)},setEnd:function(e,t){return i(!1,e,t,this)},setStartAfter:function(e){return this.setStart(e.parentNode,d.getNodeIndex(e)+1)},setStartBefore:function(e){return this.setStart(e.parentNode,d.getNodeIndex(e))},setEndAfter:function(e){return this.setEnd(e.parentNode,d.getNodeIndex(e)+1)},setEndBefore:function(e){return this.setEnd(e.parentNode,d.getNodeIndex(e))},setStartAtFirst:function(e){return this.setStart(e,0)},setStartAtLast:function(e){return this.setStart(e,3==e.nodeType?e.nodeValue.length:e.childNodes.length)},setEndAtFirst:function(e){return this.setEnd(e,0)},setEndAtLast:function(e){return this.setEnd(e,3==e.nodeType?e.nodeValue.length:e.childNodes.length)},selectNode:function(e){return this.setStartBefore(e).setEndAfter(e)},selectNodeContents:function(e){return this.setStart(e,0).setEndAtLast(e)},cloneRange:function(){var e=this;return new p(e.document).setStart(e.startContainer,e.startOffset).setEnd(e.endContainer,e.endOffset)},collapse:function(e){var t=this;return e?(t.endContainer=t.startContainer,t.endOffset=t.startOffset):(t.startContainer=t.endContainer,t.startOffset=t.endOffset),t.collapsed=!0,t},shrinkBoundary:function(e){function t(e){return 1==e.nodeType&&!d.isBookmarkNode(e)&&!a.$empty[e.tagName]&&!a.$nonChild[e.tagName]}for(var n,r=this,i=r.collapsed;1==r.startContainer.nodeType&&(n=r.startContainer.childNodes[r.startOffset])&&t(n);)r.setStart(n,0);if(i)return r.collapse(!0);if(!e)for(;1==r.endContainer.nodeType&&r.endOffset>0&&(n=r.endContainer.childNodes[r.endOffset-1])&&t(n);)r.setEnd(n,n.childNodes.length);return r},trimBoundary:function(e){this.txtToElmBoundary();var t=this.startContainer,n=this.startOffset,r=this.collapsed,i=this.endContainer;if(3==t.nodeType){if(0==n)this.setStartBefore(t);else if(n>=t.nodeValue.length)this.setStartAfter(t);else{var o=d.split(t,n);t===i?this.setEnd(o,this.endOffset-n):t.parentNode===i&&(this.endOffset+=1),this.setStartBefore(o)}if(r)return this.collapse(!0)}return e||(n=this.endOffset,i=this.endContainer,3==i.nodeType&&(0==n?this.setEndBefore(i):(n<i.nodeValue.length&&d.split(i,n),this.setEndAfter(i)))),this},txtToElmBoundary:function(e){function t(e,t){var n=e[t+"Container"],r=e[t+"Offset"];3==n.nodeType&&(r?r>=n.nodeValue.length&&e["set"+t.replace(/(\w)/,function(e){return e.toUpperCase()})+"After"](n):e["set"+t.replace(/(\w)/,function(e){return e.toUpperCase()})+"Before"](n))}return(e||!this.collapsed)&&(t(this,"start"),t(this,"end")),this},insertNode:function(e){var t=e,n=1;11==e.nodeType&&(t=e.firstChild,n=e.childNodes.length),this.trimBoundary(!0);var r=this.startContainer,i=this.startOffset,o=r.childNodes[i];return o?r.insertBefore(e,o):r.appendChild(e),t.parentNode===this.endContainer&&(this.endOffset=this.endOffset+n),this.setStartBefore(t)},setCursor:function(e,t){return this.collapse(!e).select(t)},createBookmark:function(e,t){var n,r=this.document.createElement("span");return r.style.cssText="display:none;line-height:0px;",r.appendChild(this.document.createTextNode("\u200d")),r.id="_baidu_bookmark_start_"+(t?"":f++),this.collapsed||(n=r.cloneNode(!0),n.id="_baidu_bookmark_end_"+(t?"":f++)),this.insertNode(r),n&&this.collapse().insertNode(n).setEndBefore(n),this.setStartAfter(r),{start:e?r.id:r,end:n?e?n.id:n:null,id:e}},moveToBookmark:function(e){var t=e.id?this.document.getElementById(e.start):e.start,n=e.end&&e.id?this.document.getElementById(e.end):e.end;return this.setStartBefore(t),d.remove(t),n?(this.setEndBefore(n),d.remove(n)):this.collapse(!0),this},adjustmentBoundary:function(){if(!this.collapsed){for(;!d.isBody(this.startContainer)&&this.startOffset==this.startContainer[3==this.startContainer.nodeType?"nodeValue":"childNodes"].length&&this.startContainer[3==this.startContainer.nodeType?"nodeValue":"childNodes"].length;)this.setStartAfter(this.startContainer);for(;!d.isBody(this.endContainer)&&!this.endOffset&&this.endContainer[3==this.endContainer.nodeType?"nodeValue":"childNodes"].length;)this.setEndBefore(this.endContainer)}return this},getClosedNode:function(){var e;if(!this.collapsed){var t=this.cloneRange().adjustmentBoundary().shrinkBoundary();if(r(t)){var n=t.startContainer.childNodes[t.startOffset];n&&1==n.nodeType&&(a.$empty[n.tagName]||a.$nonChild[n.tagName])&&(e=n)}}return e},select:n.ie?function(e,t){var n;this.collapsed||this.shrinkBoundary();var r=this.getClosedNode();if(r&&!t){try{n=this.document.body.createControlRange(),n.addElement(r),n.select()}catch(i){}return this}var a,l=this.createBookmark(),c=l.start;if(n=this.document.body.createTextRange(),n.moveToElementText(c),n.moveStart("character",1),this.collapsed){if(!e&&3!=this.startContainer.nodeType){var f=this.document.createTextNode(h),p=this.document.createElement("span");p.appendChild(this.document.createTextNode(h)),c.parentNode.insertBefore(p,c),c.parentNode.insertBefore(f,c),o(this.document,f),u=f,s(p,"previousSibling"),s(c,"nextSibling"),n.moveStart("character",-1),n.collapse(!0)}}else{var m=this.document.body.createTextRange();a=l.end,m.moveToElementText(a),n.setEndPoint("EndToEnd",m)}this.moveToBookmark(l),p&&d.remove(p);try{n.select()}catch(i){}return this}:function(e){function t(e){function t(t,n,r){3==t.nodeType&&t.nodeValue.length<n&&(e[r+"Offset"]=t.nodeValue.length)}t(e.startContainer,e.startOffset,"start"),t(e.endContainer,e.endOffset,"end")}var r,i=d.getWindow(this.document),a=i.getSelection();if(n.gecko?this.body.focus():i.focus(),a){if(a.removeAllRanges(),this.collapsed&&!e){var l=this.startContainer,c=l;1==l.nodeType&&(c=l.childNodes[this.startOffset]),3==l.nodeType&&this.startOffset||(c?c.previousSibling&&3==c.previousSibling.nodeType:l.lastChild&&3==l.lastChild.nodeType)||(r=this.document.createTextNode(h),this.insertNode(r),o(this.document,r),s(r,"previousSibling"),s(r,"nextSibling"),u=r,this.setStart(r,n.webkit?1:0).collapse(!0))}var f=this.document.createRange();if(this.collapsed&&n.opera&&1==this.startContainer.nodeType){var c=this.startContainer.childNodes[this.startOffset];if(c){for(;c&&d.isBlockElm(c)&&1==c.nodeType&&c.childNodes[0];)c=c.childNodes[0];c&&this.setStartBefore(c).collapse(!0)}else c=this.startContainer.lastChild,c&&d.isBr(c)&&this.setStartBefore(c).collapse(!0)}t(this),f.setStart(this.startContainer,this.startOffset),f.setEnd(this.endContainer,this.endOffset),a.addRange(f)}return this},createAddress:function(e,t){function n(e){for(var n,r=e?i.startContainer:i.endContainer,o=d.findParents(r,!0,function(e){return!d.isBody(e)}),a=[],s=0;n=o[s++];)a.push(d.getNodeIndex(n,t));var l=0;if(t)if(3==r.nodeType){for(var u=r.previousSibling;u&&3==u.nodeType;)l+=u.nodeValue.replace(c,"").length,u=u.previousSibling;l+=e?i.startOffset:i.endOffset}else if(r=r.childNodes[e?i.startOffset:i.endOffset])l=d.getNodeIndex(r,t);else{r=e?i.startContainer:i.endContainer;for(var f=r.firstChild;f;)if(d.isFillChar(f))f=f.nextSibling;else if(l++,3==f.nodeType)for(;f&&3==f.nodeType;)f=f.nextSibling;else f=f.nextSibling}else l=e?d.isFillChar(r)?0:i.startOffset:i.endOffset;return 0>l&&(l=0),a.push(l),a}var r={},i=this;return r.startAddress=n(!0),e||(r.endAddress=i.collapsed?[].concat(r.startAddress):n()),r},moveToAddress:function(e,t){function n(e,t){for(var n,i,o,a=r.body,s=0,l=e.length;l>s;s++)if(o=e[s],n=a,a=a.childNodes[o],!a){i=o;break}t?a?r.setStartBefore(a):r.setStart(n,i):a?r.setEndBefore(a):r.setEnd(n,i)}var r=this;return n(e.startAddress,!0),!t&&e.endAddress&&n(e.endAddress),r},equals:function(e){for(var t in this)if(this.hasOwnProperty(t)&&this[t]!==e[t])return!1;return!0},scrollIntoView:function(){var e=$('<span style="padding:0;margin:0;display:block;border:0">&nbsp;</span>');this.cloneRange().insertNode(e.get(0));var t=$(window).scrollTop(),n=$(window).height(),r=e.offset().top;(t-n>r||r>t+n)&&(r>t+n?window.scrollTo(0,r-n+e.height()):window.scrollTo(0,t-r)),e.remove()}}}(),function(){function e(e,t){var n=d.getNodeIndex;e=e.duplicate(),e.collapse(t);var r=e.parentElement();if(!r.hasChildNodes())return{container:r,offset:0};for(var i,o,s=r.children,l=e.duplicate(),c=0,u=s.length-1,f=-1;u>=c;){f=Math.floor((c+u)/2),i=s[f],l.moveToElementText(i);var h=l.compareEndPoints("StartToStart",e);if(h>0)u=f-1;else{if(!(0>h))return{container:r,offset:n(i)};c=f+1}}if(-1==f){if(l.moveToElementText(r),l.setEndPoint("StartToStart",e),o=l.text.replace(/(\r\n|\r)/g,"\n").length,s=r.childNodes,!o)return i=s[s.length-1],{container:i,offset:i.nodeValue.length};for(var p=s.length;o>0;)o-=s[--p].nodeValue.length;return{container:s[p],offset:-o}}if(l.collapse(h>0),l.setEndPoint(h>0?"StartToStart":"EndToStart",e),o=l.text.replace(/(\r\n|\r)/g,"\n").length,!o)return a.$empty[i.tagName]||a.$nonChild[i.tagName]?{container:r,offset:n(i)+(h>0?0:1)}:{container:i,offset:h>0?0:i.childNodes.length};for(;o>0;)try{var m=i;i=i[h>0?"previousSibling":"nextSibling"],o-=i.nodeValue.length}catch(g){return{container:r,offset:n(m)}}return{container:i,offset:h>0?-o:i.nodeValue.length+o}}function r(t,n){if(t.item)n.selectNode(t.item(0));else{var r=e(t,!0);n.setStart(r.container,r.offset),0!=t.compareEndPoints("StartToEnd",t)&&(r=e(t,!1),n.setEnd(r.container,r.offset))}return n}function i(e,t){var n;try{n=e.getNative(t).createRange()}catch(r){return null}var i=n.item?n.item(0):n.parentElement();return(i.ownerDocument||i)===e.document?n:null}var o=t.Selection=function(e,t){var r=this;r.document=e,r.body=t,n.ie9below&&(d.on(t,"beforedeactivate",function(){r._bakIERange=r.getIERange()}),d.on(t,"activate",function(){try{var e=i(r);e&&r.rangeInBody(e)||!r._bakIERange||r._bakIERange.select()}catch(t){}r._bakIERange=null}))};o.prototype={hasNativeRange:function(){if(!n.ie||n.ie9above)return this.getNative().rangeCount;try{var e=this.getIERange(),t=e.parentElement();return t===this.body||d.inDoc(e.parentElement(),this.body)}catch(r){return!1}},getNative:function(e){var t=this.document;try{return t?n.ie9below||e?t.selection:d.getWindow(t).getSelection():null}catch(r){return null}},getIERange:function(e){var t=i(this,e);return t&&this.rangeInBody(t,e)||!this._bakIERange?t:this._bakIERange},rangeInBody:function(e,t){var r=n.ie9below||t?e.item?e.item():e.parentElement():e.startContainer;return r===this.body||d.inDoc(r,this.body)},cache:function(){this.clear(),this._cachedRange=this.getRange(),this._cachedStartElement=this.getStart(),this._cachedStartElementPath=this.getStartElementPath()},getStartElementPath:function(){if(this._cachedStartElementPath)return this._cachedStartElementPath;var e=this.getStart();return e?d.findParents(e,!0,null,!0):[]},clear:function(){this._cachedStartElementPath=this._cachedRange=this._cachedStartElement=null},isFocus:function(){try{return n.ie&&i(this)||!n.ie&&this.getNative().rangeCount?!0:!1}catch(e){return!1}},getRange:function(){function e(e){for(var t=i.body.firstChild,n=e.collapsed;t&&t.firstChild;)e.setStart(t,0),t=t.firstChild;e.startContainer||e.setStart(i.body,0),n&&e.collapse(!0)}var i=this;if(null!=i._cachedRange)return this._cachedRange;var o=new t.Range(i.document,i.body);if(n.ie9below){var a=i.getIERange();if(a)try{r(a,o)}catch(s){e(o)}else e(o)}else{var l=i.getNative();if(l&&l.rangeCount&&i.rangeInBody(l.getRangeAt(0))){var c=l.getRangeAt(0),u=l.getRangeAt(l.rangeCount-1);o.setStart(c.startContainer,c.startOffset).setEnd(u.endContainer,u.endOffset),o.collapsed&&d.isBody(o.startContainer)&&!o.startOffset&&e(o)}else{if(this._bakRange&&d.inDoc(this._bakRange.startContainer,this.document))return this._bakRange;e(o)}}return this._bakRange=o},getStart:function(){if(this._cachedStartElement)return this._cachedStartElement;var e,t,r,i,o=n.ie9below?this.getIERange():this.getRange();if(n.ie9below){if(!o)return this.document.body.firstChild;if(o.item)return o.item(0);for(e=o.duplicate(),e.text.length>0&&e.moveStart("character",1),e.collapse(1),t=e.parentElement(),i=r=o.parentElement();r=r.parentNode;)if(r==t){t=i;break}}else if(t=o.startContainer,1==t.nodeType&&t.hasChildNodes()&&(t=t.childNodes[Math.min(t.childNodes.length-1,o.startOffset)]),3==t.nodeType)return t.parentNode;return t},getText:function(){var e,t;return this.isFocus()&&(e=this.getNative())?(t=n.ie9below?e.createRange():e.getRangeAt(0),n.ie9below?t.text:t.toString()):""}}}(),function(){function e(e,t){var n;if(t.textarea)if(i.isString(t.textarea)){for(var r,o=0,a=d.getElementsByTagName(e,"textarea");r=a[o++];)if(r.id=="ueditor_textarea_"+t.options.textarea){n=r;break}}else n=t.textarea;n||(e.appendChild(n=d.createElement(document,"textarea",{name:t.options.textarea,id:"ueditor_textarea_"+t.options.textarea,style:"display:none"})),t.textarea=n),n.value=t.hasContents()?t.options.allHtmlEnabled?t.getAllHtml():t.getContent(null,null,!0):""}function s(e){for(var t in UE.plugins)e.options.excludePlugins=$.isArray(e.options.excludePlugins)?e.options.excludePlugins:[e.options.excludePlugins],-1==$.inArray(t,e.options.excludePlugins)&&UE.plugins[t].call(e);
e.langIsReady=!0,e.fireEvent("langReady")}function l(e){for(var t in e)return t}var c,u=0,f=UE.Editor=function(e){var t=this;t.uid=u++,o.call(t),t.commands={},t.options=i.extend(i.clone(e||{}),UEDITOR_CONFIG,!0),t.shortcutkeys={},t.inputRules=[],t.outputRules=[],t.setOpt({isShow:!0,initialContent:"",initialStyle:".edui-editor-body .edui-body-container p{margin:5px 0;} .edui-editor-body .edui-body-container{border:0;outline:none;cursor:text;padding:0 10px 0;word-wrap:break-word;font-size:16px;font-family:sans-serif;}.edui-editor-body.focus{border:1px solid #5c9dff}",autoClearinitialContent:!1,iframeCssUrl:t.options.UEDITOR_HOME_URL+"themes/iframe.css",textarea:"editorValue",focus:!1,focusInEnd:!0,autoClearEmptyNode:!0,fullscreen:!1,readonly:!1,zIndex:999,imagePopup:!0,enterTag:"p",customDomain:!1,lang:"zh-cn",langPath:t.options.UEDITOR_HOME_URL+"lang/",theme:"default",themePath:t.options.UEDITOR_HOME_URL+"themes/",allHtmlEnabled:!1,scaleEnabled:!1,tableNativeEditInFF:!1,autoSyncData:!0,excludePlugins:""}),i.isEmptyObject(UE.I18N)?i.loadFile(document,{src:t.options.langPath+t.options.lang+"/"+t.options.lang+".js",tag:"script",type:"text/javascript",defer:"defer"},function(){s(t)}):(t.options.lang=l(UE.I18N),s(t)),UE.instants["ueditorInstant"+t.uid]=t};f.prototype={ready:function(e){var t=this;e&&(t.isReady?e.apply(t):t.addListener("ready",e))},setOpt:function(e,t){var n={};i.isString(e)?n[e]=t:n=e,i.extend(this.options,n,!0)},getOpt:function(e){return this.options[e]||""},destroy:function(){var e=this;e.fireEvent("destroy");var t=e.container.parentNode;t===document.body&&(t=e.container);var n=e.textarea;n?n.style.display="":(n=document.createElement("textarea"),t.parentNode.insertBefore(n,t)),n.style.width=e.body.offsetWidth+"px",n.style.height=e.body.offsetHeight+"px",n.value=e.getContent(),n.id=e.key,t.innerHTML="",d.remove(t);var r=e.key;for(var i in e)e.hasOwnProperty(i)&&delete this[i];UE.clearCache(r)},initialCont:function(e){if(e){if(e.getAttribute("name")&&(this.options.textarea=e.getAttribute("name")),e&&/script|textarea/gi.test(e.tagName)){var t=document.createElement("div");e.parentNode.insertBefore(t,e),this.options.initialContent=UE.htmlparser(e.value||e.innerHTML||this.options.initialContent).toHtml(),e.className&&(t.className=e.className),e.style.cssText&&(t.style.cssText=e.style.cssText),/textarea/i.test(e.tagName)?(this.textarea=e,this.textarea.style.display="none"):(e.parentNode.removeChild(e),e.id&&(t.id=e.id)),e=t,e.innerHTML=""}return e}return null},render:function(e){var t=this,r=t.options,o=function(t){var n=parseInt($(e).css(t));return isNaN(n)&&(n=0),n};if(i.isString(e)&&(e=document.getElementById(e)),e){i.cssRule("ueditor_body_css"+e.id,t.options.initialStyle,document),e=this.initialCont(e),e.className+=" edui-body-container",r.minFrameWidth=r.initialFrameWidth?r.initialFrameWidth:r.initialFrameWidth=$(e).width(),r.initialFrameHeight?r.minFrameHeight=r.initialFrameHeight:r.initialFrameHeight=r.minFrameHeight=$(e).height(),e.style.width=r.contentWidth?r.contentWidth+"px":/%$/.test(r.initialFrameWidth)?"100%":r.initialFrameWidth-20-o("border-left")-o("border-right")-o("padding-left")-o("padding-right")+"px";var a=/%$/.test(r.initialFrameHeight)?"100%":r.initialFrameHeight-o("padding-top")-o("padding-bottom");e.style.minHeight=a+"px",e.style.height="",e.style.zIndex=r.zIndex,n.ie&&n.version<=6&&(e.style.height=a,e.style.setExpression("height","this.scrollHeight <= "+a+' ? "'+a+'px" : "auto"')),this._setup(e)}},resize:function(e,t){var n=this;"number"==typeof e&&e>=0&&(n.body.style.width=e+"px"),"number"==typeof t&&t>=0&&(n.body.style.minHeight=t+"px"),n.fireEvent("resize",e,t)},_setup:function(r){var i=this,o=i.options;r.contentEditable=!0,document.body.spellcheck=!1,i.document=document,i.window=document.defaultView||document.parentWindow,i.body=r,i.$body=$(r),d.isBody=function(e){return e===r},i.selection=new t.Selection(document,i.body);var a;n.gecko&&(a=this.selection.getNative())&&a.removeAllRanges(),this._initEvents();for(var s=r.parentNode;s&&!d.isBody(s);s=s.parentNode)if("FORM"==s.tagName){i.form=s,i.options.autoSyncData?d.on(r,"blur",function(){e(s,i)}):d.on(s,"submit",function(){e(this,i)});break}if(o.initialContent)if(o.autoClearinitialContent){var l=i.execCommand;i.execCommand=function(){return i.fireEvent("firstBeforeExecCommand"),l.apply(i,arguments)},this._setDefaultContent(o.initialContent)}else this.setContent(o.initialContent,!1,!0);d.isEmptyNode(i.body)&&(i.body.innerHTML="<p>"+(n.ie?"":"<br/>")+"</p>"),o.focus&&setTimeout(function(){i.focus(i.options.focusInEnd),!i.options.autoClearinitialContent&&i._selectionChange()},0),i.container||(i.container=r.parentNode),i._bindshortcutKeys(),i.isReady=1,i.fireEvent("ready"),o.onready&&o.onready.call(i),(!n.ie||n.ie9above)&&d.on(i.body,["blur","focus"],function(e){var t=i.selection.getNative();if("blur"==e.type)t.rangeCount>0&&(i._bakRange=t.getRangeAt(0));else{try{i._bakRange&&t.addRange(i._bakRange)}catch(e){}i._bakRange=null}}),!o.isShow&&i.setHide(),o.readonly&&i.setDisabled()},sync:function(t){var n=this,r=t?document.getElementById(t):d.findParent(n.iframe.parentNode,function(e){return"FORM"==e.tagName},!0);r&&e(r,n)},setHeight:function(e,t){!t&&(this.options.initialFrameHeight=e),this.body.style.height=e+"px"},addshortcutkey:function(e,t){var n={};t?n[e]=t:n=e,i.extend(this.shortcutkeys,n)},_bindshortcutKeys:function(){var e=this,t=this.shortcutkeys;e.addListener("keydown",function(n,r){var i=r.keyCode||r.which;for(var o in t)for(var a,s=t[o].split(","),l=0;a=s[l++];){a=a.split(":");var c=a[0],u=a[1];(/^(ctrl)(\+shift)?\+(\d+)$/.test(c.toLowerCase())||/^(\d+)$/.test(c))&&(("ctrl"==RegExp.$1?r.ctrlKey||r.metaKey:0)&&(""!=RegExp.$2?r[RegExp.$2.slice(1)+"Key"]:1)&&i==RegExp.$3||i==RegExp.$1)&&(-1!=e.queryCommandState(o,u)&&e.execCommand(o,u),d.preventDefault(r))}})},getContent:function(e,t,n,r,o){var a=this;if(e&&i.isFunction(e)&&(t=e,e=""),t?!t():!this.hasContents())return"";a.fireEvent("beforegetcontent");var s=UE.htmlparser(a.body.innerHTML,r);return a.filterOutputRule(s),a.fireEvent("aftergetcontent",s),s.toHtml(o)},getAllHtml:function(){var e=this,t=[];if(e.fireEvent("getAllHtml",t),n.ie&&n.version>8){var o="";i.each(e.document.styleSheets,function(e){o+=e.href?'<link rel="stylesheet" type="text/css" href="'+e.href+'" />':"<style>"+e.cssText+"</style>"}),i.each(e.document.getElementsByTagName("script"),function(e){o+=e.outerHTML})}return"<html><head>"+(e.options.charset?'<meta http-equiv="Content-Type" content="text/html; charset='+e.options.charset+'"/>':"")+(o||e.document.getElementsByTagName("head")[0].innerHTML)+t.join("\n")+"</head><body "+(r&&n.version<9?'class="view"':"")+">"+e.getContent(null,null,!0)+"</body></html>"},getPlainTxt:function(){var e=new RegExp(d.fillChar,"g"),t=this.body.innerHTML.replace(/[\n\r]/g,"");return t=t.replace(/<(p|div)[^>]*>(<br\/?>|&nbsp;)<\/\1>/gi,"\n").replace(/<br\/?>/gi,"\n").replace(/<[^>\/]+>/g,"").replace(/(\n)?<\/([^>]+)>/g,function(e,t,n){return a.$block[n]?"\n":t?t:""}),t.replace(e,"").replace(/\u00a0/g," ").replace(/&nbsp;/g," ")},getContentTxt:function(){var e=new RegExp(d.fillChar,"g");return this.body[n.ie?"innerText":"textContent"].replace(e,"").replace(/\u00a0/g," ")},setContent:function(t,r,i){function o(e){return"DIV"==e.tagName&&e.getAttribute("cdata_tag")}var s=this;s.fireEvent("beforesetcontent",t);var l=UE.htmlparser(t);if(s.filterInputRule(l),t=l.toHtml(),s.body.innerHTML=(r?s.body.innerHTML:"")+t,"p"==s.options.enterTag){var c,u=this.body.firstChild;if(!u||1==u.nodeType&&(a.$cdata[u.tagName]||o(u)||d.isCustomeNode(u))&&u===this.body.lastChild)this.body.innerHTML="<p>"+(n.ie?"&nbsp;":"<br/>")+"</p>"+this.body.innerHTML;else for(var f=s.document.createElement("p");u;){for(;u&&(3==u.nodeType||1==u.nodeType&&a.p[u.tagName]&&!a.$cdata[u.tagName]);)c=u.nextSibling,f.appendChild(u),u=c;if(f.firstChild){if(!u){s.body.appendChild(f);break}u.parentNode.insertBefore(f,u),f=s.document.createElement("p")}u=u.nextSibling}}s.fireEvent("aftersetcontent"),s.fireEvent("contentchange"),!i&&s._selectionChange(),s._bakRange=s._bakIERange=s._bakNativeRange=null;var h;n.gecko&&(h=this.selection.getNative())&&h.removeAllRanges(),s.options.autoSyncData&&s.form&&e(s.form,s)},focus:function(e){try{var t=this,n=t.selection.getRange();e?n.setStartAtLast(t.body.lastChild).setCursor(!1,!0):n.select(!0),this.fireEvent("focus")}catch(r){}},_initEvents:function(){var e=this,t=e.body;e._proxyDomEvent=i.bind(e._proxyDomEvent,e),d.on(t,["click","contextmenu","mousedown","keydown","keyup","keypress","mouseup","mouseover","mouseout","selectstart"],e._proxyDomEvent),d.on(t,["focus","blur"],e._proxyDomEvent),d.on(t,["mouseup","keydown"],function(t){"keydown"==t.type&&(t.ctrlKey||t.metaKey||t.shiftKey||t.altKey)||2!=t.button&&e._selectionChange(250,t)})},_proxyDomEvent:function(e){return this.fireEvent(e.type.replace(/^on/,""),e)},_selectionChange:function(e,t){var r,i,o=this,a=!1;if(n.ie&&n.version<9&&t&&"mouseup"==t.type){var s=this.selection.getRange();s.collapsed||(a=!0,r=t.clientX,i=t.clientY)}clearTimeout(c),c=setTimeout(function(){if(o.selection.getNative()){var e;if(a&&"None"==o.selection.getNative().type){e=o.document.body.createTextRange();try{e.moveToPoint(r,i)}catch(n){e=null}}var s;e&&(s=o.selection.getIERange,o.selection.getIERange=function(){return e}),o.selection.cache(),s&&(o.selection.getIERange=s),o.selection._cachedRange&&o.selection._cachedStartElement&&(o.fireEvent("beforeselectionchange"),o.fireEvent("selectionchange",!!t),o.fireEvent("afterselectionchange"),o.selection.clear())}},e||50)},_callCmdFn:function(e,t){t=Array.prototype.slice.call(t,0);var n,r,i=t.shift().toLowerCase();return n=this.commands[i]||UE.commands[i],r=n&&n[e],n&&r||"queryCommandState"!=e?r?r.apply(this,[i].concat(t)):void 0:0},execCommand:function(e){this.selection.hasNativeRange()||this.focus(!0),e=e.toLowerCase();var t,n=this,r=n.commands[e]||UE.commands[e];return r&&r.execCommand?(r.notNeedUndo||n.__hasEnterExecCommand?(t=this._callCmdFn("execCommand",arguments),!n.__hasEnterExecCommand&&!r.ignoreContentChange&&!n._ignoreContentChange&&n.fireEvent("contentchange")):(n.__hasEnterExecCommand=!0,-1!=n.queryCommandState.apply(n,arguments)&&(n.fireEvent("saveScene"),n.fireEvent("beforeexeccommand",e),t=this._callCmdFn("execCommand",arguments),!r.ignoreContentChange&&!n._ignoreContentChange&&n.fireEvent("contentchange"),n.fireEvent("afterexeccommand",e),n.fireEvent("saveScene")),n.__hasEnterExecCommand=!1),!n.__hasEnterExecCommand&&!r.ignoreContentChange&&!n._ignoreContentChange&&n._selectionChange(),t):null},queryCommandState:function(){return this._callCmdFn("queryCommandState",arguments)},queryCommandValue:function(){return this._callCmdFn("queryCommandValue",arguments)},hasContents:function(e){if(e)for(var t,n=0;t=e[n++];)if(this.body.getElementsByTagName(t).length>0)return!0;if(!d.isEmptyBlock(this.body))return!0;for(e=["div"],n=0;t=e[n++];)for(var r,i=d.getElementsByTagName(this.body,t),o=0;r=i[o++];)if(d.isCustomeNode(r))return!0;return!1},reset:function(){this.fireEvent("reset")},setEnabled:function(){var e,t=this;if("false"==t.body.contentEditable){t.body.contentEditable=!0,e=t.selection.getRange();try{e.moveToBookmark(t.lastBk),delete t.lastBk}catch(n){e.setStartAtFirst(t.body).collapse(!0)}e.select(!0),t.bkqueryCommandState&&(t.queryCommandState=t.bkqueryCommandState,delete t.bkqueryCommandState),t.fireEvent("selectionchange")}},enable:function(){return this.setEnabled()},setDisabled:function(e){var t=this;e=e?i.isArray(e)?e:[e]:[],"true"==t.body.contentEditable&&(t.lastBk||(t.lastBk=t.selection.getRange().createBookmark(!0)),t.body.contentEditable=!1,t.bkqueryCommandState=t.queryCommandState,t.queryCommandState=function(n){return-1!=i.indexOf(e,n)?t.bkqueryCommandState.apply(t,arguments):-1},t.fireEvent("selectionchange"))},disable:function(e){return this.setDisabled(e)},_setDefaultContent:function(){function e(){var t=this;t.document.getElementById("initContent")&&(t.body.innerHTML="<p>"+(r?"":"<br/>")+"</p>",t.removeListener("firstBeforeExecCommand focus",e),setTimeout(function(){t.focus(),t._selectionChange()},0))}return function(t){var n=this;n.body.innerHTML='<p id="initContent">'+t+"</p>",n.addListener("firstBeforeExecCommand focus",e)}}(),setShow:function(){var e=this,t=e.selection.getRange();if("none"==e.container.style.display){try{t.moveToBookmark(e.lastBk),delete e.lastBk}catch(n){t.setStartAtFirst(e.body).collapse(!0)}setTimeout(function(){t.select(!0)},100),e.container.style.display=""}},show:function(){return this.setShow()},setHide:function(){var e=this;e.lastBk||(e.lastBk=e.selection.getRange().createBookmark(!0)),e.container.style.display="none"},hide:function(){return this.setHide()},getLang:function(e){var t=UE.I18N[this.options.lang];if(!t)throw Error("not import language file");e=(e||"").split(".");for(var n,r=0;(n=e[r++])&&(t=t[n]););return t},getContentLength:function(e,t){var n=this.getContent(!1,!1,!0).length;if(e){t=(t||[]).concat(["hr","img","iframe"]),n=this.getContentTxt().replace(/[\t\r\n]+/g,"").length;for(var r,i=0;r=t[i++];)n+=this.body.getElementsByTagName(r).length}return n},addInputRule:function(e,t){e.ignoreUndo=t,this.inputRules.push(e)},filterInputRule:function(e,t){for(var n,r=0;n=this.inputRules[r++];)t&&n.ignoreUndo||n.call(this,e)},addOutputRule:function(e,t){e.ignoreUndo=t,this.outputRules.push(e)},filterOutputRule:function(e,t){for(var n,r=0;n=this.outputRules[r++];)t&&n.ignoreUndo||n.call(this,e)}},i.inherits(f,o)}(),UE.filterWord=function(){function e(e){return/(class="?Mso|style="[^"]*\bmso\-|w:WordDocument|<v:)/gi.test(e)}function t(e){return e=e.replace(/[\d.]+\w+/g,function(e){return i.transUnitToPx(e)})}function r(e){return e.replace(/[\t\r\n]+/g,"").replace(/<!--[\s\S]*?-->/gi,"").replace(/<v:shape [^>]*>[\s\S]*?.<\/v:shape>/gi,function(e){if(n.opera)return"";try{var r=e.match(/width:([ \d.]*p[tx])/i)[1],i=e.match(/height:([ \d.]*p[tx])/i)[1],o=e.match(/src=\s*"([^"]*)"/i)[1];return'<img width="'+t(r)+'" height="'+t(i)+'" src="'+o+'" />'}catch(a){return""}}).replace(/<\/?div[^>]*>/g,"").replace(/v:\w+=(["']?)[^'"]+\1/g,"").replace(/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|xml|meta|link|style|\w+:\w+)(?=[\s\/>]))[^>]*>/gi,"").replace(/<p [^>]*class="?MsoHeading"?[^>]*>(.*?)<\/p>/gi,"<p><strong>$1</strong></p>").replace(/\s+(class|lang|align)\s*=\s*(['"]?)([\w-]+)\2/gi,function(e,t,n,r){return"class"==t&&"MsoListParagraph"==r?e:""}).replace(/<(font|span)[^>]*>\s*<\/\1>/gi,"").replace(/(<[a-z][^>]*)\sstyle=(["'])([^\2]*?)\2/gi,function(e,n,r,i){for(var o,a=[],s=i.replace(/^\s+|\s+$/,"").replace(/&#39;/g,"'").replace(/&quot;/gi,"'").split(/;\s*/g),l=0;o=s[l];l++){var d,c,u=o.split(":");if(2==u.length){if(d=u[0].toLowerCase(),c=u[1].toLowerCase(),/^(background)\w*/.test(d)&&0==c.replace(/(initial|\s)/g,"").length||/^(margin)\w*/.test(d)&&/^0\w+$/.test(c))continue;switch(d){case"mso-padding-alt":case"mso-padding-top-alt":case"mso-padding-right-alt":case"mso-padding-bottom-alt":case"mso-padding-left-alt":case"mso-margin-alt":case"mso-margin-top-alt":case"mso-margin-right-alt":case"mso-margin-bottom-alt":case"mso-margin-left-alt":case"mso-height":case"mso-width":case"mso-vertical-align-alt":/<table/.test(n)||(a[l]=d.replace(/^mso-|-alt$/g,"")+":"+t(c));continue;case"horiz-align":a[l]="text-align:"+c;continue;case"vert-align":a[l]="vertical-align:"+c;continue;case"font-color":case"mso-foreground":a[l]="color:"+c;continue;case"mso-background":case"mso-highlight":a[l]="background:"+c;continue;case"mso-default-height":a[l]="min-height:"+t(c);continue;case"mso-default-width":a[l]="min-width:"+t(c);continue;case"mso-padding-between-alt":a[l]="border-collapse:separate;border-spacing:"+t(c);continue;case"text-line-through":("single"==c||"double"==c)&&(a[l]="text-decoration:line-through");continue;case"mso-zero-height":"yes"==c&&(a[l]="display:none");continue;case"background":break;case"margin":if(!/[1-9]/.test(c))continue}if(/^(mso|column|font-emph|lang|layout|line-break|list-image|nav|panose|punct|row|ruby|sep|size|src|tab-|table-border|text-(?:decor|trans)|top-bar|version|vnd|word-break)/.test(d)||/text\-indent|padding|margin/.test(d)&&/\-[\d.]+/.test(c))continue;a[l]=d+":"+u[1]}}return n+(a.length?' style="'+a.join(";").replace(/;{2,}/g,";")+'"':"")}).replace(/[\d.]+(cm|pt)/g,function(e){return i.transUnitToPx(e)})}return function(t){return e(t)?r(t):t}}(),!function(){function e(e,t,n){return e.push(h),t+(n?1:-1)}function t(e,t){for(var n=0;t>n;n++)e.push(f)}function n(i,l,d,c){switch(i.type){case"root":for(var u,f=0;u=i.children[f++];)d&&"element"==u.type&&!a.$inlineWithA[u.tagName]&&f>1&&(e(l,c,!0),t(l,c)),n(u,l,d,c);break;case"text":r(i,l);break;case"element":o(i,l,d,c);break;case"comment":s(i,l,d)}return l}function r(e,t){t.push("pre"==e.parentNode.tagName?e.data:e.data.replace(/[ ]{2}/g," &nbsp;"))}function o(r,i,o,s){var l="";if(r.attrs){l=[];var d=r.attrs;for(var c in d)l.push(c+(void 0!==d[c]?'="'+d[c]+'"':""));l=l.join(" ")}if(i.push("<"+r.tagName+(l?" "+l:"")+(a.$empty[r.tagName]?"/":"")+">"),o&&!a.$inlineWithA[r.tagName]&&"pre"!=r.tagName&&r.children&&r.children.length&&(s=e(i,s,!0),t(i,s)),r.children&&r.children.length)for(var u,f=0;u=r.children[f++];)o&&"element"==u.type&&!a.$inlineWithA[u.tagName]&&f>1&&(e(i,s),t(i,s)),n(u,i,o,s);a.$empty[r.tagName]||(o&&!a.$inlineWithA[r.tagName]&&"pre"!=r.tagName&&r.children&&r.children.length&&(s=e(i,s),t(i,s)),i.push("</"+r.tagName+">"))}function s(e,t){t.push("<!--"+e.data+"-->")}function l(e,t){var n;if("element"==e.type&&e.getAttr("id")==t)return e;if(e.children&&e.children.length)for(var r,i=0;r=e.children[i++];)if(n=l(r,t))return n}function d(e,t,n){if("element"==e.type&&e.tagName==t&&n.push(e),e.children&&e.children.length)for(var r,i=0;r=e.children[i++];)d(r,t,n)}function c(e,t){if(e.children&&e.children.length)for(var n,r=0;n=e.children[r];)c(n,t),n.parentNode&&(n.children&&n.children.length&&t(n),n.parentNode&&r++);else t(e)}var u=UE.uNode=function(e){this.type=e.type,this.data=e.data,this.tagName=e.tagName,this.parentNode=e.parentNode,this.attrs=e.attrs||{},this.children=e.children},f="    ",h="\n";u.createElement=function(e){return/[<>]/.test(e)?UE.htmlparser(e).children[0]:new u({type:"element",children:[],tagName:e})},u.createText=function(e,t){return new UE.uNode({type:"text",data:t?e:i.unhtml(e||"")})},u.prototype={toHtml:function(e){var t=[];return n(this,t,e,0),t.join("")},innerHTML:function(e){if("element"!=this.type||a.$empty[this.tagName])return this;if(i.isString(e)){if(this.children)for(var t,n=0;t=this.children[n++];)t.parentNode=null;this.children=[];for(var t,r=UE.htmlparser(e),n=0;t=r.children[n++];)this.children.push(t),t.parentNode=this;return this}var r=new UE.uNode({type:"root",children:this.children});return r.toHtml()},innerText:function(e,t){if("element"!=this.type||a.$empty[this.tagName])return this;if(e){if(this.children)for(var n,r=0;n=this.children[r++];)n.parentNode=null;return this.children=[],this.appendChild(u.createText(e,t)),this}return this.toHtml().replace(/<[^>]+>/g,"")},getData:function(){return"element"==this.type?"":this.data},firstChild:function(){return this.children?this.children[0]:null},lastChild:function(){return this.children?this.children[this.children.length-1]:null},previousSibling:function(){for(var e,t=this.parentNode,n=0;e=t.children[n];n++)if(e===this)return 0==n?null:t.children[n-1]},nextSibling:function(){for(var e,t=this.parentNode,n=0;e=t.children[n++];)if(e===this)return t.children[n]},replaceChild:function(e,t){if(this.children){e.parentNode&&e.parentNode.removeChild(e);for(var n,r=0;n=this.children[r];r++)if(n===t)return this.children.splice(r,1,e),t.parentNode=null,e.parentNode=this,e}},appendChild:function(e){if("root"==this.type||"element"==this.type&&!a.$empty[this.tagName]){this.children||(this.children=[]),e.parentNode&&e.parentNode.removeChild(e);for(var t,n=0;t=this.children[n];n++)if(t===e){this.children.splice(n,1);break}return this.children.push(e),e.parentNode=this,e}},insertBefore:function(e,t){if(this.children){e.parentNode&&e.parentNode.removeChild(e);for(var n,r=0;n=this.children[r];r++)if(n===t)return this.children.splice(r,0,e),e.parentNode=this,e}},insertAfter:function(e,t){if(this.children){e.parentNode&&e.parentNode.removeChild(e);for(var n,r=0;n=this.children[r];r++)if(n===t)return this.children.splice(r+1,0,e),e.parentNode=this,e}},removeChild:function(e,t){if(this.children)for(var n,r=0;n=this.children[r];r++)if(n===e){if(this.children.splice(r,1),n.parentNode=null,t&&n.children&&n.children.length)for(var i,o=0;i=n.children[o];o++)this.children.splice(r+o,0,i),i.parentNode=this;return n}},getAttr:function(e){return this.attrs&&this.attrs[e.toLowerCase()]},setAttr:function(e,t){if(!e)return void delete this.attrs;if(this.attrs||(this.attrs={}),i.isObject(e))for(var n in e)e[n]?this.attrs[n.toLowerCase()]=e[n]:delete this.attrs[n];else t?this.attrs[e.toLowerCase()]=t:delete this.attrs[e]},getIndex:function(){for(var e,t=this.parentNode,n=0;e=t.children[n];n++)if(e===this)return n;return-1},getNodeById:function(e){var t;if(this.children&&this.children.length)for(var n,r=0;n=this.children[r++];)if(t=l(n,e))return t},getNodesByTagName:function(e){e=i.trim(e).replace(/[ ]{2,}/g," ").split(" ");var t=[],n=this;return i.each(e,function(e){if(n.children&&n.children.length)for(var r,i=0;r=n.children[i++];)d(r,e,t)}),t},getStyle:function(e){var t=this.getAttr("style");if(!t)return"";var n=new RegExp("(^|;)\\s*"+e+":([^;]+)","i"),r=t.match(n);return r&&r[0]?r[2]:""},setStyle:function(e,t){function n(e,t){var n=new RegExp("(^|;)\\s*"+e+":([^;]+;?)","gi");r=r.replace(n,"$1"),t&&(r=e+":"+i.unhtml(t)+";"+r)}var r=this.getAttr("style");if(r||(r=""),i.isObject(e))for(var o in e)n(o,e[o]);else n(e,t);this.setAttr("style",i.trim(r))},traversal:function(e){return this.children&&this.children.length&&c(this,e),this}}}(),UE.htmlparser=function(e,t){function n(e,t){if(p[e.tagName]){var n=f.createElement(p[e.tagName]);e.appendChild(n),n.appendChild(f.createText(t)),e=n}else e.appendChild(f.createText(t))}function r(e,t,n){var o;if(o=h[t]){for(var s,d=e;"root"!=d.type;){if(i.isArray(o)?-1!=i.indexOf(o,d.tagName):o==d.tagName){e=d,s=!0;break}d=d.parentNode}s||(e=r(e,i.isArray(o)?o[0]:o))}var c=new f({parentNode:e,type:"element",tagName:t.toLowerCase(),children:a.$empty[t]?null:[]});if(n){for(var u,p={};u=l.exec(n);)p[u[1].toLowerCase()]=i.unhtml(u[2]||u[3]||u[4]);c.attrs=p}return e.children.push(c),a.$empty[t]?e:c}function o(e,t){e.children.push(new f({type:"comment",data:t,parentNode:e}))}var s=/<(?:(?:\/([^>]+)>)|(?:!--([\S|\s]*?)-->)|(?:([^\s\/>]+)\s*((?:(?:"[^"]*")|(?:'[^']*')|[^"'<>])*)\/?>))/g,l=/([\w\-:.]+)(?:(?:\s*=\s*(?:(?:"([^"]*)")|(?:'([^']*)')|([^\s>]+)))|(?=\s|$))/g,c={b:1,code:1,i:1,u:1,strike:1,s:1,tt:1,strong:1,q:1,samp:1,em:1,span:1,sub:1,img:1,sup:1,font:1,big:1,small:1,iframe:1,a:1,br:1,pre:1};e=e.replace(new RegExp(d.fillChar,"g"),""),t||(e=e.replace(new RegExp("[\\r\\t\\n"+(t?"":" ")+"]*</?(\\w+)\\s*(?:[^>]*)>[\\r\\t\\n"+(t?"":" ")+"]*","g"),function(e,n){return n&&c[n.toLowerCase()]?e.replace(/(^[\n\r]+)|([\n\r]+$)/g,""):e.replace(new RegExp("^[\\r\\n"+(t?"":" ")+"]+"),"").replace(new RegExp("[\\r\\n"+(t?"":" ")+"]+$"),"")}));for(var u,f=UE.uNode,h={td:"tr",tr:["tbody","thead","tfoot"],tbody:"table",th:"tr",thead:"table",tfoot:"table",caption:"table",li:["ul","ol"],dt:"dl",dd:"dl",option:"select"},p={ol:"li",ul:"li"},m=0,g=0,v=new f({type:"root",children:[]}),y=v;u=s.exec(e);){m=u.index;try{if(m>g&&n(y,e.slice(g,m)),u[3])a.$cdata[y.tagName]?n(y,u[0]):y=r(y,u[3].toLowerCase(),u[4]);else if(u[1]){if("root"!=y.type)if(a.$cdata[y.tagName]&&!a.$cdata[u[1]])n(y,u[0]);else{for(var b=y;"element"==y.type&&y.tagName!=u[1].toLowerCase();)if(y=y.parentNode,"root"==y.type)throw y=b,"break";y=y.parentNode}}else u[2]&&o(y,u[2])}catch(C){}g=s.lastIndex}return g<e.length&&n(y,e.slice(g)),v},UE.filterNode=function(){function e(t,n){switch(t.type){case"text":break;case"element":var r;if(r=n[t.tagName])if("-"===r)t.parentNode.removeChild(t);else if(i.isFunction(r)){var o=t.parentNode,s=t.getIndex();if(r(t),t.parentNode){if(t.children)for(var l,d=0;l=t.children[d];)e(l,n),l.parentNode&&d++}else for(var l,d=s;l=o.children[d];)e(l,n),l.parentNode&&d++}else{var c=r.$;if(c&&t.attrs){var u,f={};for(var h in c){if(u=t.getAttr(h),"style"==h&&i.isArray(c[h])){var p=[];i.each(c[h],function(e){var n;(n=t.getStyle(e))&&p.push(e+":"+n)}),u=p.join(";")}u&&(f[h]=u)}t.attrs=f}if(t.children)for(var l,d=0;l=t.children[d];)e(l,n),l.parentNode&&d++}else if(a.$cdata[t.tagName])t.parentNode.removeChild(t);else{var o=t.parentNode,s=t.getIndex();t.parentNode.removeChild(t,!0);for(var l,d=s;l=o.children[d];)e(l,n),l.parentNode&&d++}break;case"comment":t.parentNode.removeChild(t)}}return function(t,n){if(i.isEmptyObject(n))return t;var r;(r=n["-"])&&i.each(r.split(" "),function(e){n[e]="-"});for(var o,a=0;o=t.children[a];)e(o,n),o.parentNode&&a++;return t}}(),UE.commands.inserthtml={execCommand:function(e,t,r){var o,s,l=this;if(t&&l.fireEvent("beforeinserthtml",t)!==!0){if(o=l.selection.getRange(),s=o.document.createElement("div"),s.style.display="inline",!r){var u=UE.htmlparser(t);l.options.filterRules&&UE.filterNode(u,l.options.filterRules),l.filterInputRule(u),t=u.toHtml()}if(s.innerHTML=i.trim(t),!o.collapsed){var f=o.startContainer;if(d.isFillChar(f)&&o.setStartBefore(f),f=o.endContainer,d.isFillChar(f)&&o.setEndAfter(f),o.txtToElmBoundary(),o.endContainer&&1==o.endContainer.nodeType&&(f=o.endContainer.childNodes[o.endOffset],f&&d.isBr(f)&&o.setEndAfter(f)),0==o.startOffset&&(f=o.startContainer,d.isBoundaryNode(f,"firstChild")&&(f=o.endContainer,o.endOffset==(3==f.nodeType?f.nodeValue.length:f.childNodes.length)&&d.isBoundaryNode(f,"lastChild")&&(l.body.innerHTML="<p>"+(n.ie?"":"<br/>")+"</p>",o.setStart(l.body.firstChild,0).collapse(!0)))),!o.collapsed&&o.deleteContents(),1==o.startContainer.nodeType){var h,p=o.startContainer.childNodes[o.startOffset];if(p&&d.isBlockElm(p)&&(h=p.previousSibling)&&d.isBlockElm(h)){for(o.setEnd(h,h.childNodes.length).collapse();p.firstChild;)h.appendChild(p.firstChild);d.remove(p)}}}var p,m,h,g,v,y=0;for(o.inFillChar()&&(p=o.startContainer,d.isFillChar(p)?(o.setStartBefore(p).collapse(!0),d.remove(p)):d.isFillChar(p,!0)&&(p.nodeValue=p.nodeValue.replace(c,""),o.startOffset--,o.collapsed&&o.collapse(!0)));p=s.firstChild;){if(y){for(var b=l.document.createElement("p");p&&(3==p.nodeType||!a.$block[p.tagName]);)v=p.nextSibling,b.appendChild(p),p=v;b.firstChild&&(p=b)}if(o.insertNode(p),v=p.nextSibling,!y&&p.nodeType==d.NODE_ELEMENT&&d.isBlockElm(p)&&(m=d.findParent(p,function(e){return d.isBlockElm(e)}),m&&"body"!=m.tagName.toLowerCase()&&(!a[m.tagName][p.nodeName]||p.parentNode!==m))){if(a[m.tagName][p.nodeName])for(g=p.parentNode;g!==m;)h=g,g=g.parentNode;else h=m;d.breakParent(p,h||g);var h=p.previousSibling;d.trimWhiteTextNode(h),h.childNodes.length||d.remove(h),!n.ie&&(C=p.nextSibling)&&d.isBlockElm(C)&&C.lastChild&&!d.isBr(C.lastChild)&&C.appendChild(l.document.createElement("br")),y=1}var C=p.nextSibling;if(!s.firstChild&&C&&d.isBlockElm(C)){o.setStart(C,0).collapse(!0);break}o.setEndAfter(p).collapse()}if(p=o.startContainer,v&&d.isBr(v)&&d.remove(v),d.isBlockElm(p)&&d.isEmptyNode(p))if(v=p.nextSibling)d.remove(p),1==v.nodeType&&a.$block[v.tagName]&&o.setStart(v,0).collapse(!0).shrinkBoundary();else try{p.innerHTML=n.ie?d.fillChar:"<br/>"}catch(E){o.setStartBefore(p),d.remove(p)}try{if(n.ie9below&&1==o.startContainer.nodeType&&!o.startContainer.childNodes[o.startOffset]){var N=o.startContainer,h=N.childNodes[o.startOffset-1];if(h&&1==h.nodeType&&a.$empty[h.tagName]){var x=this.document.createTextNode(d.fillChar);o.insertNode(x).setStart(x,0).collapse(!0)}}o.select(!0)}catch(E){}setTimeout(function(){o=l.selection.getRange(),o.scrollIntoView(),l.fireEvent("afterinserthtml")},200)}}},UE.plugins.undo=function(){function e(e,t){if(e.length!=t.length)return 0;for(var n=0,r=e.length;r>n;n++)if(e[n]!=t[n])return 0;return 1}function r(t,n){return t.collapsed!=n.collapsed?0:e(t.startAddress,n.startAddress)&&e(t.endAddress,n.endAddress)?1:0}function o(){this.list=[],this.index=0,this.hasUndo=!1,this.hasRedo=!1,this.undo=function(){if(this.hasUndo){if(!this.list[this.index-1]&&1==this.list.length)return void this.reset();for(;this.list[this.index].content==this.list[this.index-1].content;)if(this.index--,0==this.index)return this.restore(0);this.restore(--this.index)}},this.redo=function(){if(this.hasRedo){for(;this.list[this.index].content==this.list[this.index+1].content;)if(this.index++,this.index==this.list.length-1)return this.restore(this.index);this.restore(++this.index)}},this.restore=function(){var e=this.editor,r=this.list[this.index],o=UE.htmlparser(r.content.replace(h,""));e.options.autoClearEmptyNode=!1,e.filterInputRule(o,!0),e.options.autoClearEmptyNode=m,e.body.innerHTML=o.toHtml(),e.fireEvent("afterscencerestore"),n.ie&&i.each(d.getElementsByTagName(e.document,"td th caption p"),function(t){d.isEmptyNode(t)&&d.fillNode(e.document,t)});try{var s=new t.Range(e.document,e.body).moveToAddress(r.address);if(n.ie&&s.collapsed&&1==s.startContainer.nodeType){var l=s.startContainer.childNodes[s.startOffset];(!l||1==l.nodeType&&a.$empty[l])&&s.insertNode(e.document.createTextNode(" ")).collapse(!0)}s.select(p[s.startContainer.nodeName.toLowerCase()])}catch(c){}this.update(),this.clearKey(),e.fireEvent("reset",!0)},this.getScene=function(){var e=this.editor,t=e.selection.getRange(),r=t.createAddress(!1,!0);e.fireEvent("beforegetscene");var i=UE.htmlparser(e.body.innerHTML,!0);e.options.autoClearEmptyNode=!1,e.filterOutputRule(i,!0),e.options.autoClearEmptyNode=m;var o=i.toHtml();return n.ie&&(o=o.replace(/>&nbsp;</g,"><").replace(/\s*</g,"<").replace(/>\s*/g,">")),e.fireEvent("aftergetscene"),{address:r,content:o}},this.save=function(e,t){clearTimeout(l);var n=this.getScene(t),i=this.list[this.index];i&&i.content==n.content&&(e?1:r(i.address,n.address))||(this.list=this.list.slice(0,this.index+1),this.list.push(n),this.list.length>u&&this.list.shift(),this.index=this.list.length-1,this.clearKey(),this.update())},this.update=function(){this.hasRedo=!!this.list[this.index+1],this.hasUndo=!!this.list[this.index-1]},this.reset=function(){this.list=[],this.index=0,this.hasUndo=!1,this.hasRedo=!1,this.clearKey()},this.clearKey=function(){y=0,g=null}}function s(){this.undoManger.save()}var l,c=this,u=c.options.maxUndoCount||20,f=c.options.maxInputCount||20,h=new RegExp(d.fillChar+"|</hr>","gi"),p={ol:1,ul:1,table:1,tbody:1,tr:1,body:1},m=c.options.autoClearEmptyNode;c.undoManger=new o,c.undoManger.editor=c,c.addListener("saveScene",function(){var e=Array.prototype.splice.call(arguments,1);this.undoManger.save.apply(this.undoManger,e)}),c.addListener("beforeexeccommand",s),c.addListener("afterexeccommand",s),c.addListener("reset",function(e,t){t||this.undoManger.reset()}),c.commands.redo=c.commands.undo={execCommand:function(e){this.undoManger[e]()},queryCommandState:function(e){return this.undoManger["has"+("undo"==e.toLowerCase()?"Undo":"Redo")]?0:-1},notNeedUndo:1};var g,v={16:1,17:1,18:1,37:1,38:1,39:1,40:1},y=0,b=!1;c.addListener("ready",function(){d.on(this.body,"compositionstart",function(){b=!0}),d.on(this.body,"compositionend",function(){b=!1})}),c.addshortcutkey({Undo:"ctrl+90",Redo:"ctrl+89,shift+ctrl+z"});var C=!0;c.addListener("keydown",function(e,t){function n(e){e.selection.getRange().collapsed&&e.fireEvent("contentchange"),e.undoManger.save(!1,!0),e.fireEvent("selectionchange")}var r=this,i=t.keyCode||t.which;if(!(v[i]||t.ctrlKey||t.metaKey||t.shiftKey||t.altKey)){if(b)return;if(!r.selection.getRange().collapsed)return r.undoManger.save(!1,!0),void(C=!1);0==r.undoManger.list.length&&r.undoManger.save(!0),clearTimeout(l),l=setTimeout(function(){if(b)var e=setInterval(function(){b||(n(r),clearInterval(e))},300);else n(r)},200),g=i,y++,y>=f&&n(r)}}),c.addListener("keyup",function(e,t){var n=t.keyCode||t.which;
if(!(v[n]||t.ctrlKey||t.metaKey||t.shiftKey||t.altKey)){if(b)return;C||(this.undoManger.save(!1,!0),C=!0)}})},UE.plugins.paste=function(){function e(e){var t=this.document;if(!t.getElementById("baidu_pastebin")){var r=this.selection.getRange(),i=r.createBookmark(),o=t.createElement("div");o.id="baidu_pastebin",n.webkit&&o.appendChild(t.createTextNode(d.fillChar+d.fillChar)),this.body.appendChild(o),i.start.style.display="",o.style.cssText="position:absolute;width:1px;height:1px;overflow:hidden;left:-1000px;white-space:nowrap;top:"+$(i.start).position().top+"px",r.selectNodeContents(o).select(!0),setTimeout(function(){if(n.webkit)for(var a,s=0,l=t.querySelectorAll("#baidu_pastebin");a=l[s++];){if(!d.isEmptyNode(a)){o=a;break}d.remove(a)}try{o.parentNode.removeChild(o)}catch(c){}r.moveToBookmark(i).select(!0),e(o)},0)}}function t(e){var t;if(e.firstChild){for(var o,a=d.getElementsByTagName(e,"span"),s=0;o=a[s++];)("_baidu_cut_start"==o.id||"_baidu_cut_end"==o.id)&&d.remove(o);if(n.webkit){for(var l,c=e.querySelectorAll("div br"),s=0;l=c[s++];){var u=l.parentNode;"DIV"==u.tagName&&1==u.childNodes.length&&(u.innerHTML="<p><br/></p>",d.remove(u))}for(var f,h=e.querySelectorAll("#baidu_pastebin"),s=0;f=h[s++];){var p=r.document.createElement("p");for(f.parentNode.insertBefore(p,f);f.firstChild;)p.appendChild(f.firstChild);d.remove(f)}for(var m,g=e.querySelectorAll("meta"),s=0;m=g[s++];)d.remove(m);var c=e.querySelectorAll("br");for(s=0;m=c[s++];)/^apple-/i.test(m.className)&&d.remove(m)}if(n.gecko){var v=e.querySelectorAll("[_moz_dirty]");for(s=0;m=v[s++];)m.removeAttribute("_moz_dirty")}if(!n.ie)for(var m,y=e.querySelectorAll("span.Apple-style-span"),s=0;m=y[s++];)d.remove(m,!0);t=e.innerHTML,t=UE.filterWord(t);var b=UE.htmlparser(t);if(r.options.filterRules&&UE.filterNode(b,r.options.filterRules),r.filterInputRule(b),n.webkit){var C=b.lastChild();C&&"element"==C.type&&"br"==C.tagName&&b.removeChild(C),i.each(r.body.querySelectorAll("div"),function(e){d.isEmptyBlock(e)&&d.remove(e)})}if(t={html:b.toHtml()},r.fireEvent("beforepaste",t,b),!t.html)return;r.execCommand("insertHtml",t.html,!0),r.fireEvent("afterpaste",t)}}var r=this;r.addListener("ready",function(){d.on(r.body,"cut",function(){var e=r.selection.getRange();!e.collapsed&&r.undoManger&&r.undoManger.save()}),d.on(r.body,n.ie||n.opera?"keydown":"paste",function(i){(!n.ie&&!n.opera||(i.ctrlKey||i.metaKey)&&"86"==i.keyCode)&&e.call(r,function(e){t(e)})})})},UE.plugins.enterkey=function(){var e,t=this,r=t.options.enterTag;t.addListener("keyup",function(r,i){var o=i.keyCode||i.which;if(13==o){var a,s=t.selection.getRange(),l=s.startContainer;if(n.ie)t.fireEvent("saveScene",!0,!0);else{if(/h\d/i.test(e)){if(n.gecko){var c=d.findParentByTagName(l,["h1","h2","h3","h4","h5","h6","blockquote","caption","table"],!0);c||(t.document.execCommand("formatBlock",!1,"<p>"),a=1)}else if(1==l.nodeType){var u,f=t.document.createTextNode("");if(s.insertNode(f),u=d.findParentByTagName(f,"div",!0)){for(var h=t.document.createElement("p");u.firstChild;)h.appendChild(u.firstChild);u.parentNode.insertBefore(h,u),d.remove(u),s.setStartBefore(f).setCursor(),a=1}d.remove(f)}t.undoManger&&a&&t.undoManger.save()}n.opera&&s.select()}}}),t.addListener("keydown",function(i,o){var a=o.keyCode||o.which;if(13==a){if(t.fireEvent("beforeenterkeydown"))return void d.preventDefault(o);t.fireEvent("saveScene",!0,!0),e="";var s=t.selection.getRange();if(!s.collapsed){var l=s.startContainer,c=s.endContainer,u=d.findParentByTagName(l,"td",!0),f=d.findParentByTagName(c,"td",!0);if(u&&f&&u!==f||!u&&f||u&&!f)return void(o.preventDefault?o.preventDefault():o.returnValue=!1)}"p"==r&&(n.ie||(l=d.findParentByTagName(s.startContainer,["ol","ul","p","h1","h2","h3","h4","h5","h6","blockquote","caption"],!0),l||n.opera?(e=l.tagName,"p"==l.tagName.toLowerCase()&&n.gecko&&d.removeDirtyAttr(l)):(t.document.execCommand("formatBlock",!1,"<p>"),n.gecko&&(s=t.selection.getRange(),l=d.findParentByTagName(s.startContainer,"p",!0),l&&d.removeDirtyAttr(l)))))}})},UE.plugins.selectall=function(){var e=this;e.commands.selectall={execCommand:function(){var e=this,t=e.body,r=e.selection.getRange();r.selectNodeContents(t),d.isEmptyBlock(t)&&(n.opera&&t.firstChild&&1==t.firstChild.nodeType&&r.setStartAtFirst(t.firstChild),r.collapse(!0)),r.select(!0)},notNeedUndo:1},e.addshortcutkey({selectAll:"ctrl+65"})},UE.plugins.keystrokes=function(){var e=this,t=!0;e.addListener("keydown",function(r,i){var o=i.keyCode||i.which,a=e.selection.getRange();if(!a.collapsed&&!(i.ctrlKey||i.shiftKey||i.altKey||i.metaKey)&&(o>=65&&90>=o||o>=48&&57>=o||o>=96&&111>=o||{13:1,8:1,46:1}[o])){var s=a.startContainer;if(d.isFillChar(s)&&a.setStartBefore(s),s=a.endContainer,d.isFillChar(s)&&a.setEndAfter(s),a.txtToElmBoundary(),a.endContainer&&1==a.endContainer.nodeType&&(s=a.endContainer.childNodes[a.endOffset],s&&d.isBr(s)&&a.setEndAfter(s)),0==a.startOffset&&(s=a.startContainer,d.isBoundaryNode(s,"firstChild")&&(s=a.endContainer,a.endOffset==(3==s.nodeType?s.nodeValue.length:s.childNodes.length)&&d.isBoundaryNode(s,"lastChild"))))return e.fireEvent("saveScene"),e.body.innerHTML="<p>"+(n.ie?"":"<br/>")+"</p>",a.setStart(e.body.firstChild,0).setCursor(!1,!0),void e._selectionChange()}if(8==o){if(a=e.selection.getRange(),t=a.collapsed,e.fireEvent("delkeydown",i))return;var l,c;if(a.collapsed&&a.inFillChar()&&(l=a.startContainer,d.isFillChar(l)?(a.setStartBefore(l).shrinkBoundary(!0).collapse(!0),d.remove(l)):(l.nodeValue=l.nodeValue.replace(new RegExp("^"+d.fillChar),""),a.startOffset--,a.collapse(!0).select(!0))),l=a.getClosedNode())return e.fireEvent("saveScene"),a.setStartBefore(l),d.remove(l),a.setCursor(),e.fireEvent("saveScene"),void d.preventDefault(i);if(!n.ie&&(l=d.findParentByTagName(a.startContainer,"table",!0),c=d.findParentByTagName(a.endContainer,"table",!0),l&&!c||!l&&c||l!==c))return void i.preventDefault();if(l=a.startContainer,a.collapsed&&1==l.nodeType){var u=l.childNodes[a.startOffset-1];u&&1==u.nodeType&&"BR"==u.tagName&&(e.fireEvent("saveScene"),a.setStartBefore(u).collapse(!0),d.remove(u),a.select(),e.fireEvent("saveScene"))}}if(n.gecko&&46==o){var f=e.selection.getRange();if(f.collapsed&&(l=f.startContainer,d.isEmptyBlock(l))){for(var h=l.parentNode;1==d.getChildCount(h)&&!d.isBody(h);)l=h,h=h.parentNode;return void(l===h.lastChild&&i.preventDefault())}}}),e.addListener("keyup",function(e,r){var i,o=r.keyCode||r.which,a=this;if(8==o){if(a.fireEvent("delkeyup"))return;if(i=a.selection.getRange(),i.collapsed){var s,l=["h1","h2","h3","h4","h5","h6"];if((s=d.findParentByTagName(i.startContainer,l,!0))&&d.isEmptyBlock(s)){var c=s.previousSibling;if(c&&"TABLE"!=c.nodeName)return d.remove(s),void i.setStartAtLast(c).setCursor(!1,!0);var u=s.nextSibling;if(u&&"TABLE"!=u.nodeName)return d.remove(s),void i.setStartAtFirst(u).setCursor(!1,!0)}if(d.isBody(i.startContainer)){var s=d.createElement(a.document,"p",{innerHTML:n.ie?d.fillChar:"<br/>"});i.insertNode(s).setStart(s,0).setCursor(!1,!0)}}if(!t&&(3==i.startContainer.nodeType||1==i.startContainer.nodeType&&d.isEmptyBlock(i.startContainer)))if(n.ie){var f=i.document.createElement("span");i.insertNode(f).setStartBefore(f).collapse(!0),i.select(),d.remove(f)}else i.select()}})},UE.plugins.fiximgclick=function(){var e=this;n.webkit&&e.addListener("click",function(n,r){if("IMG"==r.target.tagName){var i=new t.Range(e.document);i.selectNode(r.target).select()}})},function(e){function t(t,n,r){if(t.prototype=e.extend2(e.extend({},n),(UE.ui[r]||i).prototype,!0),t.prototype.supper=(UE.ui[r]||i).prototype,UE.ui[r]&&UE.ui[r].prototype.defaultOpt){var o=UE.ui[r].prototype.defaultOpt,a=t.prototype.defaultOpt;t.prototype.defaultOpt=e.extend({},o,a||{})}return t}function n(t,n){e[o+n]=t,e.fn[o+n]=function(n){var r,i=Array.prototype.slice.call(arguments,1);return this.each(function(o,a){var s=e(a),l=s.edui();if(l||(t(n&&e.isPlainObject(n)?n:{},s),s.edui(l)),"string"==e.type(n))if("this"==n)r=l;else{if(r=l[n].apply(l,i),r!==l&&void 0!==r)return!1;r=null}}),null!==r?r:this}}e.parseTmpl=function(e,t){var n="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+e.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(/<%=([\s\S]+?)%>/g,function(e,t){return"',"+t.replace(/\\'/g,"'")+",'"}).replace(/<%([\s\S]+?)%>/g,function(e,t){return"');"+t.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+"__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');",r=new Function("obj",n);return t?r(t):r},e.extend2=function(t){for(var n=arguments,r="boolean"==e.type(n[n.length-1])?n[n.length-1]:!1,i="boolean"==e.type(n[n.length-1])?n.length-1:n.length,o=1;i>o;o++){var a=n[o];for(var s in a)r&&t.hasOwnProperty(s)||(t[s]=a[s])}return t},e.IE6=!!window.ActiveXObject&&6==parseFloat(navigator.userAgent.match(/msie (\d+)/i)[1]);var r=[],i=function(){},o="edui";i.prototype={on:function(t,n){return this.root().on(t,e.proxy(n,this)),this},off:function(t,n){return this.root().off(t,e.proxy(n,this)),this},trigger:function(e,t){return this.root().trigger(e,t)===!1?!1:this},root:function(e){return this._$el||(this._$el=e)},destroy:function(){},data:function(e,t){return void 0!==t?(this.root().data(o+e,t),this):this.root().data(o+e)},register:function(t,n,i){r.push({evtname:t,$els:e.isArray(n)?n:[n],handler:e.proxy(i,n)})}},e.fn.edui=function(e){return e?this.data("eduiwidget",e):this.data("eduiwidget")};var a=1;UE.ui={define:function(r,i,s){var l=UE.ui[r]=t(function(t,n){var i=function(){};e.extend(i.prototype,l.prototype,{guid:r+a++,widgetName:r});var s=new i;if("string"==e.type(t))return s.init&&s.init({}),s.root().edui(s),s.root().find("a").click(function(e){e.preventDefault()}),s.root()[o+r].apply(s.root(),arguments);n&&s.root(n),s.init&&s.init(!t||e.isPlainObject(t)?e.extend2(t||{},s.defaultOpt||{},!0):t);try{s.root().find("a").click(function(e){e.preventDefault()})}catch(d){}return s.root().edui(s)},i,s);n(l,r)}},e(function(){e(document).on("click mouseup mousedown dblclickc mouseover",function(t){e.each(r,function(n,r){r.evtname==t.type&&e.each(r.$els,function(n,i){i[0]===t.target||e.contains(i[0],t.target)||r.handler(t)})})})})}(jQuery),UE.ui.define("button",{tpl:'<<%if(!texttype){%>div class="edui-btn edui-btn-<%=icon%> <%if(name){%>edui-btn-name-<%=name%><%}%>" unselectable="on" onmousedown="return false" <%}else{%>a class="edui-text-btn"<%}%><% if(title) {%> data-original-title="<%=title%>" <%};%>> <% if(icon) {%><div unselectable="on" class="edui-icon-<%=icon%> edui-icon"></div><% }; %><%if(text) {%><span unselectable="on" onmousedown="return false" class="edui-button-label"><%=text%></span><%}%><%if(caret && text){%><span class="edui-button-spacing"></span><%}%><% if(caret) {%><span unselectable="on" onmousedown="return false" class="edui-caret"></span><% };%></<%if(!texttype){%>div<%}else{%>a<%}%>>',defaultOpt:{text:"",title:"",icon:"",width:"",caret:!1,texttype:!1,click:function(){}},init:function(e){var t=this;return t.root($($.parseTmpl(t.tpl,e))).click(function(n){t.wrapclick(e.click,n)}),t.root().hover(function(){t.root().hasClass("disabled")||t.root().toggleClass("hover")}),t},wrapclick:function(e,t){return this.disabled()||(this.root().trigger("wrapclick"),$.proxy(e,this,t)()),this},label:function(e){return void 0===e?this.root().find(".edui-button-label").text():(this.root().find(".edui-button-label").text(e),this)},disabled:function(e){return void 0===e?this.root().hasClass("disabled"):(this.root().toggleClass("disabled",e),this)},active:function(e){return void 0===e?this.root().hasClass("active"):(this.root().toggleClass("active",e),this)},mergeWith:function(e){var t=this;t.data("$mergeObj",e),e.edui().data("$mergeObj",t.root()),$.contains(document.body,e[0])||e.appendTo(t.root()),t.on("click",function(){t.wrapclick(function(){e.edui().show()})}).register("click",t.root(),function(){e.hide()})}}),function(){UE.ui.define("toolbar",{tpl:'<div class="edui-toolbar"  ><div class="edui-btn-toolbar" unselectable="on" onmousedown="return false"  ></div></div>',init:function(){var e=this.root($(this.tpl));this.data("$btnToolbar",e.find(".edui-btn-toolbar"))},appendToBtnmenu:function(e){var t=this.data("$btnToolbar");e=$.isArray(e)?e:[e],$.each(e,function(e,n){t.append(n)})}})}(),UE.ui.define("popup",{tpl:'<div class="edui-dropdown-menu edui-popup"<%if(!<%=stopprop%>){%>onmousedown="return false"<%}%>><div class="edui-popup-body"><%=subtpl%></div><div class="edui-popup-caret"></div></div>',defaultOpt:{stopprop:!1,subtpl:"",width:"",height:""},init:function(e){return this.root($($.parseTmpl(this.tpl,e))),this},mergeTpl:function(e){return $.parseTmpl(this.tpl,{subtpl:e})},show:function(e,t){t||(t={});var n=t.fnname||"position";this.trigger("beforeshow")!==!1&&(this.root().css($.extend({display:"block"},e?{top:e[n]().top+("right"==t.dir?0:e.outerHeight())-(t.offsetTop||0),left:e[n]().left+("right"==t.dir?e.outerWidth():0)-(t.offsetLeft||0),position:"absolute"}:{})),this.root().find(".edui-popup-caret").css({top:t.caretTop||0,left:t.caretLeft||0,position:"absolute"}).addClass(t.caretDir||"up"),this.trigger("aftershow"))},hide:function(){this.root().css("display","none"),this.trigger("afterhide")},attachTo:function(e,t){var n=this;e.data("$mergeObj")||(e.data("$mergeObj",n.root()),e.on("wrapclick",function(){n.show(e,t)}),n.register("click",e,function(){n.hide()}),n.data("$mergeObj",e))},getBodyContainer:function(){return this.root().find(".edui-popup-body")}}),function(){var e={},t={},r=[],o=null,a=null,s={},l={};i.extend(UE,{registerUI:function(t,n){i.each(t.split(/\s+/),function(t){e[t]=n})},getWidgetCallback:function(e){return l[e]},registerWidget:function(e,t,n){s[e]=$.extend2(t,{$root:null,_preventDefault:!1,root:function(e){return this.$root||(this.$root=e)},preventDefault:function(){this._preventDefault=!0},clear:!1}),n&&(l[e]=n)},getWidgetData:function(e){return s[e]},setWidgetBody:function(e,t,n){var r=s[e];if(!r)return null;r.root(t.edui().getBodyContainer()),r.initContent(n,t),r._preventDefault||r.initEvent(n,t),r.width&&t.width(r.width);var i=l[e];i&&!i.init&&(l[e]=function(){var e=Array.prototype.slice.call(arguments,0);i.apply(n,[n,t].concat(e))},l[e].init=!0)},getUI:function(t,n,r){return e[n]?$.proxy(e[n],t,n,r)():null},setActiveEditor:function(e){o=e},getActiveEditor:function(e){var n;if(i.each(UE.instants,function(e){return e.selection.isFocus()?(n=e,!1):void 0}),n)return n;var r=e.parents(".edui-container");return o&&r[0]===o.container?o:($.each(t,function(e,t){return t.container===r[0]?(n=t,!1):void 0}),n)},setActiveWidget:function(e){a=e},getActiveWidget:function(){return a},getEditor:function(e,n){return t[e]||(t[e]=this.createEditor(e,n))},clearCache:function(e){t[e]&&delete t[e]},delEditor:function(e){var n;(n=t[e])&&n.key&&n.destroy()},ready:function(e){r.push(e)},createEditor:function(e,t){function n(){var t=this.createUI("#"+e,i);i.key=e,i.ready(function(){$.each(r,function(e,t){$.proxy(t,i)()})});var n=i.options;n.minFrameWidth=n.initialFrameWidth?n.initialFrameWidth:n.initialFrameWidth=i.$body.width(),t.css({width:n.initialFrameWidth,zIndex:i.getOpt("zIndex")}),UE.browser.ie&&6===UE.browser.version&&t[0].ownerDocument.execCommand("BackgroundImageCache",!1,!0),i.render(e),$.eduitooltip&&$.eduitooltip("attachTo").css("z-index",i.getOpt("zIndex")+1),t.find("a").click(function(e){e.preventDefault()}),i.fireEvent("afteruiready")}var i=new UE.Editor(t),o=this;return i.langIsReady?$.proxy(n,o)():i.addListener("langReady",$.proxy(n,o)),i},createUI:function(e,t){var r='<div class="edui-editor-top"   ></div><div class="edui-editor-middle"></div><div class="edui-editor-bottom"></div><div class="edui-editor-msg"   ></div>',i=$(e),o=$('<div class="edui-container"><div class="edui-editor-body">'+r+"</div></div>").insertBefore(i);if(t.$container=o,t.container=o[0],t.$body=i,t.$bodywrap=o.find(".edui-editor-body"),n.ie&&n.ie9above){var a=$('<span style="padding:0;margin:0;height:0;width:0"></span>');a.insertAfter(o)}return o.find(".edui-editor-middle").append(i),o.find(".edui-editor-body").before(this.createToolbar(t.options,t)),o.find(".edui-toolbar").append($('<div class="edui-dialog-container"></div>')),o},createToolbar:function(e,t){var n=this,r=$.eduitoolbar(),i=r.edui();if(e.toolbar&&e.toolbar.length){var o=[];$.each(e.toolbar,function(e,r){$.each(r.split(/\s+/),function(e,r){if("|"==r)$.eduiseparator&&o.push($.eduiseparator());else{var i=n.getUI(t,r);"fullscreen"==r?i&&o.unshift(i):i&&o.push(i)}}),o.length&&i.appendToBtnmenu(o)})}else if(r.find(".edui-btn-toolbar").remove(),e.noToolbar)return r.remove(),"";return r}})}(),UE.ready(function(){function e(){return UE.ui?1:(alert(l.autofloatMsg),0)}function t(){var e=document.body.style;e.backgroundImage='url("about:blank")',e.backgroundAttachment="fixed"}function r(){if(!b){var e=d.getXY(h),t=d.getComputedStyle(h,"position"),r=d.getComputedStyle(h,"left");h.style.width=h.offsetWidth+"px",h.style.zIndex=1*s.options.zIndex+1,$(h).addClass("edui-toolbar-floating"),h.parentNode.insertBefore(v,h),m||g&&n.ie?("absolute"!=h.style.position&&(h.style.position="absolute"),h.style.top=(document.body.scrollTop||document.documentElement.scrollTop)-p+u+"px"):"fixed"!=h.style.position&&(h.style.position="fixed",h.style.top=u+"px",("absolute"==t||"relative"==t)&&parseFloat(r)&&(h.style.left=e.x+"px"))}}function o(){v.parentNode&&v.parentNode.removeChild(v),h.style.cssText=f,$(h).removeClass("edui-toolbar-floating")}function a(){var e=y(s.container),t=s.options.topOffset||0,n=s.options.toolbarTopOffset||0;e.top-t<0&&e.bottom-h.offsetHeight>n?r():o()}var s=this,l=s.getLang();s.setOpt({topOffset:0});var c=s.options.autoFloatEnabled!==!1,u=s.options.topOffset;if(c){var f,h,p,m=n.ie&&n.version<=6,g=n.quirks,v=document.createElement("div"),y=function(e){var t;try{t=e.getBoundingClientRect()}catch(n){t={left:0,top:0,height:0,width:0}}for(var r,i={left:Math.round(t.left),top:Math.round(t.top),height:Math.round(t.bottom-t.top),width:Math.round(t.right-t.left)};(r=e.ownerDocument)!==document&&(e=d.getWindow(r).frameElement);)t=e.getBoundingClientRect(),i.left+=t.left,i.top+=t.top;return i.bottom=i.top+i.height,i.right=i.left+i.width,i},b=!1,C=i.defer(function(){a()},n.ie?200:100,!0);s.addListener("destroy",function(){d.un(window,["scroll","resize"],a),s.removeListener("keydown",C)}),e(s)&&(h=$(".edui-toolbar",s.container)[0],s.addListener("afteruiready",function(){setTimeout(function(){p=$(h).offset().top},100)}),f=h.style.cssText,v.style.height=h.offsetHeight+"px",m&&t(),d.on(window,["scroll","resize"],a),s.addListener("keydown",C),s.addListener("beforefullscreenchange",function(e,t){t&&(o(),b=t)}),s.addListener("fullscreenchanged",function(e,t){t||a(),b=t}),s.addListener("sourcemodechanged",function(){setTimeout(function(){a()},0)}),s.addListener("clearDoc",function(){setTimeout(function(){a()},0)}))}})}()},initUEditorConfig:function(){!function(){var e=window.UEDITOR_HOME_URL||function(){function e(){this.documentURL=self.document.URL||self.location.href,this.separator="/",this.separatorPattern=/\\|\//g,this.currentDir="./",this.currentDirPattern=/^[.]\/]/,this.path=this.documentURL,this.stack=[],this.push(this.documentURL)}function t(){var t=e.getProtocol(this.path||"");t?(this.protocol=t,this.localSeparator=/\\|\//.exec(this.path.replace(t,""))[0],this.stack=[]):(t=/\\|\//.exec(this.path),t&&(this.localSeparator=t[0]))}function n(){var t=this.path.replace(this.currentDirPattern,"");e.hasProtocol(this.path)&&(t=t.replace(this.protocol,"")),t=t.split(this.localSeparator),t.length=t.length-1;for(var n,r=0,i=t.length,o=this.stack;i>r;r++)n=t[r],n&&(e.isParentPath(n)?o.pop():o.push(n))}e.isParentPath=function(e){return".."===e},e.hasProtocol=function(t){return!!e.getProtocol(t)},e.getProtocol=function(e){var t=/^[^:]*:\/*/.exec(e);return t?t[0]:null},e.prototype={push:function(e){return this.path=e,t.call(this),n.call(this),this},getPath:function(){return this+""},toString:function(){return this.protocol+this.stack.concat([""]).join(this.separator)}};var r=document.getElementsByTagName("script");return r=r[r.length-1].src,(new e).push(r)+""}();window.UEDITOR_CONFIG={UEDITOR_HOME_URL:e,imageUrl:e+"php/imageUp.php",imagePath:e+"php/",toolbar:["bold","red","paypost","medal","image","video","music","formula","emotion","scrawl","attachment","topic","quick_reply","fullscreen"],maxHeight:0,focusChangeColor:!0,noToolbar:0,zIndex:0,initialStyle:".edui-editor-body .edui-body-container p{margin:5px 0;} .edui-editor-body{border:1px solid #ccc; border-left-color: #9a9a9a; border-top-color: #9a9a9a; } .edui-editor-body .edui-body-container{outline:none;padding:0 0 0 10px;word-wrap:break-word;font-size:14px;}.edui-editor-body.focus{border:1px solid #5c9dff}",excludePlugins:"medal",maxUndoCount:21,autoFloatEnabled:!1,filterRules:function(){return{img:function(e){var t=560,n=e.getAttr("class");if("BDE_Music"==n||"BDE_Flash"==n||"BDE_Colorful"==n);else{var r=e.getAttr("src");/^file:\/\//.test(r)||/^data:/.test(r)?e.parentNode.removeChild(e):(/\.(jpg|jpeg|gif|png|bmp)/.test(r)||(r+=".gif"),e.setAttr(""),e.setAttr("pic_type",1),e.setAttr("src",r),e.setAttr("class","BDE_Smiley"==n?n:"BDE_Image"),e.setAttr("onload","EditorUI.resizeImage(this, "+t+")"))}e.setAttr("unselectable","on")},p:{$:{}},br:{$:{}},li:function(e){e.tagName="p",e.setAttr()},tr:function(e){e.tagName="p",e.setAttr()},th:function(e){e.tagName="span",e.setAttr(),e.innerHTML(e.innerText()+"&nbsp;")},td:function(e){e.tagName="span",e.setAttr(),e.innerHTML(e.innerText()+"&nbsp;")},"-":"script style meta iframe object"}}()}}()},initUEditorLang:function(){UE.I18N["zh-cn"]={labelMap:{image:"\u56fe\u7247",video:"\u89c6\u9891",music:"\u97f3\u4e50",emotion:"\u8868\u60c5",scrawl:" \u6d82\u9e26",attachment:"\u9644\u4ef6"}}},initExtendUtils:function(){this.initXssUtils(),this.initUbbUtils()},initXssUtils:function(){UE.utils.postDataXssHandler=function(e){var t=$.extend({},e),n=$.tb.escapeHTML,r=["title","prefix","kw","word"];return $.each(r,function(i){var o=r[i],a=e[o];void 0!==a&&(t[o]=n(a))}),t}},initUbbUtils:function(){UE.utils.html2ubb=function(){function e(e){return e.replace(/(\[)|(\])/g,function(e){return"["==e?"[lbk]":"]"==e?"[rbk]":""})}function t(e){var t="";switch((e.tagName||e.type||"").toLowerCase()){case"a":t=r(e);break;case"img":t=i(e);break;case"embed":t=o(e);break;case"span":t=a(e);break;case"strong":t=s(e);break;case"br":t=l();break;case"text":t=d(e);break;case"comment":t=c();break;default:t=u(e)}return t}function n(e,t){return e.getAttr(t)||""}function r(e){return n(e,"href")?"[url]"+n(e,"href")+"[/url]":""}function i(e){var t="",r="",i=" pic_type="+n(e,"pic_type")+" width="+n(e,"width")+" height="+n(e,"height")+"]"+n(e,"src");switch(n(e,"class")){case"BDE_Smiley":t="[emotion",r="[/emotion]";break;default:t="[img",r="[/img]"}return t+i+r}function o(e){var t="";switch(e.getAttr("class")){case"BDE_Music":t="[music width="+n(e,"width")+" height="+n(e,"height")+"]"+n(e,"src").replace(/&amp;/gi,"&")+"[/music]";break;case"BDE_Flash":t="[video width="+n(e,"width")+" height="+n(e,"height")+" vsrc="+n(e,"vsrc").replace(/&amp;/gi,"&")+" vpic="+n(e,"vpic").replace(/&amp;/gi,"&")+" pkey="+n(e,"pkey")+" vhsrc="+n(e,"vhsrc").replace(/&amp;/gi,"&")+"]"+n(e,"src").replace(/&amp;/gi,"&")+"[/video]"}return t}function a(e){var r="";switch($.each(e.children,function(e,n){r+=t(n)}),n(e,"class")){case"edit_font_color":r=r?"[red]"+r+"[/red]":"";break;case"edit_font_normal":r=r?"[normal]"+r+"[/normal]":""}return r}function s(e){var n="";return $.each(e.children,function(e,r){n+=t(r)}),n?"[bold]"+n+"[/bold]":""}function l(){return"[br]"}function d(e){return e.data||""}function c(){return""}function u(e){var n="";return $.each(e.children,function(e,r){n+=t(r)}),n}return function(n,r){if("string"==typeof n){var i="";if(r)return e(n||"");var o=UE.htmlparser(e(n||""));return $.each(o.children||[],function(e,n){i+=t(n)}),i}}}(),UE.plugins.ubb=function(){var e=this;e.getContentUbb=function(){return UE.utils.html2ubb(e.getContent())}}}}});_.Module.define({path:"ueditor/widget/ueditor_extend_base",sub:{initial:function(){window.EditorUI||(this.initEditorUi(),this.initEditorBasePlugin())},initEditorUi:function(){!function(t){var i={modelFactories:{},layerFactories:{},registerModel:function(t,i){this.modelFactories[t]=i},getModel:function(t){var i=this.modelFactories[t];if(i)return i.call(this,PosterContext.getContext(),PosterContext.getAuthorities());throw"No such model factory: "+t},registerLayer:function(t,i){this.layerFactories[t]=i},bindLayer:function(t,i){var e=this.layerFactories[t];if(e)return e.call(this,i,PosterContext.getContext(),PosterContext.getAuthorities());throw"No such layer factory: "+t}},e=function(){this.data={},this.eventPool=$({})};e.prototype={getButton:function(){return this.$button},setButton:function(t){this.$button=t},getWidget:function(){return this.$widget},setWidget:function(t){this.$widget=t},setValue:function(t,i){this.data[t]=i},getValue:function(t){return this.data[t]},bind:function(){this.eventPool.bind.apply(this.eventPool,arguments)},trigger:function(){this.eventPool.trigger.call(this.eventPool,arguments[0],Array.prototype.slice.call(arguments,1))}},i.EditorModel=e,i.resizeImage=function(t,i){t.initWidth=t.initWidth||t.width,t.initHeight=t.initHeight||t.height,t.initWidth>i?(t.height=t.initHeight/t.initWidth*i,t.width=i):(t.height=t.initHeight,t.width=t.initWidth),t.onload=null},t.EditorUI=i}(window)},initEditorBasePlugin:function(){UE.plugins.extendcontent=function(){var t=this,i=t.getExtendContent&&t.getExtendContent;t.getExtendContent=function(){return i?i():{}};var e=t.getContent;t.getContent=function(){var t=e.call(this);return t.replace(/&#39;/g,"'").replace(/&quot;/g,'"').replace(/\0/g,"").replace(/(^(<br\/>)+)|((<br\/>)+$)/g,"")},t.addListener("focus",function(){var i=t.$bodywrap&&t.$bodywrap.length?t.$bodywrap:t.$body;(t.options.focusChangeColor||void 0==t.options.focusChangeColor)&&i.addClass("body-container-focus")}),t.addListener("blur",function(){var i=t.$bodywrap&&t.$bodywrap.length?t.$bodywrap:t.$body;i.removeClass("body-container-focus")})},UE.plugins.basicrules=function(){var t=this;t.addOutputRule(function(t){$.each(t.getNodesByTagName("p"),function(t,i){i.tagName="br"})},!0)},UE.plugins.eduilastbtn=function(){var t=this;t.ready(function(){$("#tb_rich_poster_container").find(".edui-btn").filter(function(){return"none"!=$(this).css("display")}).last().addClass("edui-last-btn")})}}}});_.Module.define({path:"ueditor/widget/background",sub:{initial:function(t,i){t=t||window.UE,i=i||window.EditorUI,this.initPlugin(t,this),this.initLayer(i,this),this.initModel(i,this),this.initAdapter(t,i,this)},initPlugin:function(t){t.plugins.background=function(){var i=this,e=/^#([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$/,n="default",s=0,o=!0,a={id:0,topPic:"transparent",middlePic:"transparent",bottomPic:"transparent",topHeight:"0",bottomHeight:"0"},r=["","edui-editor-bubble-model"],d={"default":{cssClass:r[0],hasBack:0,size:{width:708,height:220},fullscreenSize:{width:968,height:350}},bubble:{cssClass:r[1],hasBack:1,size:{width:500,height:130},fullscreenSize:{width:968,height:130}}},c=function(t){return isNaN(parseInt(t))?0:parseInt(t)},u=function(u,h){h=$.extend({},a,h),s=h.id||0,o=h.isBuy,u=s&&d[u]?u:n;var l=d[u],g=d[n].size.height;t.utils.each(r,function(t){t&&i.$container.removeClass(t)}),i.$container.addClass(l.cssClass),t.utils.each(["top","middle","bottom"],function(t){var n=i.$container.find(".edui-editor-"+t),s=h[t+"Pic"];s=l.hasBack?e.test(s)?s:"url("+s+") repeat-y":"transparent";var o={};if("middle"!==t){var a=l.hasBack?h[t+"Height"]:"0";o.height=a+"px",g-=Number(a),g-=c(n.css("margin-top"))+c(n.css("margin-bottom"))}else g-=c(n.css("margin-top"))+c(n.css("margin-bottom"))+c(n.css("padding-top"))+c(n.css("padding-bottom"))+c(n.css("border-top"))+c(n.css("border-bottom"));o.background=s||"transparent",n.css(o)});var p=l.size.width,b=$("html").hasClass("tb-ueditor-fullscreen")?l.fullscreenSize.height:Math.min(g,l.size.height);i.resize(p,b),i.$container.trigger("setbackground",u)};i.ready(function(){i.$bodywrap&&i.$bodywrap.on("click",".edui-editor-top, .edui-editor-bottom, .edui-editor-msg",function(){i.focus()})}),i.commands.background={execCommand:function(t,i,e){u(i,e)}};var h=i.getExtendContent;i.getExtendContent=function(){var t={ptype:s,ptypePower:o};return $.extend(h?h():{},t)}}},initLayer:function(){},initModel:function(){},initAdapter:function(){}}});_.Module.define({path:"ueditor/widget/auto_link",sub:{initial:function(t,e){t=t||window.UE,e=e||window.EditorUI,this.initPlugin(t,this),this.initLayer(),this.initModel(),this.initAdapter()},initPlugin:function(t){t.plugins.autolink=function(){var e=function(t){var e,n=String.prototype.split,i=/()??/.exec("")[1]===t;return e=function(e,r,a){if("[object RegExp]"!==Object.prototype.toString.call(r))return n.call(e,r,a);var l,o,s,u,g=[],h=(r.ignoreCase?"i":"")+(r.multiline?"m":"")+(r.extended?"x":"")+(r.sticky?"y":""),p=0,r=new RegExp(r.source,h+"g");for(e+="",i||(l=new RegExp("^"+r.source+"$(?!\\s)",h)),a=a===t?-1>>>0:a>>>0;(o=r.exec(e))&&(s=o.index+o[0].length,!(s>p&&(g.push(e.slice(p,o.index)),!i&&o.length>1&&o[0].replace(l,function(){for(var e=1;e<arguments.length-2;e++)arguments[e]===t&&(o[e]=t)}),o.length>1&&o.index<e.length&&Array.prototype.push.apply(g,o.slice(1)),u=o[0].length,p=s,g.length>=a)));)r.lastIndex===o.index&&r.lastIndex++;return p===e.length?(u||!r.test(""))&&g.push(""):g.push(e.slice(p)),g.length>a?g.slice(0,a):g}}();this.addOutputRule(function(n){$.each(n.getNodesByTagName("a"),function(t,e){var n=e.innerText();/^\w+:\/\//.test(n)||(n="http://"+n),e.setAttr("href",n),e.setAttr("target","_blank")});var i=[];n.traversal(function(t){"text"==t.type&&"a"!=t.parentNode.tagName&&i.push(t)});for(var r,a=0;r=i[a];a++){var l=r.getData().replace(/&#39;/g,"'").replace(/&quot;/g,'"'),o=e(l,/((?:www\.|http:\/\/|mms:\/\/|rtsp:\/\/|ftp:\/\/|https:\/\/)[0-9a-zA-Z;\.\!\~\#\?\:\/\&\%\-\+\*\=\@\_\$]+)/gi);if(o.length>1){for(var s=r.parentNode,u=0,g=o.length;g>u;u++){var h=o[u];if(h.length>0){var p;u%2==0?p=t.uNode.createText(h):(p=t.uNode.createElement("a"),/^\w+:\/\//.test(h)?p.setAttr("href",h):p.setAttr("href","http://"+h),p.setAttr("target","_blank"),p.innerText(h)),s.insertBefore(p,r)}}s.removeChild(r)}}$.each(n.getNodesByTagName("a"),function(e,n){n.setAttr("href",t.utils.unhtml(n.getAttr("href")))})},!0)}},initLayer:function(){},initModel:function(){},initAdapter:function(){}}});_.Module.define({path:"ueditor/widget/tb_gram",sub:{initial:function(t){this.cdnCache=!0,this.$container=t.container,this.forumId=t.forumId,this.buildFlash(),this.bindEvents()},bindEvents:function(){},buildFlash:function(){$(".tb_gram_swf_container")&&$(".tb_gram_swf_container").remove();var t=this,i=this.$container,o=i.offset(),s=$('<div class="tb_gram_swf_container"></div>');this.$swfContainer=s,$("body").append(s);new $.swf("//web.archive.org/web/20201117141157/https://tb2.bdstatic.com/tb/img/TbGram_3d2499d.swf",{id:"TbGramSwf",container:s,width:50,height:57,params:{wmode:"transparent"},vars:{filterconfigURL:"/tb/static-common/htmlfilter/filterconf_tbgram.js",sticksConfigURL:"/tb/static-common/sticks/sticks_tabs_conf.js",uploadUrl:"https://web.archive.org/web/20201117141157/https://uploadphotos.baidu.com/upload/pic?tbs=4f165305af36ccdc013751701760125500_1&fid="+this.forumId,iconPath:"//web.archive.org/web/20201117141157/https://tb1.bdstatic.com/tb/static-common/images/"},callBacks:{onResize:function(){t.setScroll(!1),this.width=$(window).width(),this.height=$(window).height(),s.css({position:"absolute",left:0,top:$(document).scrollTop(),"z-index":99999})},onUploaded:function(i){var o=[];for(var s in i){var n=i[s];n&&0==n.err_no&&n.info&&o.push({picType:0,width:n.info.fullpic_width,height:n.info.fullpic_height,url:n.info.pic_water?n.info.pic_water.replace(/https:\/\/web.archive.org\/web\/20201117141157\/http:\/\/imgsrc/,"https://web.archive.org/web/20201117141157/https://imgsa"):n.info.pic_water})}t.trigger("ok",o),t.setScroll(!0),t.trigger("close")},onClose:function(){t.setScroll(!0),t.trigger("close")},onMouseOver:function(){t.$container.addClass("hover")},onMouseOut:function(){t.$container.removeClass("hover")}}});s.css({position:"absolute",left:o.left+26,top:o.top,"z-index":300})},setScroll:function(t){var i=$("html"),o=i[0].scrollTop;t?i.css({overflow:this.htmloverflow||"","padding-right":0}):(i[0].style.overFlow&&(this.htmloverflow=i[0].style.overFlow),i.css({overflow:"hidden","padding-right":17})),i[0].scrollTop=o},destorySwf:function(){this.$swfContainer&&this.$swfContainer.remove()}}});_.Module.define({path:"ueditor/widget/slide_select",sub:{defaultOpt:{wrap:$("body"),forumId:0,propsCategory:0,dataArr:[],showNum:5,showSlide:!0,wrapCss:{},navNextCss:{},navPrevCss:{},props:[],limitFreeArr:[]},initial:function(t){this.opt=$.extend(this.defaultOpt,t),this.sortData(),this.buildHtml()},sortData:function(){var t=this,s=[8585575,73443,5338019,1948989,615748].join("|"),e=new RegExp("^("+s+")$");e.test(this.opt.forumId)&&this.opt.dataArr.sort(function(s,e){var i=t.fanAuthority(s.key),r=t.fanAuthority(e.key);return i&&!r?-1:!i&&r?1:0}),this.opt.dataArr.sort(function(s,e){var i=!t.propAuthority(s.key),r=!t.propAuthority(e.key);return i&&!r?-1:!i&&r?1:i&&r?t.getPropUpdateTime(e.key)-t.getPropUpdateTime(s.key):0})},buildHtml:function(){var t=new Array,s="",e=null;t.push('<div class="slide_pager">'),t.push('<div class="slide_nav slide_nav_prev"></div>'),t.push('<div class="slide_nav slide_nav_next"></div>'),t.push("</div>"),t.push('<div class="slide_wrap">'),t.push('<div class="slide_title">\u8bf7\u9009\u62e9\u6c34\u5370</div>'),t.push('<ul class="slide_list clearfix">');for(var i=0;i<this.opt.dataArr.length;i++){if(e=this.opt.dataArr[i],s="/tb/static-common/img/props/"+e.key+".png?t=0115",t.push('<li class="slide_item'+(e.extendClass?" "+e.extendClass:"")+'"'),t.push('data-key="'+e.key+'">'),this.propAuthority(e.key)){var r="";if(101==this.opt.propsCategory||104==this.opt.propsCategory){var a="need_buy_logo";this.fanAuthority(e.key)&&(a="need_buy_fan_logo"),$.inArray(e.key,this.opt.limitFreeArr)>-1&&(a="need_buy_limit_free_logo"),r='<a class="need_buy_link  need_buy_preview_link" onclick="return false;" target="_blank"><span class="'+a+'"></span></a>'}else r='<a class="need_buy_link " href="/tbmall/propslist?category='+this.opt.propsCategory+'" target="_blank"><span class="need_buy_logo"></span></a>';t.push(r)}t.push('<p class="slide_item_img"><img class="slide_item_img_wrap" src="'+s+'"/></p><p class="slide_item_title">'+e.title+"</p>"),t.push("</li>")}t.push("</ul>"),t.push("</div>"),this.opt.wrap.html(t.join(""))},initCarouse:function(){var t=this,s=this.opt.wrap.find(".slide_wrap").css(t.opt.wrapCss);this.opt.showSlide&&($(".slide_nav").show(),s.jCarouselLite({btnNext:$(".slide_nav_next").css(t.opt.navNextCss),btnPrev:$(".slide_nav_prev").css(t.opt.navPrevCss),visible:t.opt.showNum,circular:!0,auto:!1}))},propAuthority:function(t){var s=[1039998,1039999].join("|"),e=0,i=this.opt.props,r=new RegExp("^("+s+")$");return r.test(t)?!1:!i||$.isEmptyObject(i)?!0:(propsCate=i[this.opt.propsCategory],e=Math.floor((new Date).getTime()/1e3),!(propsCate&&propsCate[t]&&e<=propsCate[t].end_time))},getPropUpdateTime:function(t){var s=this.opt.props;if(!s||$.isEmptyObject(s))return!1;var e=s[this.opt.propsCategory];return e&&e[t]&&e[t].update_time},fanAuthority:function(t){var s=[1019001,1019002,1019003,1049001,1049002,1049003].join("|"),e=new RegExp("^("+s+")$");return e.test(t)}}});_.Module.define({path:"tbui/widget/image_flash_editor",sub:{_swfPath:"//web.archive.org/web/20201117141157/https://tb2.bdstatic.com/tb/img/FlashFilterUI_6e543a5.swf",_vars:{configURL:"/tb/static-common/htmlfilter/filterconf.js",reviewURL:"",iconPath:"/tb/static-common/img/image_editor/",uploadURL:"",imageURL:null,maxSize:5,maxWidth:3e3,maxHeight:3e3},_events:["upload_complete","compress_complete","upload_error"],_flashInstance:null,initial:function(t,i){i&&$.extend(this._vars,i),this._buildHTML(t.container,t.width,t.height),this._buildFlash(t)},_buildHTML:function(t,i,s){var e=this,a='<div class="image_flash_editor"><div class="flash_editor_container"></div><div class="button_bar"><a href="#" class="btn_default btn_middle j_ok">\u786e \u5b9a</a><a href="#" class="btn_sub btn_middle j_cancel">\u53d6 \u6d88</a></div></div>';this.$root=$(a),this.$root.css({width:i,height:s}),this.$root.find(".j_ok").click(function(){return e.startUpload(),!1}),this.$root.find(".j_cancel").click(function(){return e.trigger("cancel"),!1}),$(t).append(this.$root)},_buildFlash:function(t){this._swfOptions=t,this._swfOptions.height=t.height-45,this._swfOptions.container=this.$root.find(".flash_editor_container"),this._swfOptions.vars=this._vars,this._swfOptions.callBacks={},this._generateCallBack(),this._flashInstance=new $.swf(this._swfPath,this._swfOptions)},_generateCallBack:function(){var t=this;for(var i in this._events){var s=this._events[i];this._swfOptions.callBacks[s]=function(i){return function(){var s=Array.prototype.slice.call(arguments,0);s.unshift(i),t.trigger.apply(t,s)}}(s)}},loadRemoteImage:function(t){this._flashInstance.remote("loadRemoteImage",t)},startUpload:function(){this._flashInstance.remote("startUpload")},setUploaderVariables:function(t){this._flashInstance.remote("setUploaderVariables",t)},clearPreview:function(){this._flashInstance.remote("clearPreview")}}});_.Module.define({path:"tbui/widget/scroll_panel",sub:{dom:null,$content:null,$scrollBar:null,$scrollButton:null,_hasScroll:!1,_scrollStep:50,_scrollTop:0,_maxHeight:0,initial:function(t){this._buildUI(t),this._bindEvents(t),$(t.container).append(this.dom),this.setHeight(t.height||100),t.content&&this.setContent(t.content),t.scrollBarShow&&this.bind("onScrollBarShow",t.scrollBarShow),t.scrollBarHide&&this.bind("onScrollBarHide",t.scrollBarHide)},_buildUI:function(t){this.dom=$('<div class="tbui_scroll_panel"></div>'),this.dom.html(['<div class="tbui_panel_content j_panel_content clearfix"><ul></ul></div>','<div class="tbui_scroll_bar j_scroll_bar">','<div class="tbui_scroll_button j_scroll_button">&nbsp;</div>',"</div>"].join("")),this.$content=this.dom.find(".j_panel_content:first"),this.$scrollBar=this.dom.find(".j_scroll_bar:first"),this.$scrollButton=this.dom.find(".j_scroll_button:first"),t.padding&&this.$content.css("padding",t.padding)},_bindEvents:function(){var t=this,o=t.$content.get(0);this.$scrollButton.on("drag",function(i,l){if(l){var s=l.position;o.scrollTop=s.top/t.$content.height()*o.scrollHeight}}),this.$content.mousewheel(function(o,i){o.preventDefault(),o.stopPropagation(),t._hasScroll&&t.scrollTopTo(t._scrollTop-i*t._scrollStep)})},scrollTopTo:function(t){var o=this,i=o.$content.get(0),t=Math.max(Math.min(t,i.scrollHeight-o.$content.height()),0);t!=o._scrollTop&&(o._scrollTop=t,o.$content.stop(),o.$content.scrollTop(o._scrollTop),o._resizeScroll())},setHeight:function(t){this._maxHeight=t,this._resizeHeight(),this._resizeScroll(),this.$scrollButton.draggable({containment:"parent"})},setContent:function(t){this.$content.html(t),this.$content.get(0).scrollTop=this._scrollTop=0,this._resizeHeight(),this._resizeScroll()},appendContent:function(t){this.$content.append(t),this._resizeHeight(),this.scrollTopTo(2e4)},clearContent:function(){this.setContent("")},_resizeHeight:function(){this.$content.css("height","");var t=this.$content.get(0),o=t.scrollHeight,i=Math.min(o,this._maxHeight);this.$content.css("height",i)},_resizeScroll:function(){var t=this.$content.get(0),o=t.scrollHeight,i=t.scrollTop,l=this.$content.innerHeight();l>=o?(this.$scrollBar.hide(),this.dom.addClass("tbui_no_scroll_bar"),this.trigger("onScrollBarHide"),this._hasScroll=!1):(this.$scrollBar.show(),this.$scrollBar.height(l),this.$scrollButton.height(l/o*l),this.$scrollButton.css("top",i/o*l),this.trigger("onScrollBarShow"),this._hasScroll=!0)}}});_.Module.define({path:"image-lib/widget/image_exif",sub:{initial:function(){},getOrientation:function(t){if(null==t)return 0;for(var e=0,r=0;e+3<t.length&&255==(255&t[e++]);){var i=255&t[e];if(255!=i&&(e++,216!=i&&1!=i)){if(217==i||218==i)break;if(r=this.pack(t,e,2,!1),2>r||e+r>t.length)return 0;if(225==i&&r>=8&&1165519206==this.pack(t,e+2,4,!1)&&0==this.pack(t,e+6,2,!1)){e+=8,r-=8;break}e+=r,r=0}}if(r>8){var a=this.pack(t,e,4,!1);if(1229531648!=a&&1296891946!=a)return 0;var n=1229531648==a,s=this.pack(t,e+4,4,n)+2;if(10>s||s>r)return 0;e+=s,r-=s;for(var h=this.pack(t,e-2,2,n);h-->0&&r>=12;){if(a=this.pack(t,e,2,n),274==a){var c=this.pack(t,e+4,4,n),o=this.pack(t,e+8,c,n);switch(o){case 1:return 0;case 3:return 180;case 6:return 90;case 8:return 270}return 0}e+=12,r-=12}}return 0},pack:function(t,e,r,i){var a=1;i&&(e+=r-1,a=-1);for(var n=0;r-->0;)n=n<<8|255&t[e],e+=a;return n},rotateByorientation:function(t,e){var r=new FileReader,i=this;t.size||this.trigger("success",t),r.onload=function(){var r=this.result,a=new Uint8Array(r),n=i.getOrientation(a);i.trigger("degreeloaded",n),e||i.rotateFile(t,n)},r.readAsArrayBuffer(t)},rotateFile:function(t,e){if(90!=e&&180!=e&&270!=e)return this.trigger("success",t),void 0;var r=new FileReader,i=this;r.onload=function(){var t=this.result,r=new Image;r.onload=function(){i.rotateImage(r,e)},r.src=t},r.readAsDataURL(t)},rotateImage:function(t,e){var r=document.createElement("canvas"),i=r.getContext("2d"),a=t.width,n=t.height;i.save(),90==e||270==e?(r.width=n,r.height=a,90==e?i.translate(r.width,0):i.translate(0,r.height)):(r.width=a,r.height=n,i.translate(r.width,r.height)),i.rotate(e*Math.PI/180),i.drawImage(t,0,0,a,n),i.restore(),this.trigger("success",r)}}});_.Module.define({path:"tbui/widget/image_uploader",requires:["image-lib/widget/image_exif"],sub:{_url:"",_xhr:null,_active:!1,_successFilter:null,_variable:null,_MAX_SIZE:3145728,initial:function(t,e,i){this._url=t,this._successFilter=e||null,i=i||{},this._compressWidth=i.maxWidth||3e3,this._compressHeight=i.maxHeight||3e3},_createHXR:function(){var t=this,e=this._successFilter;this._xhr=new XMLHttpRequest,this._xhr.onload=function(){var i;try{i=$.parseJSON(t._xhr.responseText)}catch(r){i=t._xhr.responseText}e?e(i)?t.trigger("success",t._xhr,i):t.trigger("error",t._xhr,i):t.trigger("success",t._xhr,i)},this._xhr.onerror=function(){t.trigger("error",t._xhr)},this._xhr.onabort=function(){t.trigger("abort",t._xhr)},this._xhr.upload.onprogress=function(e){t.trigger("progress",e.loaded,e.total)}},_dataURLtoBlob:function(t){for(var e=atob(t.split(",")[1]),i=t.split(",")[0].split(":")[1].split(";")[0],r=new ArrayBuffer(e.length),s=new Uint8Array(r),o=0;o<e.length;o++)s[o]=e.charCodeAt(o);var a=window.MozBlobBuilder||window.WebKitBlobBuilder||window.BlobBuilder;if(a){var n=new a;return n.append(r),n.getBlob(i)}return Blob?new Blob([r],{type:i}):null},_compressFormDataURI:function(t,e){var i=this._dataURLtoBlob(t),r=i.size,s=this;if(e>=r)s._uploadBlob(i);else{var o=new Image,a=document.createElement("canvas");o.onload=function(){var t=s._getCompressSize(o.width,o.height);a.width=t.width,a.height=t.height,a.getContext("2d").drawImage(o,0,0,o.width,o.height,0,0,t.width,t.height),o.onload=null,o.src="about:blank",o=null;var n=a.toDataURL("image/jpeg",(e/r).toFixed(1));a.getContext("2d").clearRect(0,0,t.width,t.height),a.width=a.height=0,a=null,i=s._dataURLtoBlob(n),i.size>e?s.trigger("error"):s._uploadBlob(i)},o.src=t}},_uploadBlob:function(t){var e=new FormData,i=this._variables;if(i&&"object"==typeof i)for(var r in i)e.append(r,i[r]);e.append("file",t),this._active=!0,this._xhr||this._createHXR(),this._xhr.open("POST",this._url,!0),this._xhr.withCredentials=!0,this._xhr.send(e),i&&i.html5stat&&$.stats.sendRequest("fr=tb0&st_type=html5upload&st_value=send")},_getCompressSize:function(t,e){var i=this._compressWidth,r=this._compressHeight,s=t/e,o={};return t>i||e>r?s>i/r?(o.width=i,o.height=i/s):(o.height=r,o.width=r*s):o={width:t,height:e},o},setVariable:function(t){this._variables=t},upload:function(t,e,i){if(t){e="undefined"==typeof e?this._MAX_SIZE:e;var r,s=this;if(t.getContext)r=i?t.toDataURL(i):t.toDataURL("image/jpeg",.8),t.getContext("2d").clearRect(0,0,t.width,t.height),t.width=t.height=0,t=null,s._compressFormDataURI(r,e);else if(t.size){var o=this.requireInstance("image-lib/widget/image_exif");o.bind("success",function(o,a){if(a.getContext)s.upload(a,e,i);else if(t.size>e){var n=new FileReader;n.onload=function(t){n.onload=null,r=t.target.result,s._compressFormDataURI(r,e)},n.readAsDataURL(a)}else s._uploadBlob(a)}),o.rotateByorientation(t)}}},abort:function(){this._active&&(this._xhr.abort(),this._active=!1)},distroy:function(){this.abort(),this.unbind("success"),this.unbind("error"),this.unbind("abort"),this.unbind("progress"),this._xhr=null}}});_.Module.define({path:"tbui/widget/image_uploader_manager/uploader_flash",requires:[],sub:{initial:function(e){var t={container:null,width:200,height:50,isAutoUp:!1,queueLen:10,maxParallel:2,maxSize:3145728,maxWidth:1e3,maxHeight:1e3,uploadUrl:"",getUploadParams:null};this._options=$.extend(t,e||{}),this._token=this._makeToken(),this._flashVars="",this._version="1_0_1_3",this._EVENTS=["onFileSelected","onStartUpload","onProgressListen","onComplete","onError"],this._reset()},_reset:function(){this._initFlashvars(),this._generateCallBack(),this._initUI()},_initFlashvars:function(){this._flashVars=["maxSize="+encodeURIComponent(this._options.maxSize),"maxWidth="+encodeURIComponent(this._options.maxWidth),"maxHeight="+encodeURIComponent(this._options.maxHeight),"isAutoUp="+encodeURIComponent(this._options.isAutoUp),"queueLen="+encodeURIComponent(this._options.queueLen),"maxParallel="+encodeURIComponent(this._options.maxParallel),"useWorker=false","uploadURL="+encodeURIComponent(this._options.uploadUrl),"get_upload_params="+(this._options.get_upload_params?encodeURIComponent(this._options.get_upload_params):"")].join("&")},_initUI:function(){var e,t=this._flashChecker(),i=t.version,a="flashUploader"+this._token;t.hasFlash||this._flashError(),e=i[0]<11||i[1]<4?"//web.archive.org/web/20201117141157/https://tb2.bdstatic.com/tb/img/uploaderwithoutworker_ade2e66.swf":"//web.archive.org/web/20201117141157/https://tb2.bdstatic.com/tb/img/uploader_66720f8.swf";var o='<object id="'+a+'" name="'+a+'" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="https://web.archive.org/web/20201117141157/https://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,0,0" width="'+this._options.width+'" height="'+this._options.height+'"><param name="allowScriptAccess" value="always" /><param value="transparent" name="wmode"><param name="flashvars" value="'+this._flashVars+'" /><param name="allowFullScreen" value="false" /><param name="movie" value="'+e+'" /></object>',s='<object id="'+a+'" type="application/x-shockwave-flash" data="'+e+'" width="'+this._options.width+'" height="'+this._options.height+'"><param name="allowScriptAccess" value="always" /><param value="transparent" name="wmode"><param name="flashvars" value="'+this._flashVars+'" /></object>';this._options.container||(this._options.container=$("<div>").appendTo(document.body).css({position:"absolute",width:"1px",height:"1px",overflow:"hidden",left:1,bottom:1})),this._options.container.html(-1!=navigator.appName.indexOf("Microsoft")?o:s),this.flash=document[a]||window[a]},_generateCallBack:function(){for(var e=this,t=0;t<this._EVENTS.length;t++){var i=this._EVENTS[t],a=i+this._token;window[a]=function(t){return function(){var i=Array.prototype.slice.call(arguments,0);i.unshift(t),e.trigger.apply(e,i)}}(i),this._flashVars+="&"+this._decodeCamel(i)+"="+a}},_decodeCamel:function(e){return e.replace(/([A-Z])/g,function(e,t){return"_"+t.toLowerCase()})},start:function(){this.flash.startUpload()},stop:function(){this.flash.pauseUpload()},deleteFile:function(e){this.flash.deleteFile(e)},clearList:function(){this.flash.clearList()},reUploadError:function(e){this.flash.resetErrorStatus(e)},_flashChecker:function(){var e,t,i=!1,a=$.browser.msie;return a?(t=new ActiveXObject("ShockwaveFlash.ShockwaveFlash"),t&&(i=!0,e=t.GetVariable("$version"))):navigator.plugins&&navigator.plugins.length>0&&(t=navigator.plugins["Shockwave Flash"],t&&(i=!0,e=t.description)),{hasFlash:i,version:e.match(/\d+/g)}},_flashError:function(){$.dialog.alert('\u68c0\u6d4b\u5230\u60a8\u7684\u6d4f\u89c8\u5668\u6ca1\u6709\u5b89\u88c5\u6700\u65b0Adobe Flash Player\u63d2\u4ef6\uff0c\u8fd9\u4f1a\u5f71\u54cd\u60a8\u8bbf\u95ee\u672c\u9875\u9762\u7684\u90e8\u5206\u529f\u80fd\u3002<br /><center>\u8bf7<a href="https://web.archive.org/web/20201117141157/http://get.adobe.com/cn/flashplayer/" target="_blank">\u70b9\u6b64</a>\u5b89\u88c5</center>')},_makeToken:function(){var e=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};return e()+e()+"_"+e()+e()+e()},uploadBase64:function(e,t){var i="flashUploadBase64_"+this._makeToken();window[i]=function(e){return function(t){e(t)}}(t),this.flash.uploadBase64(e,i)}}}),_.Module.define({path:"tbui/widget/image_uploader_manager/uploader_html5",requires:["tbui/widget/image_uploader"],sub:{initial:function(e){var t={container:null,width:200,height:50,isAutoUp:!1,queueLen:10,maxParallel:16,maxSize:3145728,limitSize:10485760,maxWidth:1e3,maxHeight:1e3,uploadUrl:"",getUploadParams:null};this._options=$.extend(t,e||{}),this._uploadQueue=[],this._fileStatusArr=[],this._currentUploadNum=0,this._uploadTimer=null,this._activeTotal=0,this._typeFilter="image/jpeg, image/jpg, image/png, image/gif, image/bmp",this._reset()},start:function(){this._trigger("onStartUpload"),this._startProgress()},stop:function(){this._stopProgress()},deleteFile:function(e){for(var t=0;t<this._uploadQueue.length;t++){var i=this._uploadQueue[t];if(i&&i.id==e){i.uploader.distroy(),i.isStarted&&i.percent<100&&this._activeTotal--,this._uploadQueue.splice(t,1);break}}},clearList:function(){this._uploadQueue.length=0},reUploadError:function(e){this._resetErrorStatus(e),this.start()},_reset:function(){this._initUI(),this._bindEvents()},_initUI:function(){this._fileInput=$('<input type="file" id="multi_file" style="display:none" multiple accept="'+this._typeFilter+'" />').get(0)},_bindEvents:function(){var e=this;this._fileInput.onclick=function(){e._fileInput.value=""},this._fileInput.onchange=function(){e._selectFile(e._fileInput.files)},this._options.container&&this._options.container.bind("click",function(){e._fileInput.value="",e._fileInput.click()})},_selectFile:function(e){if("local_upload"===this._options.locate){var t=$(".slide_item_active").data("key");t&&(this._options.uploadUrl+="&picWaterType="+t)}for(var i=[],a=0,o=e.length;o>a&&a<this._options.queueLen;a++){var s=e[a];""!=s.type&&this._typeFilter.indexOf(s.type)>=0&&i.push(this._add(s))}this._trigger("onFileSelected",{imageList:i,percent:0}),this._options.isAutoUp&&this.start()},_add:function(e){var t,i=this,a=i._uploadQueue,o={name:e.name,size:e.size,id:"img_"+this._makeToken()+"_"+a.length+"_"+e.type,percent:0,status:"",errorCode:0,errorMessage:null,source:e,isStarted:!1};return a.push(o),e.size>this._options.limitSize?(o.errorCode=1,o.errorMessage="\u6587\u4ef6\u5927\u5c0f\u8d85\u51fa\u9650\u5236",this._trigger("error",o),o.percent=100,o.isStarted=!0,o):(t=i.requireInstance("tbui/widget/image_uploader",[this._options.uploadUrl,null,{maxWidth:this._options.maxWidth,maxHeight:this._options.maxHeight}]),o.uploader=t,t.id=o.id,t.bind("success",this._uploadedHandler,this),t.bind("error",this._uploadedHandler,this),t.bind("progress",function(e){return function(t,i,a){e.percent=Math.min(e.percent+parseInt(20*i/a,10),99)}}(o)),o)},_upload:function(){for(var e=0,t=!0,i=0;i<this._uploadQueue.length;i++){var a=this._uploadQueue[i];a&&(a.percent<100&&(t=!1),this._activeTotal<this._options.maxParallel&&!a.isStarted&&(a.isStarted=!0,a.percent=5,this.getUploadParams&&a.uploader.setVariable(this.getUploadParams(a.id)),a.uploader.upload(a.source,this._options.maxSize),this._activeTotal++),a.percent<50&&(a.percent+=5),e+=a.percent/this._uploadQueue.length)}t?(this._percent=100,this.stop(),this._trigger("onComplete")):(this._percent=parseInt(e,10),this._trigger("onProgressListen"))},_uploadedHandler:function(e,t,i){var a=e.target.id;this._activeTotal--;var o=this._getFileById(a);return o?("error"==e.type&&(o.errorCode=2,o.errorMessage="\u7f51\u7edc\u9519\u8bef",this._trigger("error",o),o.percent=100),"success"==e.type&&(o.response=i.data||i||null,o.response.data||(o.response.data=$.extend({},o.response)),o.response.info||(o.response.info=$.extend({},o.response)),o.response.err_no=0,o.response.error_code=0,o.percent=100),e.target.unbind("success",this._uploadedHandler),void e.target.unbind("error",this._uploadedHandler)):!1},_trigger:function(e,t){this.trigger(e,t||{imageList:this._uploadQueue,percent:this._percent})},_getFileById:function(e){for(var t=0;t<this._uploadQueue.length;t++){var i=this._uploadQueue[t];if(i&&i.id==e)return i}return null},_resetErrorStatus:function(e){for(var t=0;t<this._uploadQueue.length;t++){var i=this._uploadQueue[t];if(i&&0!==i.errorCode&&(!e||e&&i.id==e)&&(i.percent=0,i.errorCode=0,i.errorMessage=null,i.isStarted=!1,i.response=null,e))break}},_startProgress:function(){if(!this._uploadTimer){var e=this;this._uploadTimer=setInterval(function(){e._upload()},1e3)}},_stopProgress:function(){clearInterval(this._uploadTimer),this._uploadTimer=null},_makeToken:function(){var e=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};return e()+e()+"_"+e()+e()+e()}}}),_.Module.define({path:"tbui/widget/image_uploader_manager",requires:["tbui/widget/image_uploader_manager/uploader_html5","tbui/widget/image_uploader"],sub:{initial:function(e){var t={container:null,width:200,height:50,isAutoUp:!1,queueLen:10,needWatermark:!1,fid:"",maxSize:3145728,maxWidth:3e3,maxHeight:3e3,uploadUrl:"https:"===$.tb.location.getProtocol()?"https://web.archive.org/web/20201117141157/https://uploadphotos.baidu.com/upload/pic":"https://web.archive.org/web/20201117141157/http://upload.tieba.baidu.com/upload/pic",getUploadParams:null,tbsUrl:"//web.archive.org/web/20201117141157/https://tieba.baidu.com/dc/common/imgtbs",isFlash:!1,save_yun_album:0,pid:"",local_upload:"",isNewImgsys:0};this._options=$.extend(t,e||{}),this.uploader=null,this.EVENTS=["onFileSelected","onStartUpload","onProgressListen","onComplete","onError"],this._reset();try{$.stats.track("tbui/widget/image_uploader_manager","component_track","frs","view",{isNewImgsys:this._options.isNewImgsys})}catch(i){}},_initUploadUrl:function(e){var t=this;if(this._options.uploadUrl.indexOf("tbs")>0)return void(e&&e.apply(t));var i=$.ajax({url:this._options.tbsUrl,dataType:"json"});i.done(function(i){0===Number(i.no)?(t._options.uploadUrl+="?tbs="+i.data.tbs+(t._options.isWater?"&is_wm=1":"")+"&fid="+(t._options.fid||"")+"&save_yun_album="+t._options.save_yun_album,t._options.uploadUrl+=t._options.pid?"&pid="+t._options.pid:"",t._options.isNewImgsys+""=="1"&&(t._options.uploadUrl+="&is_new_imgsys=1"),e&&e.apply(t)):e&&t._error()}).fail(function(){e&&t._error()})},_reset:function(){navigator.userAgent.toLowerCase().match(/chrome\/([\d]+)/);window.FormData||(this._options.isFlash=!0),this._initUploadUrl(this._startImageUploader)},_startImageUploader:function(){this._options.isFlash?this._options.container.click(function(){new $.dialog({width:500,html:'<p style="text-align: center; padding: 18px 0;">\u60a8\u5f53\u524d\u7684\u6d4f\u89c8\u5668\u7248\u672c\u8fc7\u4f4e\uff0c\u65e0\u6cd5\u4e0a\u4f20\u56fe\u7247\uff0c<a href="https://web.archive.org/web/20201117141157/https://liulanqi.baidu.com/" target="_blank">\u5efa\u8bae\u5347\u7ea7\u6d4f\u89c8\u5668</a></p>',title:"\u6e29\u99a8\u63d0\u793a",draggable:!1})}):this._options.container&&(this.uploader=this.requireInstance("tbui/widget/image_uploader_manager/uploader_html5",this._options)),this._options.container&&this._generateCallBack()},_generateCallBack:function(){for(var e=this,t=0;t<this.EVENTS.length;t++){var i=this.EVENTS[t];this.uploader.bind(i,function(t){return function(i,a){e.trigger(t,a||i)}}(i))}},start:function(){this.uploader.start()},startUpload:function(){this.uploader.start()},stop:function(){this.uploader.stop()},stopUpload:function(){this.uploader.stop()},deleteFile:function(e){this.uploader.deleteFile(e)},clearList:function(){this.uploader.clearList()},reUploadError:function(e){this.uploader.resetErrorStatus(e)},uploadBase64:function(e,t){var i=this;this._options.isFlash?this._flashUploadBase64(e,t):this._initUploadUrl(function(){i._ajaxUploadBase64(e,t)})},_ajaxUploadBase64:function(e,t){var i=this;$.ajax({url:i._options.uploadUrl+"&_token="+(new Date).getTime(),data:{filetype:"base64",file:e},type:"POST",success:function(e){t.call(i,{errorCode:0,errorMessage:"",response:e})},error:function(e){t.call(i,{errorCode:1,errorMessage:"\u4e0a\u4f20\u5931\u8d25",response:e})},dataType:"json"})},_flashUploadBase64:function(e,t){var i=this;this.uploader&&this.uploader.uploadBase64?this.uploader.uploadBase64(e,t):setTimeout(function(){i._flashUploadBase64(e,t)},100)},_error:function(e){e=$.extend({percent:0,errorCode:400,errorMessage:"\u521d\u59cb\u5316\u51fa\u9519",imageList:{}},e||{}),this.trigger("onError",e)}}});_.Module.define({path:"ueditor/widget/picture_uploader",requires:["tbui/widget/image_uploader_manager","tbui/widget/scroll_panel","tbui/widget/image_flash_editor","ueditor/widget/slide_select"],sub:{DIALOG_TITLE:"\u63d2\u5165\u56fe\u7247",PICTURE_EDITOR_ANIMATE_DURATION:500,ORIGINAL_PIC_URL_PREFIX:"https://web.archive.org/web/20201117141157/https://imgsa.baidu.com/forum/pic/item/",THUMBNAIL_PIC_URL_PREFIX:"https://web.archive.org/web/20201117141157/https://imgsa.baidu.com/forum/abpic/item/",ABPIC_URL_PATH:"/forum/abpic/item/",PIC_URL_PATH:"/forum/pic/item/",uploadingImageMark:{},pictureEditorOpen:!1,layerHeight:460,layerWidth:680,waterType:0,initial:function(e){this.options=e;var t=this;t.uploader=t.initUploader($(e.uploadButtonContainer)),t.uploadingImageMark={}},isrollback:function(){return"undefined"==typeof this.options.props||$.browser.msie&&"6.0"==$.browser.version&&!$.support.style},initUploader:function(e){var t=this,i=this.requireInstance("tbui/widget/image_uploader_manager",{locate:"local_upload",container:e,width:e.width(),height:e.height(),queueLen:100,maxParallel:5,fid:this.options.forumId,isAutoUp:!1,save_yun_album:this.options.save_yun_album,picWaterType:$(".slide_item_active").data("key")});return i.bind("onFileSelected",function(e,a){for(var r,o=t.deduplicate(a.imageList),n=o.duplicate,s=o.allowed,d=0;r=n[d];d++)i.deleteFile(r.id);var l=t.getRemainingNumber(),c=s.length;if(c>l){for(var d=l;c>d;d++)i.deleteFile(s[d].id);s=s.splice(0,l)}i.startUpload(),t.renderImageList(s,"upload")}),i.bind("onProgressListen",function(e,i){t.updateProgress(i)}),i.bind("onComplete",function(e,i){t.updateProgress(i)}),i},getRemainingNumber:function(){return this.options.maxLimit?Math.max(0,this.options.maxLimit-this.getImageNumber()):Number.MAX_VALUE},getImageList:function(){return this.$imageContainer?this.$imageContainer.find(".picture_item"):null},getImageNumber:function(){var e=this.getImageList();return e?e.size():0},updateProgress:function(e){for(var t,i=e.imageList,a=this.getImageList(),r=0;t=i[r];r++)this.updateItemProgress(t,a.filter('[data-id="'+t.id+'"]'))},updateItemProgress:function(e,t){if(!t.is(".complete")){var i=t.find("b"),a=e.percent;i.css({width:a+"%"}),100==a&&this.renderItem(e.response,t)}},renderItem:function(e,t){var i=this,a=t.find("b");if(null!=e&&0==e.error_code){var r=e.info.pic_id_encode,o=e.info.fullpic_width,n=e.info.fullpic_height,s=e.info.pic_water?e.info.pic_water.replace(/https:\/\/web.archive.org\/web\/20201117141157\/http:\/\/imgsrc/,"https://web.archive.org/web/20201117141157/https://imgsa"):e.info.pic_water,d=t.find("img")[0];d.src="/tb/static-common/editor_img/layer/i.gif",t.removeClass("uploading").addClass("complete"),t.data("picEncode",r),t.data("waterUrl",s),t.data("width",o),t.data("height",n),e.info.host?t.data("url","https://"+e.info.host+i.PIC_URL_PATH+r+".jpg"):t.data("url",i.ORIGINAL_PIC_URL_PREFIX+r+".jpg");var l=new Image;l.onload=function(){d.style.backgroundImage=e.info.host?"url(https://"+e.info.host+i.ABPIC_URL_PATH+r+".jpg)":"url("+i.THUMBNAIL_PIC_URL_PREFIX+r+".jpg)",(l.width<120||l.height<120)&&(d.style.backgroundSize="auto"),a.parent().hide()},l.src=e.info.host?"https://"+e.info.host+i.ABPIC_URL_PATH+r+".jpg":i.THUMBNAIL_PIC_URL_PREFIX+r+".jpg",e.info.host?l.src="https://"+e.info.host+i.PIC_URL_PATH+r+".jpg":(new Image).src=i.ORIGINAL_PIC_URL_PREFIX+r+".jpg",s&&((new Image).src=s)}else i.errorHandler(t.find("img")),a.parent().hide()},errorHandler:function(e){e.tbattr("src","/tb/static-common/editor_img/layer/upload_fail.png");var t=e.parent();t.removeClass("uploading").addClass("i_up_error")},deduplicate:function(e){for(var t,i=[],a=[],r=0;t=e[r];r++){var o=t.name+t.size;this.uploadingImageMark[o]?a.push(t):(i.push(t),this.uploadingImageMark[o]=!0)}return{allowed:i,duplicate:a}},renderContinueUpload:function(){var e=this.getRemainingNumber(),t="";return 0==e&&(t="i_upload_limit"),'<a class="add_more '+t+'"><div class="add_more_button"></div><span class="i_image_remain">\u8fd8\u53ef\u4ee5\u6dfb\u52a0<span class="j_image_num">'+(e==Number.MAX_VALUE?"\u65e0\u9650":e)+"</span>\u5f20</span></a>"},renderImageList:function(e){var t=this;if(t.dialog){if(e.length>0){var i=t.generateImages(e,"continue");t.$continueUploader.before(i),$.browser.msie&&$.browser.version<8||(t.scrollPanel._resizeHeight(),t.scrollPanel.scrollTopTo(2e4)),t.updateRemainingNumber(t.$root,function(){t.$continueUploader.addClass("i_upload_limit")},function(){t.$continueUploader.removeClass("i_upload_limit")})}}else this.initDialog(e)},updateRemainingNumber:function(e,t,i){var a=this,r=a.getRemainingNumber();e.find(".j_image_num").html(r),0==r?t():i()},initDialog:function(e){var t=this;t.$root=$('<div class="picture_selector_container"></div>'),t.$imageContainer=$('<div class="ps_image_container clearfix"></div>'),t.$waterImageSelecter=$('<div class="water_image_selecter clearfix"></div>'),t.isrollback()&&t.$imageContainer.css("height",395);var i=t.generateImages(e,"first");if(t.$imageContainer.on("click",".close",function(){var e=$(this).parent(),i=e.data("name"),a=e.data("size"),r=e.data("id"),o=e.data("uptype");try{"first"==o?t.uploader.deleteFile(r):"continue"==o&&t.conUploader.deleteFile(r)}catch(n){}t.uploadingImageMark[i+a]=!1,e.remove(),t.updateRemainingNumber(t.$root,function(){t.$continueUploader.addClass("i_upload_limit")},function(){t.$continueUploader.removeClass("i_upload_limit")})}),t.layerBottom=t.generateDialogFooter(),t.$root.append(t.$imageContainer).append(t.layerBottom),t.dialog=new $.dialog({html:t.$root,title:t.DIALOG_TITLE,width:t.layerWidth,height:t.layerHeight,show:!1,closeable:!0,scrollable:!1}),$(t.dialog.element).find(".dialogJcontent").css("padding",0),t.dialog.bind("onclose",function(){if(t.pictureEditorOpen)return t.hidePictureEditor(),!1;try{t.uploader&&t.uploader.stopUpload(),t.uploader&&t.uploader.clearList(),t.conUploader&&t.conUploader.stopUpload(),t.conUploader&&t.conUploader.clearList()}catch(e){}t.destroy(),t.trigger("close")}),t.uploader.uploader.flash){var a=t.dialog.element;t.dialog.element=t.dialog.element.add(t.uploader.uploader.flash.parentNode),t.dialog.show(),t.dialog.element=a}else t.dialog.show();t.trigger("open"),$.browser.msie&&$.browser.version<8?(t.$imageContainer.html(i),t.$imageContainer.append(t.renderContinueUpload()),t.$continueUploader=t.$imageContainer.find(".add_more"),t.addContinueUploader(),t.$imageContainer.sortable({items:".picture_item",scroll:!1})):(t.scrollPanel=t.requireInstance("tbui/widget/scroll_panel",{container:t.$imageContainer,height:t.isrollback()?388:288,content:i}),t.scrollPanel.appendContent(t.renderContinueUpload()),t.$continueUploader=t.$imageContainer.find(".add_more"),t.addContinueUploader(),t.$root.find(".j_panel_content").sortable({items:".picture_item",scroll:!1})),t.initPictureEditor()},initPictureEditor:function(){var e=this;e.$pictureEditorContainer=$("<div class='picture_editor_container' id='picture_editor_container'></div>"),e.$root.append(e.$pictureEditorContainer),this.pictureEditor=this.requireInstance("tbui/widget/image_flash_editor",[{container:e.$pictureEditorContainer,width:678,height:461},{uploadURL:"https://web.archive.org/web/20201117141157/https://uploadphotos.baidu.com/upload/pic?tbs=4f165305af36ccdc013751701760125500_1&fid="+e.options.forumId}]),this.$imageContainer.on("click",".j_editor_button",function(){$.stats.track("image_beauty","ueditor","frs","click");var t=$(this).closest(".picture_item");e.showPictureEditor(t)}),this.pictureEditor.bind("upload_complete",function(t,i){e.hidePictureEditor(),e.renderItem(i,e.pictureEditor.$item)}),this.pictureEditor.bind("cancel",function(){e.hidePictureEditor()})},showPictureEditor:function(e){this.pictureEditorOpen=!0,this.dialog.setTitle("\u56fe\u7247\u7f16\u8f91"),this.pictureEditor.$item=e,this.pictureEditor.loadRemoteImage(e.data("url")),this.$pictureEditorContainer.animate({left:-1},this.PICTURE_EDITOR_ANIMATE_DURATION)},hidePictureEditor:function(){this.pictureEditorOpen=!1,this.dialog.setTitle(this.DIALOG_TITLE),this.$pictureEditorContainer.animate({left:684},this.PICTURE_EDITOR_ANIMATE_DURATION)},generateDialogFooter:function(){var e=this,t=['<div class="dialog_footer">',e.isrollback()?'<div class="watermark_options"><label><input checked type="checkbox" /> \u6dfb\u52a0\u672c\u5427\u6c34\u5370(gif\u683c\u5f0f\u6216\u8fc7\u5c0f\u7684\u56fe\u7247\u65e0\u6cd5\u6dfb\u52a0)</label></div>':'<div class="watermark_options">*gif\u683c\u5f0f\u6216\u8fc7\u5c0f\u7684\u56fe\u7247\u65e0\u6cd5\u6dfb\u52a0\u6c34\u5370</div><div class="insert_image_tip">\u6c34\u5370\u6dfb\u52a0\u5931\u8d25</div>','<div class="i_layer_btn">','<a href="#" style="float:left;margin-right:10px;" class="btn_default btn_middle ok_button">\u63d2\u5165\u56fe\u7247</a>','<a href="#" style="float:left" class="btn_sub btn_middle cancel_button">\u53d6 \u6d88</a>',"</div>","</div>"].join(""),i=$(t),a="true"==$.tb.Storage.get("watermark");return a||i.find(":checkbox").tbprop("checked",!1),i.find(".ok_button").click(function(){return e.submit(),e.isrollback()&&e.dialog.close(),!1}),i.find(".cancel_button").click(function(){return e.dialog.close(),!1}),i},generateImages:function(e,t){for(var i,a=[],r=0;i=e[r];r++)i.uptype=t,a.push($.tb.format('<a href="javascript:void(0);" title="\u62d6\u62fd\u8c03\u6574\u6392\u5e8f" unselectable="on" class="uploading picture_item"  data-name="#{name}" data-uptype="#{uptype}" data-size="#{size}" data-id="#{id}" draggable="true"><img class="i_item_bg" src="/tb/static-common/editor_img/layer/unload.png"><span class="progress"><b></b></span><span class="close" title="\u5220\u9664\u6b64\u56fe"></span><span class="error">\u4e0a\u4f20\u5931\u8d25</span></a>',i));return a.join("")},addContinueUploader:function(){this.conUploader=this.initUploader(this.$continueUploader.find(".add_more_button"))},destroy:function(){this.$root.remove(),this.$root=null},getInsertImageData:function(e){var t=[];return this.getImageList().filter(".complete").each(function(){var i=$(this),a={},r=i.data("url"),o=i.data("waterUrl");a.url="1"==e&&o?o:r,a.width=i.data("width")||0,a.height=i.data("height")||0,a.picType=0,t.push(a)}),t},_getInsertImageData:function(e,t){var i=this,a=null,r=[];this.getImageList().filter(".complete").each(function(){var i=$(this),a={},o=i.data("url"),n=$(this).data("picEncode");t&&t[n]?(a.url=t[n].water_url2,a.ptype=1):a.url=1039998==e&&i.data("waterUrl")?i.data("waterUrl"):o,a.width=i.data("width")||0,a.height=i.data("height")||0,a.picType=0,r.push(a)}),t?(this.insertImageTip.addClass("loading_water_image").text("\u6c34\u5370\u751f\u6210\u4e2d").show(),a=setTimeout(function(){i.trigger("ok",r),i.dialog.close()},2e3)):(this.trigger("ok",r),this.dialog.close())},submit:function(){if(this.isrollback()){var e=this.layerBottom.find(":checkbox")[0],t=e.checked;$.tb.Storage.set("watermark",t);var i=this.getInsertImageData(t);this.trigger("ok",i)}else this._getInsertImageData(this.waterType)}}});_.Module.define({path:"ueditor/widget/picture_selector",sub:{layerHeight:515,layerWidth:810,initial:function(t){this.options=t},genericNetPic:function(){var t="",e="net"+(new Date).getTime();return t+='<a href="javascript:void(0);" unselectable="on" class="complete i_item_con" data-id="'+e+'" draggable="true"><img class="i_netitem_bg" src="/tb/static-common/editor_img/layer/unload.png"><span class="progress"><b></b></span><span class="close" title="\u5220\u9664\u6b64\u56fe"></span><span class="error">\u4e0a\u4f20\u5931\u8d25</span></a>'},checkURL:function(t){if(t=t.trim(),t.length<=0)return!1;0!==t.search(/http:\/\/|https:\/\//)&&(t+="http://");var e=/(.gif|.jpg|.jpeg|.png)$/i;return!e.test(t)||t.getByteLength()>this.urlLength?!1:/["'<>]/.test(t)?(alert("\u8f93\u5165\u5185\u5bb9\u542b\u6709\u8fdd\u6cd5\u5b57\u7b26\uff01"),!1):t},layerBottom:function(){var t=this,e=$('<div class="i_layer_bottom"></div>'),a=$('<a href="#" style="float:left;margin-right:10px;" class="btn_default btn_middle">\u786e \u5b9a</a>'),i=$(' <a href="#" style="float:left" class="btn_sub btn_middle">\u53d6 \u6d88</a>'),r=$('<div class="i_layer_btn"></div>');return r.append(a).append(i),e.append(r),e.width(this.layerWidth-2),$.browser.msie&&$.browser.version<7&&e.css({bottom:6}),a.click(function(){return t.submit(),t.lDialogOp.close(),!1}),i.click(function(){return t.lDialogOp.close(),!1}),e},getURLs:function(t,e,a){for(var i,r=[],n=e.find(".i_item_con"),s=0;s<n.length;s++)if(i=n.eq(s),"obj"==a){var l={};i.hasClass("complete")&&i.tbattr("data-url")&&(l.url=i.tbattr("1"==t&&""!=i.tbattr("data-water-url")&&"undefined"!=i.tbattr("data-water-url")?"data-water-url":"data-url"),l.width=i.tbattr("data-width")||"",l.height=i.tbattr("data-height")||"",l.picType=1,r.push(l))}else i.hasClass("complete")&&i.tbattr("data-url")&&r.push("1"==t&&""!=i.tbattr("data-water-url")&&"undefined"!=i.tbattr("data-water-url")?i.tbattr("data-water-url"):i.tbattr("data-url"));return r},resetImg:function(t,e,a){var i,r=t.width,n=t.height,s=0,l=0;r>e||n>a?(i=r>=n?e/r:e/n,l=(e-r*i)/2,s=(a-n*i)/2,$(t).css({height:n*i,width:r*i,top:s,left:l,visibility:"visible"})):(l=(e-r)/2,s=(a-n)/2,$(t).css({top:s,left:l,visibility:"visible"}))},updateRemianImage:function(t,e,a){var i=this,r=i.getRemainingNumber(t);this.$root.find(".j_image_num").html(r),0==r?e&&e():a&&a()},getRemainingNumber:function(t){return this.options.maxLimit?Math.max(0,this.options.maxLimit-this.getImageNum(t)):Number.MAX_VALUE},getImageNum:function(t){return t&&t.find(".i_item_con").size()||0}}});_.Module.define({path:"ueditor/widget/picture_web_selector",requires:["tbui/widget/scroll_panel"],extend:"ueditor/widget/picture_selector",sub:{GET_ALBUM_URL:"/photo/interface/alblist",layerHeight:460,tbsUrl:"//web.archive.org/web/20201117141157/https://tieba.baidu.com/dc/common/imgtbs",uploadUrl:"https:"===$.tb.location.getProtocol()?"https://web.archive.org/web/20201117141157/https://uploadphotos.baidu.com/upload/pic":"https://web.archive.org/web/20201117141157/http://upload.tieba.baidu.com/upload/pic",PIC_URL_PATH:"/forum/pic/item/",layerWidth:680,initial:function(t){this._options=t,this.__super__(t),this.addPicList={},this.netPicLayer(),this._initUploadUrl()},addPicList:{},netPicLayer:function(){var t=this,e=$("<div></div>");this.$root=e;var i=$('<div class="l_netpic_container"></div>'),n='<div class="l_netpic_head clearfix"></div><div class="l_image_container"></div>';t.netContainer=i,i.html(n),e.append(i).append(t.layerBottom());var a={html:e,title:"\u7f51\u7edc\u56fe\u7247",width:t.layerWidth,height:t.layerHeight,closeable:!0};t.lDialogOp=new $.dialog(a),t.lDialogOp.bind("onclose",function(){delete t.lDialogOp}),e.click(function(t){return t.stopPropagation&&t.stopPropagation(),!1}),$.browser.msie&&$.browser.version<7&&e.closest(".dialogJcontent").css({padding:"9px 0px 9px 9px;"}),t.lDialogOp.show(),t.renderInput(),t.renderPicCon()},renderInput:function(){var t=this.getRemainingNumber(this.netContainer),e='<input type="text" value="\u7c98\u8d34\u56fe\u7247\u5730\u5740" class="l_netpic_input j_input form-control"  /><a href="#" style="float:left;" class="btn_default btn_middle j_addpic">\u6dfb \u52a0</a><span class="j_netpic_imagenum">\u8fd8\u53ef\u4ee5\u6dfb\u52a0<span class="j_image_num">'+t+"</span>\u5f20</span>",i=this,n=i.netContainer.find(".l_netpic_head");n.html(e),n.delegate(".j_addpic","click",function(){if(0==i.getRemainingNumber(i.netContainer))return!1;var t=n.find(".j_input").val();return(t=i.checkURL(t))?(i.uploadWebPic(t),n.find(".j_input").val("\u7c98\u8d34\u56fe\u7247\u5730\u5740").css("color","#ccc"),!1):!1}),n.delegate(".j_input","focus",function(){var t=$(this),e=t.val().trim();"\u7c98\u8d34\u56fe\u7247\u5730\u5740"==e&&(t.val(""),t.css("color","#000"))}),n.find(".j_input").focus(),n.delegate(".j_input","blur",function(){var t=$(this),e=t.val().trim();""==e&&(t.val("\u7c98\u8d34\u56fe\u7247\u5730\u5740"),t.css("color","#ccc"))})},_initUploadUrl:function(){var t=this,e=$.ajax({url:this.tbsUrl,dataType:"json"});e.done(function(e){0===Number(e.no)&&(t.uploadUrl+="?tbs="+e.data.tbs+"&fid="+(t._options.fid||"")+"&save_yun_album="+t._options.save_yun_album)})},progressPic:function(t){var e=$(".i_item_con").find("b");e.css({width:t+"%"}),100==t&&$(".i_item_con .progress").css("display","none")},uploadWebPic:function(t){var e=this.genericNetPic(),i=$(e),n=this,a=10,o=i.tbattr("data-id");$.browser.msie&&$.browser.version<8?this.netContainer.find(".l_image_container").append(i):this.scrollPanel.appendContent(i);for(var r=0;8>r;r++)!function(t){setTimeout(function(){$(".i_item_con .progress b").width()<a+5&&n.progressPic(a),a+=5},1e3*t)}(r);$.ajax({url:n.uploadUrl,data:{filetype:"url",file:"",urls:[t]},xhrFields:{withCredentials:!0},crossDomain:!0,type:"POST",success:function(t){if(t.urls){var e="https://"+t.urls[0].host+n.PIC_URL_PATH+t.urls[0].pic_id_encode+".jpg";n.progressPic(100),n.addPicList[o]=i,i.tbattr("data-url",e),i.find("img.i_netitem_bg").load(function(){n.resetImg(this,120,120)}).tbattr("src",e),n.updateRemianImage(n.netContainer)}else n.errorPopup("\u4e0a\u4f20\u5931\u8d25\uff0c\u8bf7\u7a0d\u5019\u91cd\u8bd5"),$(".i_item_con:last").remove()},error:function(){n.errorPopup("\u4e0a\u4f20\u5931\u8d25\uff0c\u8bf7\u7a0d\u5019\u91cd\u8bd5"),$(".i_item_con:last").remove()},dataType:"json"})},removeImage:function(t){var e=this.netContainer.find(".l_image_container"),i=this;i.addPicList[t].remove(),delete i.addPicList[t],i.updateRemianImage(e)},renderPicCon:function(){var t=this.netContainer.find(".l_image_container"),e=this;$.browser.msie&&$.browser.version<8||(e.scrollPanel=e.requireInstance("tbui/widget/scroll_panel",{container:t,height:350,content:""})),t.delegate(".close","click",function(){var t=$(this).parent(),i=t.tbattr("data-id");e.removeImage(i)}),t.delegate(".i_item_con","mouseover",function(){$(this).find(".close").show()}),t.delegate(".i_item_con","mouseleave",function(){$(this).find(".close").hide()})},errorPopup:function(){$(".uiDialogWrapper").append('<div class="errpopup"><span>\u4e0a\u4f20\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5</span></div>'),$(".errpopup").animate({opacity:"1"});var t=setInterval(function(){$(".errpopup").animate({opacity:"0"}),clearInterval(t)},3e3)},layerBottom:function(t){var e="",i=this,n="upload"==t?"\u63d2\u5165\u56fe\u7247":"\u786e \u5b9a",a=$('<div class="i_layer_bottom"></div>'),o=$('<a href="#" style="float:left;margin-right:10px;" class="btn_default btn_middle">'+n+"</a>"),r=$(' <a href="#" style="float:left" class="btn_sub btn_middle">\u53d6 \u6d88</a>'),s=$('<div class="i_layer_btn"></div>');return s.append(o).append(r),a.append(s),"upload"==t&&(e='<div class="i_layer_water"><input class="i_checkbox" style="float:left;margin:3px 2px 0px 0px;;" checked type="checkbox" /><span style="float:left;">\u6dfb\u52a0\u672c\u5427\u6c34\u5370(gif\u683c\u5f0f\u6216\u8fc7\u5c0f\u7684\u56fe\u7247\u65e0\u6cd5\u6dfb\u52a0)</span></div>',a.append(e)),a.width(this.layerWidth-2),$.browser.msie&&$.browser.version<7&&a.css({bottom:6}),o.click(function(){return i.submit(),i.lDialogOp.close(),!1}),r.click(function(t){try{i.lDialogOp.close()}catch(t){alert(t.message)}return!1}),a},submit:function(){var t=this,e=t.getURLs(0,t.netContainer,"obj");this.trigger("ok",e)}}});_.Module.define({path:"ueditor/widget/picture",requires:["ueditor/widget/slide_select","ueditor/widget/picture_web_selector","ueditor/widget/picture_uploader","ueditor/widget/tb_gram"],sub:{initial:function(e,t,i){e=e||window.UE,t=t||window.EditorUI,i=$.extend({},i),this.props=i.props,this.initPlugin(e,this),this.initLayer(t,this),this.initModel(t,this),this.initAdapter(e,t,this)},initPlugin:function(e){e.plugins.tb_image=function(){function t(e){for(var t,a=[],r=0;t=e[r];r++)t.url&&a.push(i(t,!0));return a.join("")}function i(e,t){return e.width&&e.width>o&&(e.height=Math.floor(e.height/e.width*o),e.width=o),e.size=e.width&&e.height?'width="'+e.width+'" height="'+e.height+'"':'onload="EditorUI.resizeImage(this, '+o+')"',e.ptype&&(r=103),e.picType=null!=e.picType?'pic_type="'+e.picType+'"':"",t?$.tb.format('<img class="BDE_Image" data-isupload="1" src="#{url}" unselectable="on" #{picType} #{size} /><br />',e):$.tb.format('<img class="BDE_Image" src="#{url}" unselectable="on" #{picType} #{size} /><br />',e)}var a=this,r=0,n=560,o=n;a.addListener("beforepaste",function(e,t){var a=/<img[^>]*class="BDE_Colorful"[^>]*code="([\w\d]*)".*?(?:>|\/>)/gi;t.html=t.html.replace(a,function(e,t){return String.fromCharCode(t)});var a=/(?:<img.*?>)|(?:<emb.*?>)|(?:http:\/\/((?:[a-zA-Z\d\-]+\.)+[a-zA-Z\d]+(?:\:[\d]{2,5})?)\/([^\s]+?)\.(jpg|jpeg|gif|png|bmp))/gi;t.html=t.html.replace(a,function(e){return"<"==e.charAt(0)?e:i({url:e,picType:1})})}),a.addListener("resize",function(e,t){a.$body.find(".BDE_Image").each(function(e,i){EditorUI.resizeImage(i,t)}),o=t}),a.getImageNumber=function(){return $(a.body).find(".BDE_Image").size()},a.commands.insertimage={execCommand:function(e,i){var r=t(i);a.execCommand("inserthtml",r,!0)}},a.addOutputRule(function(e){$.each(e.getNodesByTagName("img"),function(e,t){t.setAttr("onload",""),"_kf_formula_image"===t.getAttr("class")&&(t.setAttr("class","BDE_Image"),t.setAttr("pic_type","1"),t.setAttr("data-source"));var i=t.getAttr("src");/^data:/.test(i)&&t.parentNode.removeChild(t)})},!0),a.addListener("aftergetcontent",function(t,i){e.utils.each(i.getNodesByTagName("img"),function(e){var t=/https:\/\/web.archive.org\/web\/20201117141157\/http:\/\/d.pcs.baidu.com\/thumbnail/;if("BDE_Image"==e.getAttr("class")){var i=e.getAttr("src");t.test(i)&&e.setAttr("src",i.replace(/&amp;/g,"&"))}})})}},initLayer:function(e,t){e.registerLayer("image",function(e,i,a){var r=['<ul class="layer_btn_list clearfix">',a.tb_gram?'<li class="from_tbgram"><a class="tbgram_container" href="javascript: void(0);"></a></li>':"",'<li class="from_upload" ><a class="pic_upload_container" href="javascript: void(0);"></a><a href="#"></a></li>','<li class="from_web"><a href="#"></a></li>',"</ul>",'<div class="upload_container">','<div class="water_image_selecter_wrap">',"</div>",'<div class="watermark_options">*gif\u683c\u5f0f\u6216\u8fc7\u5c0f\u7684\u56fe\u7247\u65e0\u6cd5\u6dfb\u52a0\u6c34\u5370</div>','<div class="next_step">\u4e0b\u4e00\u6b65</div>',"</div>","</div>"].join(""),n='<div class="layer_text_tip">\u63d2\u5165\u56fe\u7247\u5df2\u8fbe\u4e0a\u9650\uff0c\u6700\u591a\u53ef\u63d2\u5165#{maxLimit}\u5f20~</div>',o=$.eduipopup().on("beforeshow",function(){function a(){var e=t.requireInstance("ueditor/widget/slide_select",{wrap:$(".water_image_selecter_wrap"),props:t.props,propsCategory:103,dataArr:[{key:"1039999",title:"\u65e0\u6c34\u5370",extendClass:"no_water slide_item_active"},{key:"1039998",title:"\u8d34\u5427\u6c34\u5370"},{key:"1030001",title:"\u6211\u7684\u6c34\u5370"},{key:"1030002",title:"\u5341\u5e74\u6709\u6211"}],showSlide:!1,wrapCss:{"margin-left":20},navPrevCss:{left:26},navNextCss:{left:626}});this.insertImageTip=$(".insert_image_tip"),e.initCarouse();var i=$(".water_image_selecter_wrap .slide_list");i.on("click",".slide_item",function(){$(this).find(".need_buy_link").length>0||(i.find(".slide_item").removeClass("slide_item_active"),$(this).addClass("slide_item_active"))})}var s=e.getValue("maxLimit")-e.getValue("imageNumber"),d=null;s>0?(d=$(r),d.find(".from_upload > a").click(function(e){e.preventDefault(),$(".pic_upload_container").addClass("pic_upload_active"),$(".upload_container").css("display","block")}),d.find(".from_web > a").click(function(a){a.preventDefault(),$(".pic_upload_container").removeClass("pic_upload_active");var r=t.requireInstance("ueditor/widget/picture_web_selector",{maxLimit:s,fid:i.forum.id,save_yun_album:1});r.bind("ok",function(t,i){e.trigger("insertimage",i)}),e.setValue("pictureUploaderOpen",!1)})):d=$($.tb.format(n,{maxLimit:e.getValue("maxLimit")}));var u=o.edui().getBodyContainer();u.html(""),u.append(d),a()}).on("aftershow",function(){var r=e.getValue("maxLimit")-e.getValue("imageNumber");if(r>0){var n={uploadButtonContainer:o.edui().getBodyContainer().find(".next_step"),maxLimit:r,forumId:i.forum.id,props:t.props,tbs:i.tbs,save_yun_album:1};e.getValue("dontSavePictureToYunAlbum")&&(n.save_yun_album=0);var s=t.requireInstance("ueditor/widget/picture_uploader",n);s.bind("ok",function(t,i){e.trigger("insertimage",i)}),s.bind("open",function(){e.setValue("pictureUploaderOpen",!0)}),s.bind("close",function(){e.setValue("pictureUploaderOpen",!1),e.trigger("close")}),a.tb_gram&&t.requireInstance("ueditor/widget/tb_gram",{container:o.edui().getBodyContainer().find(".tbgram_container"),maxLimit:10,forumId:i.forum.id,props:i.user.props,tbs:i.tbs},function(t){t.bind("ok",function(t,i){e.trigger("insertimage",i)}),t.bind("close",function(){e.trigger("close")}),e.bind("close",function(){t.destorySwf()})})}});return e.setWidget(o),o})},initModel:function(e){e.registerModel("image",function(t,i){var a=new e.EditorModel;e.bindLayer("image",a);var r=$.eduibutton({icon:"image",title:"\u63d2\u5165\u56fe\u7247"});return a.setButton(r),a.setValue("maxLimit",i.img_num),a})},initAdapter:function(e,t){e.registerUI("image",function(e){var i=this,a=t.getModel(e),r=a.getButton(),n=a.getWidget();return a.setValue("dontSavePictureToYunAlbum",this.options.dontSavePictureToYunAlbum),r.click(function(){a.setValue("imageNumber",i.getImageNumber()),n.parent().length||i.$container.find(".edui-dialog-container").append(n),n.css("zIndex",i.options.zIndex+1).edui().show(r,{offsetTop:-10,caretLeft:20,caretTop:-8}),$.stats.track("picture_btn","ueditor")}),a.bind("insertimage",function(e,t){i.execCommand("insertimage",t)}),a.bind("close",function(){n.hide()}),r.edui().register("click",r,function(e){var t=a.getValue("pictureUploaderOpen");null!=t&&0!=t||-1!=e.target.className.indexOf("pic_upload_container")||"slide_item_img_wrap"===e.target.className||n.hide()}),r})}}});_.Module.define({path:"ueditor/widget/custom_emotion",sub:{ORIGINAL_PIC_URL_PREFIX:"https://web.archive.org/web/20201117141157/https://imgsa.baidu.com/forum/pic/item/",THUMBNAIL_PIC_URL_PREFIX:"https://web.archive.org/web/20201117141157/https://imgsa.baidu.com/forum/abpic/item/",_template:["<table class='t_emotion_add'>","<tr>","<th>\u63cf\u8ff0</th>","<td><input type='text' name='title' class='form-control j_title'></td>","</tr>","<tr>","<th>\u8868\u60c5\u56fe\u7247</th>","<td><div style='position: relative'><button type='button' class='j_fake_button'>\u4e0a\u4f20</button><div class='upload_button_container j_upload_button'></div><span class='file_name j_file_name'></span></div><div class='j_preview'></div></td>","</tr>","<tr>","<th></th>",'<td><a href="#" class="ui_btn ui_btn_s j_ok"><span><em>\u786e\u5b9a</em></span></a> ','<a href="#" class="ui_btn ui_btn_s j_cancel"><span><em>\u53d6\u6d88</em></span></a></td>',"</tr>","</table>"],initial:function(){},openDialog:function(t){var e=this;this.$root=$(this._template.join("")),e.$previewContainer=e.$root.find(".j_preview");var o=e.$root.find(".j_fake_button");if(t.url){var i=t.url,n=i.substring(i.lastIndexOf("/")+1,i.lastIndexOf("."));e.updatePictureId(n),e.$previewContainer.prev().hide()}this.$root.find(".j_ok").click(function(t){t.preventDefault(),t.stopPropagation();var o=e.$root.find(".j_title").val();null!=e.original&&null!=e.thumbnail?(e.addCustomEmotion({title:o,url:e.original,thumbnail:e.thumbnail}),e.trigger("ok"),a.close()):alert("\u8bf7\u6dfb\u52a0\u56fe\u7247\u4f5c\u4e3a\u81ea\u5b9a\u4e49\u8868\u60c5\uff01")}),this.$root.find(".j_cancel").click(function(t){t.preventDefault(),t.stopPropagation(),a.close()});var a=new $.dialog({title:"\u6dfb\u52a0\u81ea\u5b9a\u4e49\u8868\u60c5",width:350,html:this.$root});a.show();var r=this.$root.find(".j_upload_button"),s=o.outerWidth(),u=o.outerHeight();r.css({width:s,height:u}),_.Module.use("common/widget/image_uploader_manager",{container:r,width:s,height:u,queueLen:1,maxParallel:1,fid:t.forumId},function(t){t.bind("onFileSelected",function(o,i){var n=i.imageList[0];n&&(r.next().html(n.name),e.$previewContainer.html("\u6b63\u5728\u4e0a\u4f20\uff0c\u8bf7\u7a0d\u5019..."),t.startUpload())}),t.bind("onComplete",function(t,o){var i=o.imageList[0];if(i&&i.response){var n=i.response;0==n.error_code&&e.updatePictureId(n.info.pic_id_encode)}})})},updatePictureId:function(t){this.thumbnail=this.THUMBNAIL_PIC_URL_PREFIX+t+".jpg",this.original=this.ORIGINAL_PIC_URL_PREFIX+t+".jpg",this.$previewContainer.html("<img src='"+this.thumbnail+"' />")},getCustomEmotions:function(){var t=$.tb.Storage.get("customEmotion");return t?$.json.decode(t):[]},addCustomEmotion:function(t){var e,o=$.tb.Storage.get("customEmotion");o?(e=$.json.decode(o),e.push(t)):e=[t],this.saveCustomEmotion(e)},removeCustomEmotion:function(t){var e=$.tb.Storage.get("customEmotion");if(e){for(var o,i=$.json.decode(e),n=null,a=0;o=i[a];a++)if(t===o.url){n=a;break}null!==n&&i.splice(n,1),this.saveCustomEmotion(i)}},saveCustomEmotion:function(t){var e=new Date;e.setFullYear(e.getFullYear()+1),$.tb.Storage.set("customEmotion",$.json.encode(t),e)}}});_.Module.define({path:"ueditor/widget/ueditor_emotion",requires:["tbui/widget/scroll_panel","ueditor/widget/custom_emotion"],sub:{$container:null,_template:{inner:['<div class="s_layer_content j_content ueditor_emotion_content"></div>','<div  class="s_layer_tab j_tab ueditor_emotion_tab"></div>','<div class="emotion_preview j_emotion_preview"></div>'].join(""),tab:'<div class="s_prev"></div><div class="s_tab_con_wrapper"><ul class="s_tab_content">#{content}</ul></div><div class="s_next"></div>',tabItem:'<li class="s_tab_btn #{isSelected}" data-index="#{index}" data-type="#{type}"><span class="s_tab_btnbg">#{name}</span></li>',table:'<table class="s_layer_table" cellpadding="1" cellspacing="1" align="center" style="border-collapse:collapse;" border="1" bordercolor="#e3e3e3">#{content}</table>',tr:"<tr>#{content}</tr>",td:'<td class="#{tdClassName} j_emotion" border="1" width="#{tdWidth}" height="#{tdHeight}" style="border-collapse:collapse;" data-value="#{index}" data-sname="#{groupName}" data-type="normal" data-class="#{tdClassName}" align="center"  bgcolor="#FFFFFF" data-stype="#{configType}" title="#{tip}" data-surl="#{url}" data-posflag="#{posflag}">#{content}</td>',tdEmpty:'<td width="#{edWidth}" height="#{tdHeight}" bgcolor="#FFFFFF"></td>',a:'<a class="img" href="javascript:void(0)" style="display:block;color:#000;font-size:14px;text-decoration:none;background-position:left #{offset}px;" >#{content}</a>'},path:"//web.archive.org/web/20201117141157/https://tb2.bdstatic.com/tb/editor/images/",defaultGroup:"face",sequence:["custom","face","ySmile","bearchildren","tiexing","ali","luoluobu","qpx","xyj","lt","bfmn","zxh","tsj","wdj","lxs","baodong","baodong_d","bobo","shadow","ldw","10th"],tableWidth:540,count:0,colsNum:3,emotionConfig:{custom:{folder:"",name:"\u81ea\u5b9a\u4e49",css:{cols:10,"class":"s_custom"},type:"custom",power:0},face:{tip:["\u5475\u5475","\u54c8\u54c8","\u5410\u820c","\u554a","\u9177","\u6012","\u5f00\u5fc3","\u6c57","\u6cea","\u9ed1\u7ebf","\u9119\u89c6","\u4e0d\u9ad8\u5174","\u771f\u68d2","\u94b1","\u7591\u95ee","\u9634\u9669","\u5410","\u54a6","\u59d4\u5c48","\u82b1\u5fc3","\u547c~","\u7b11\u773c","\u51b7","\u592a\u5f00\u5fc3","\u6ed1\u7a3d","\u52c9\u5f3a","\u72c2\u6c57","\u4e56","\u7761\u89c9","\u60ca\u54ed","\u5347\u8d77","\u60ca\u8bb6","\u55b7","\u7231\u5fc3","\u5fc3\u788e","\u73ab\u7470","\u793c\u7269","\u5f69\u8679","\u661f\u661f\u6708\u4eae","\u592a\u9633","\u94b1\u5e01","\u706f\u6ce1","\u8336\u676f","\u86cb\u7cd5","\u97f3\u4e50","haha","\u80dc\u5229","\u5927\u62c7\u6307","\u5f31","OK","\u4f24\u5fc3","\u52a0\u6cb9","\u5fc5\u80dc","\u671f\u5f85","\u725b\u903c","\u80dc\u5229","\u8ddf\u4e2b\u6b7b\u78d5","\u8e22\u7403","\u9762\u58c1","\u9876","\u5df4\u897f\u6012","\u4f34\u821e","\u5954\u8dd1","\u70b9\u8d5e\u624b","\u52a0\u6cb9","\u54ed\u6ce3","\u4eae\u7ea2\u724c","\u7403\u8ff7","\u8036","\u8f6c\u5c41\u80a1"],num:70,prev:"i_f",folder:"face/",suffix:"png",name:"\u9ed8\u8ba4",css:{cols:10,"class":"s_face",width:35,offset:30},type:"img",power:1},yxj:{tip:["\u5b64\u72ec\u5bc2\u5bde\u51b7","\u5149\u68cd\u5403\u6839\u6cb9\u6761","\u53ef\u601c\u6ca1\u4eba\u7231","\u53bbtmd\u5149\u68cd\u8282","\u6765\u6361\u80a5\u7682\u554a","\u7ed9\u8dea\u4e86","\u60ca\u5446\u4e86","\u62ff\u53bb\u64b8","\u54e6\u5973\u795e","\u697c\u4e3b\u597d\u4eba"],num:10,prev:"yxj_0",folder:"yxj/",name:"\u75d2\u5c0f\u8d31",suffix:"gif",css:{cols:10,"class":"s_yxj",width:30,offset:30},type:"img",power:1},"10th":{tip:["\u8e66\u8e66\u8df3\u8df3","\u6643\u60a0","\u6447\u6447\u6446\u6446","\u5927\u6492\u82b1","\u9ad8\u9ad8\u5174\u5174","\u5f39\u5409\u4ed6","\u9b54\u6cd5\u68d2","\u625b\u5927\u65d7","\u70b9\u8721\u70db","\u5927\u79e7\u6b4c","\u8d34\u5427\u5341\u5468\u5e74","\u5341\u5468\u5e74"],num:12,prev:"10th_0",folder:"10th/",name:"\u5341\u5468\u5e74",css:{cols:10,"class":"s_tyears",width:42,offset:42},type:"img",power:1},ldw:{tip:["\u4e00\u697c\u5582\u718a","\u4fef\u5367\u6491","\u6253\u9171\u6cb9","\u56e7","\u5927\u7b11","\u7011\u5e03\u6c57~","\u60ca\u8bb6","\u81ed\u7f8e","\u50bb\u7b11","\u629b\u5a9a\u773c","\u53d1\u6012","\u6211\u9519\u4e86","money","\u6c14\u6124","\u6311\u9017","\u543b","\u6012","\u80dc\u5229","\u59d4\u5c48","\u53d7\u4f24","\u8bf4\u5565\u5462\uff1f","\u95ed\u5634","\u4e0d","\u9017\u4f60\u73a9\u513f","\u98de\u543b","\u7729\u6655","\u9b54\u6cd5","\u6211\u6765\u4e86","\u7761\u4e86","\u6211\u6253","\u95ed\u5634","\u6253","\u6253\u6655\u4e86","\u5237\u7259","\u7206\u63cd","\u70b8\u5f39","\u5012\u7acb","\u522e\u80e1\u5b50","\u90aa\u6076\u7684\u7b11","\u4e0d\u8981\u4e0d\u8981","\u7231\u604b\u4e2d","\u653e\u5927\u4ed4\u7ec6\u770b","\u5077\u7aa5","\u8d85\u9ad8\u5174","\u6655","\u677e\u53e3\u6c14","\u6211\u8dd1","\u4eab\u53d7","\u4fee\u517b","\u54ed","\u6c57","\u554a~","\u70ed\u70c8\u6b22\u8fce"],num:53,prev:"w_00",folder:"ldw/",suffix:"gif",name:"\u7eff\u8c46\u86d9",css:{cols:10,"class":"s_ldw",width:40,offset:40},type:"img",power:1},lxs:{tip:["lxs\u4e0d\u60f3\u52a8","lxs\u5403\u60ca","lxs\u5439\u53e3\u54e8","lxs\u6253\u6c14","lxs\u6253\u5750","lxs\u7b49\u5f85","lxs\u6124\u6012","lxs\u5e7b\u8c61","lxs\u60ca\u559c","lxs\u5f00\u5fc3","lxs\u54ed\u557c","lxs\u54ed\u7740\u8dd1","lxs\u6ca1\u94b1","lxs\u6015\u9b3c","lxs\u629b\u5a9a\u773c","lxs\u4e03\u5915","lxs\u9a91\u9a6c\u821e","lxs\u5347\u5929","lxs\u77f3\u5316","lxs\u6570\u94b1","lxs\u5077\u5403","lxs\u5077\u7b11","lxs\u4e07\u5723\u8282","lxs\u65e0\u804a","lxs\u65e0\u5948","lxs\u65e0\u8bed","lxs\u59a9\u5a9a","lxs\u6349\u6025","lxs\u8f6c\u6655","lxs\u649e\u8c46\u8150","lxs\u8d58\u8089"],num:31,prev:"lxs_0",folder:"lxs/",suffix:"gif",name:"\u51b7\u5148\u68ee",css:{cols:10,"class":"s_lxs",width:42,offset:42},type:"img",power:1},xyj:{tip:["\u75af\u5566","\u62b1\u5934\u8dd1","\u4e0d\u60f3\u7761","\u4e0d\u8981\u5440","\u82cd\u8747","\u8e6d\u75d2","\u5230\u7897\u91cc\u6765","\u961f\u957f","\u53d1\u8d22\u5566","\u975e\u6d32\u821e","\u9f13\u638c","\u5e7f\u573a\u821e","\u6eda\u7b52","\u6a2a\u884c","\u6325\u624b","\u706b\u821e\u9e21","\u5bc2\u5bde\u5440","\u52a0\u6cb9","\u6c5f\u5357style","\u5a07\u7f9e","\u60ca\u614c\u5931\u63aa","\u7ea0\u7ed3","\u5f00\u996d\u5566","\u96f7\u795e","\u6cea\u5954","\u804aQQ","\u9ea6\u9738","\u732b\u5973","\u9b54\u5492","\u5c3f\u6025","\u626d\u5c41\u80a1","\u7011\u5e03\u6c57","\u6c42\u9976","\u6492\u5a07","\u5c11\u5973","\u6c34\u51b0\u9e21","\u5929\u7136\u5446","\u5410\u8840","\u73a9\u624b\u673a","\u5a01\u6b66","\u4e94\u9053\u6760","\u821e\u52a8","\u6d17\u6d17","\u54b8\u86cb\u9e21","\u5411\u65e5\u8475","\u9e2d\u5b50\u821e","\u6e38\u6cf3","\u62db\u8d22\u9e21","\u7167\u955c\u5b50","\u8718\u86db\u9e21"],num:50,prev:"xyj_0",folder:"xyj/",suffix:"gif",name:"\u5c0f\u5e7a\u9e21",css:{cols:10,"class":"s_xyj",width:42,offset:42},type:"img",power:1},ySmile:{tip:["^_^","(-__-)b","\u2299\ufe4f\u2299\u2016","\u2299\u25bd\u2299"," \u2267\u03b5 \u2266","\u2533\uff3f\u2533","(\u256c\u25bc\u76bf\u25bc\uff09","\\(&quot;\u2594\u25a1\u2594)/","\u2196(\uffe3\u25bd\uffe3&quot;) ","(\u3065\uffe33\uffe3)\u3065 ","(*\uffe3\u25bd\uffe3)y ","o(\u2267\u53e3\u2266)o ","(\uffe3\u03b5\uffe3*)","/(\u3112o\u3112)/~~ ","(\uffe3\u03b5\uffe3*)","&lt;(\uffe3\ufe36\uffe3)&gt; ","o(\u2267v\u2266)o","\u256e(\u256f3\u2570)\u256d "," \uff61\u25d5\u203f\u25d5\uff61"," \u7f52\u03c9\u7f52","(\u25d5\u03c9\uff1c)\u2606 ","(\u273f\u272a\u203f\u272a\uff61)\uff89 ","\uff08\u25d5(\uff6a)\u25d5\uff09","(\u25cf&#039;\u25e1&#039;\u25cf)\uff89\u2665","\u03a3(\u3063 \xb0\u0414 \xb0;)\u3063","\u311f( \u2594, \u2594 )\u310f","\u51f8(\u8279\u76bf\u8279 ) ","m(_ _)m","(\u2299x\u2299;)","( =\u2229\u03c9\u2229= )"," \u256e(\u256f\u25bd\u2570)\u256d","(\u22673\u2266)/ ","(\uff20_\uff20;)?"," o(*\uffe3\u25bd\uffe3*)\u30d6","(o\u309c\u25bd\u309c)o\u2606","&quot;o((&gt;\u03c9&lt; ))o&quot; "],num:36,prev:"",folder:"",name:"\u989c\u8868\u60c5",css:{cols:6,"class":"s_ySmile"},type:"text",power:1},wdj:{tip:[],num:24,prev:"wdj_",suffix:"png",folder:"wdj/",name:"\u8c4c\u8c46\u835a",css:{cols:10,"class":"s_wdj",width:30,offset:30},type:"img",power:1},ali:{tip:["\u8d56\u76ae","\u611f\u52a8","\u60ca\u8bb6","\u6012\u6c14","\u54ed\u6ce3","\u5403\u60ca","\u5632\u5f04","\u98d8\u8fc7","\u8f6c\u5708\u54ed","\u795e\u7ecf\u75c5","\u63ea\u8033\u6735","\u60ca\u6c57","\u9690\u8eab","\u4e0d\u8981","\u9041","\u4e0d\u516c\u5e73","\u722c\u6765\u4e86","\u86cb\u82b1\u54ed","\u6e29\u6696","\u70b9\u5934","\u6492\u94b1","\u732e\u82b1","\u5bd2","\u50bb\u7b11","\u626d\u626d","\u75af","\u6293\u72c2","\u6293","\u8737","\u6320\u5899","\u72c2\u7b11","\u62b1\u6795","\u543c\u53eb","\u56b7","\u5520\u53e8","\u634f\u8138","\u72c2\u7b11","\u90c1\u95f7","\u6f5c\u6c34","\u5f00\u5fc3","\u51b7\u7b11\u8bdd","\u9876","\u6f5c","\u753b\u5708\u5708","\u73a9\u7535\u8111","\u5410","\u54ed\u7740\u8dd1","\u963f\u72f8\u4fa0","\u51b7\u6b7b\u4e86","\u60c6\u6005~","\u6478\u5934","\u8e6d","\u6253\u6eda","\u53e9\u62dc","\u6478","\u6570\u94b1","\u62d6\u8d70","\u70ed","\u52a01","\u538b\u529b","\u8868\u903c\u6211","\u4eba\u5462","\u6447\u6643","\u6253\u5730\u9f20","\u8fd9\u4e2a\u5c4c","\u6050\u614c","\u6655\u4e4e\u4e4e","\u6d6e\u4e91","\u7ed9\u529b","\u676f\u5177\u4e86"],num:70,prev:"ali_0",folder:"ali/",name:"\u963f\u72f8",css:{cols:10,"class":"s_ali",width:42,offset:42},type:"img",power:1},luoluobu:{tip:["hold\u4f4f","\u963f\u95e8","\u54ce\u54df","\u5509\uff5e","\u4e0d\u597d\u610f\u601d","\u4e0d\u8981\u561b\uff01","\u5531\u6b4c","\u626f\u809a\u76ae","\u626f\u8138","\u6413\u8138","\u6413\u624b","\u6253\u706f\u7b3c","\u6253\u8d77\u7cbe\u795e","\u70b9\u5934","\u70b9\u59342","\u52a8\u52a8\u811a","\u52a8\u52a8\u811a2","\u6296\u811a","\u6296\u811a2","\u55ef\uff5e","\u53d1\u5446","\u9f13\u638c","\u6eda\u684c\u5b50","\u597d\u95f2\u963f\uff5e","\u559d\u8336\u53d1\u5446","\u54fc\uff01","\u6643","\u54ed","\u56f0\u4e86","\u6269\u80f8\u8fd0\u52a8","\u6765\u6765\u6765","\u6765\u561b\uff5e","\u51b7\u9759\u51b7\u9759","\u7f57\u7238\u7238\u626d\u626d","\u7f57\u5988\u5988\u626d\u626d","\u9e8b\u9e7f\u7f57\u7f57\u5e03","\u626dpp","\u626dpp2","\u626d\u626d","\u6b27\u4e5f","\u8db4\u7740","\u5207\uff01","\u53bb\u53bb","\u6492\u82b1","\u4e0aWC","\u5723\u8bde\u8001\u4eba","\u5929\u4f7f\u7f57\u7f57\u5e03","\u8df3\u5440\u8df3","\u8df3\u5440\u8df32","\u73a9\u4e2a\u7403","\u6211\u6765\u4e86","\u563b\u563b","\u5411\u524d\u8fdb","\u4e9a\u514b\u897f","\u6447\u554a\u6447","\u4e00\u8fb9\u5446\u7740\u53bb\uff01","\u4e00\u8d77\u626d","\u6709\u793c\u4e86","\u8fd9\u53a2\u6709\u793c\u4e86","\u8d70\u5440\u8d70"],num:60,prev:"llb_0",folder:"luoluobu/",name:"\u7f57\u7f57\u5e03",css:{cols:10,"class":"s_luoluobu",width:42,offset:42},type:"img",power:1},qpx:{tip:["\u5fae\u7b11","\u5e05\u54e5","\u7f8e\u5973","\u8001\u5927","\u54c8\u54c8\u54c8","\u5978\u7b11","\u50bb\u4e50","\u98de\u543b","\u5bb3\u7f9e","\u82b1\u75f4","\u61a7\u61ac","\u4f60\u725b","\u9f13\u638c","\u53ef\u7231","\u59d4\u5c48","\u5927\u54ed","\u6cea\u5954","\u5bfb\u6b7b","\u60ca\u8bb6","\u7591\u95ee","\u9119\u89c6","\u5927\u9a82","\u72c2\u6012","\u56e7","\u6655","\u5455\u5410","\u8d22\u8ff7","\u7761\u4e86","\u601d\u8003","\u6c57","\u65e0\u8bed","\u62dc","\u97a0\u8eac","\u7d2f\u4e86","\u75c5\u4e86","\u5899\u89d2","\u8d85\u4eba","\u6233","\u8df3\u821e","\u9b3c\u8138","\u65e0\u804a","\u649e\u5899","\u9876","HI","\u996d","\u86cb\u7cd5","\u793c\u7269","\u5fc3","\u5fc3\u788e","\u73ab\u7470","\u70b8\u5f39","\u96c6\u4f53\u821e","\u6253\u4eba","\u62cd\u62cd","\u4eb2\u4eb2","\u63e1\u624b","\u5b89\u6170","\u77f3\u5934","\u526a\u5b50","\u5e03","\u606d\u559c\u5566","\u5575\u5575"],num:62,prev:"b",folder:"qpx_n/",name:"\u6c14\u6ce1\u718a",css:{cols:10,"class":"s_qpx",width:35,offset:35},type:"img",power:1},zxh:{tip:["+1","\u54c0\u4f24","\u9971","\u6fd2\u6b7b","\u75c5","\u5403\u8d27","\u4e0d\u6ee1","\u5446","\u5012\u540a","\u70b9\u5b50","\u9876","\u9f13\u638c","\u5bb3\u7f9e","\u6c57","\u5475\u5475\u5475","\u52a0\u6cb9","\u5978\u7b11","\u5978\u8bc8","\u60ca\u8bb6","\u56e7","\u770b","\u62a0\u9f3b\u5b50","\u54ed","\u56f0","\u4e50","\u6e9c\u8d70","\u8def\u8fc7","\u4e70\u4f60\u59b9\u7684\u623f\u7eb8","\u6572\u9523","\u4eb2\u543b","\u53bb\u4f60\u59b9\u7684\u5de5\u4f5c","\u6247\u98ce","\u5931\u843d","\u5237\u7259","\u9003\u547d","\u8df3\u821e","\u542c\u97f3\u4e50","\u5077\u7b11","\u5410","\u65e0\u8bed","\u559c","\u7b11","\u5174\u594b","\u9e2d\u5b50\u8df3","\u54ac","\u54ac","\u793c\u7269","\u8d5e","\u9707\u60ca","\u8ffd\u94b1","\u505a\u9b3c\u8138"],num:50,prev:"zxh_0",folder:"pczxh/",name:"\u5f20\u5c0f\u76d2",css:{cols:10,"class":"s_zxh",width:42,offset:42},type:"img",power:1},tsj:{tip:["Kiss","Love","Yeah","\u554a\uff01","\u80cc\u626d","\u9876","\u6296\u80f8","88","\u6c57","\u778c\u7761","\u9c81\u62c9","\u62cd\u7816","\u63c9\u8138","\u751f\u65e5\u5feb\u4e50","\u644a\u624b","\u7761\u89c9","\u762b\u5750","\u65e0\u804a","\u661f\u661f\u95ea","\u65cb\u8f6c","\u4e5f\u4e0d\u884c","\u90c1\u95f7","\u6b63Music","\u6293\u5899","\u649e\u5899\u81f3\u6b7b","\u6b6a\u5934","\u6233\u773c","\u98d8\u8fc7","\u4e92\u76f8\u62cd\u7816","\u780d\u6b7b\u4f60","\u6254\u684c\u5b50","\u5c11\u6797\u5bfa","\u4ec0\u4e48\uff1f","\u8f6c\u5934","\u6211\u7231\u725b\u5976","\u6211\u8e22","\u6447\u6643","\u6655\u53a5","\u5728\u7b3c\u5b50\u91cc","\u9707\u8361"],num:40,prev:"t_00",folder:"tsj/",name:"\u5154\u65af\u57fa",css:{cols:10,"class":"s_tsj",width:35,offset:35},type:"img",power:1},baodong:{tip:["\u5fc3\u7167\u4e0d\u5ba3","\u84dd\u8138","\u56f0\u60d1","\u591f\u62fd","\u77aa\u773c","\u85d0\u89c6","\u601d\u8003","\u5475\u5475","\u60f3\u8981\u59b9\u5b50","\u5e7b\u60f3","\u65e0\u5948\u7684\u7b11","\u4e3a\u4ec0\u4e48","\u9ed1\u4eba\u6b6a\u5634","\u6b6a\u5634\u7b11","\u82e6\u903c","\u9762\u762b","\u54af\u54af\u54af","\u751f\u6c14","\u9ad8\u5174","\u559c\u6781\u800c\u6ce3","\u544a\u8bc9\u6211","\u6709\u4e86","\u597d\u5427","\u5b64\u72ec\u4e00\u751f","\u560e\u560e","\u66b4\u8e81","\u7d2b\u6b6a\u5634","\u7ea2\u6b6a\u5634","\u8fd9\u4e0d\u79d1\u5b66","\u7b11\u800c\u4e0d\u8bed","\u56f4\u89c2","\u725b\u4ed4\u6b6a\u5634","\u65b9\u8098\u5b50","\u9707\u60ca","\u60ca\u8bb6","\u98a0\u8986\u4e09\u89c2","\u5c3c\u7f8e\u85d0\u89c6","\u5c3c\u7f8e\u5475\u5475","\u5c3c\u7f8e\u53d1\u5446","\u5c3c\u7f8e\u6709\u4e86","\u732b\u5634\u7b11","\u601d\u6625","\u5c3c\u7f8e\u82e6\u903c","\u7b11\u5c3f","\u5c3c\u7f8e\u54af\u54af","\u5c3c\u7f8e\u6b6a\u5634","\u5c3c\u7f8e\u59da","\u66b4\u8d70\u5c3c\u7f8e","\u5a07\u7f9e","\u5c3c\u7f8e\u9707\u60ca","\u5b64\u72ec\u5c3c\u7f8e","\u5c3c\u7f8e\u5927\u54ed","\u5c3c\u7f8e\u6124\u6012","\u5c3c\u7f8e\u560e\u560e","\u5c3c\u7f8e\u6124\u61d1","\u5c3c\u7f8e\u4e0d\u89e3"],num:56,prev:"b_00",folder:"baodong/",name:"\u66b4\u6f2b\u9759\u6001",css:{cols:10,"class":"s_baodong",width:35,offset:35},type:"img",power:1},baodong_d:{tip:["\u574f\u6deb","\u6293\u72c2","\u60b2\u621a","\u75db\u54ed","\u72af\u8d31","\u5978\u7b11","\u5c4c\u4e1d","\u9ad8\u547c","\u611f\u53f9","\u611f\u52a8","\u618b\u5c48","\u8212\u723d","\u574f\u7b11","\u5c41\u98a0","\u77b3\u672f","\u6742\u800d","\u59da\u8138","\u5b64\u72ec","\u66b4\u8d70","\u6f47\u6d12","\u5931\u671b","\u540c\u684c","\u53d8\u8138","\u5f97\u745f","\u8179\u9ed1\u7537","\u8179\u9ed1\u5973","\u591f\u62fd","\u767d\u9886","\u55b5\u5c3c\u739b","\u6c6a\u5c3c\u739b","\u563f\u563f\u5c3c\u739b","\u52fe\u5f15","\u53d1\u6cc4","\u64cd\u64cd\u64cd"],num:34,prev:"bd_00",folder:"baodong_d/",name:"\u66b4\u6f2b\u52a8\u6001",css:{cols:10,"class":"s_baodong_d",width:35,offset:35},type:"img",power:1},bobo:{tip:["HI","KISS","\u4e0d\u8bf4","\u4e0d\u8981","\u626f\u82b1","\u5927\u5fc3","\u9876","\u5927\u60ca","\u98de\u543b","\u9b3c\u8138","\u5bb3\u7f9e","\u53e3\u6c34","\u72c2\u54ed","\u6765","\u6cea\u773c","\u6d41\u6cea","\u751f\u6c14","\u5410\u820c","\u559c\u6b22","\u65cb\u8f6c","\u518d\u89c1","\u6293\u72c2","\u6c57","\u9119\u89c6","\u62dc","\u5410\u8840","\u5618","\u6253\u4eba","\u8e66\u8df3","\u53d8\u8138","\u626f\u8089","\u5403To","\u5403\u82b1","\u5439\u6ce1\u6ce1\u7cd6","\u5927\u53d8\u8eab","\u98de\u5929\u821e","\u56de\u7738","\u53ef\u601c","\u731b\u62bd","\u6ce1\u6ce1","\u82f9\u679c","\u4eb2","","\u9a9a\u821e","\u70e7\u9999","\u7761","\u5957\u5a03\u5a03","\u6345\u6345","\u821e\u5012","\u897f\u7ea2\u67ff","\u7231\u6155","\u6447","\u6447\u6446","\u6742\u800d","\u62db\u8d22","\u88ab\u6bb4","\u88ab\u7403\u95f7","\u5927\u60ca","\u7406\u60f3","\u6b27\u6253","\u5455\u5410","\u788e","\u5410\u75f0"],num:63,prev:"B_00",folder:"bobo/",name:"\u6ce2\u6ce2",css:{cols:10,"class":"s_bobo",width:35,offset:35},type:"img",power:1},shadow:{tip:["\u7126\u7cd6\u821e","\u7ffb\u6eda","\u62cd\u5c41\u80a1\u505a\u9b3c\u8138","\u4e0d","\u6cb3\u87f9\u6389\u5566","\u54e6\u8036","\u6211\u5012","\u6295\u964d","\u542c\u97f3\u4e50","\u88ab\u7838","\u5410\u820c\u5934","\u592a\u597d\u5566","\u8d22\u6e90\u6eda\u6eda","\u4eba\u5462","\u6325\u624b\u5e15","\u5077\u7b11","\u5377\u88ab","\u770b\u697c\u4e0a","\u6211\u62bd","\u6709\u6728\u6709","\u54ed","\u6b22\u547c","\u50bb\u516e\u516e","\u6247\u6247\u5b50","\u62cd\u624b","\u7d27\u5f20","\u6d17\u6fa1","\u8036","\u5403\u897f\u74dc","\u7eb3\u5c3c","\u6ca1\u6709\u94b1","\u62ff\u73a9\u5076","\u6765\u770b\u770b","\u54c7\u54c7\u53eb","\u62db\u8d22\u732b","\u653e\u5c41","\u9686\u91cd\u4ecb\u7ecd","\u6c42\u4f60\u4e86","\u649e\u73bb\u7483","\u773a\u671b","\u6492\u82b1","\u73a9\u94c3\u94db","\u601d\u8003\u8005","\u62bd\u98ce","\u5403\u82f9\u679c","\u5149\u68cd"],num:46,prev:"yz_0",folder:"shadow/",name:"\u5f71\u5b50",css:{cols:10,"class":"s_shadow",width:42,offset:42},type:"img",power:1},lt:{tip:["\u4e2d\u7bad","LS\u53bb\u6b7b","LS\u53bb\u6b7b\u5b50\u5f39","LS\u53bb\u6b7b\u589e\u5f3a","LS\u53bb\u6b7b\u70ae\u5f39","\u677f\u51f3","\u4e0d\u723d","\u4e0d\u8981","\u8d85\u4eba","\u5403\u96f6\u98df","\u62bd\u70df","\u4e32","\u6253\u72d7","\u6253\u9171\u6cb9","\u6253\u4f60","\u6234\u58a8\u955c","\u86cb","\u8361\u6f3e","\u9876\u7834\u697c\u4e0a","\u53d1\u61f5","\u653e\u5c41","\u8d1f\u5206\u6eda\u7c97","\u559d\u5927\u4e86","\u547c\u5566\u5708\u513f","\u62a4","\u6ed1\u51b0","\u753b\u5708\u5708","\u706b\u94b3\u5218","\u8d31\u8d31\u7684","\u60ca\u5413","\u62a0\u811a","lt\u54ed","\u62c9\u7c91\u7c91","\u64b8","\u6320PP","\u95f9","\u6392\u7403","\u524d\u6392","\u6572\u624b\u9f13","\u6c99\u53d1","\u5254\u7259","\u5154\u5b50\u8e66\u8d77\u6765","\u6316\u9f3b\u5c4e","\u65e0\u8bed","\u778e\u4e86","\u79c0\u808c\u8089","\u6447\u6eda","\u610f\u5916\u60ca\u559c","\u9707\u60ca","\u6b63\u6b65"],num:50,prev:"ltn_0",folder:"lt/",name:"\u51b7\u5154",css:{cols:10,"class":"s_lt",width:42,offset:42},type:"img",power:1},bfmn:{tip:["\u7231\u4f60","\u50b2\u5a07","\u6253\u4f60","\u5e26\u56de\u53bb\u538b\u5be8","\u7ed9\u8138\u4e0d\u8981\u8138","\u6eda\uff08\u767e\u5ea6\u72ec\u5bb6\uff09","\u6eda","\u597d\u559c\u6b22","\u6cea\u5954","\u5973\u5c4c\u4e1d","\u6df1\u4e95\u51b0","\u7b97\u4f60\u72e0","\u6211\u7f8e","\u867e\u7c73","\u4e0d\u8981","\u597d\u5d07\u62dc","\u6cea\u5954","\u4f60\u59b9\u554a","\u4f60\u9020\u4e48","\u6c42\u4ea4\u5f80","\u9a9a\u5e74","\u571f\u8c6a\u505a\u670b\u53cb\uff08\u767e\u5ea6\u72ec\u5bb6\uff09","\u56f4\u89c2","\u65e0\u836f\u53ef\u533b","\u518d\u89c1","\u5728\u4e48","call-me","no-zuo-no-die"],num:28,prev:"bfmn_0",folder:"bfmn/",name:"\u767d\u53d1\u9b54\u5973",css:{cols:10,"class":"s_bfmn",width:40,offset:41},type:"img",power:1},bearchildren:{tip:["88","HI","\u4eba\u8270\u4e0d\u62c6","\u5565","\u5927\u54ed","\u5931\u843d","\u6012\u8d5e","\u60ca\u5446\u4e86","\u674e\u83ca\u798f","\u6765\u4fe1\u780d","\u6b22\u8fce\u5165\u7fa4","\u725b\u95ea\u95ea","\u751f\u65e5\u5feb\u4e50","\u77f3\u5316","\u7f9e\u7f9e\u54d2","\u80a5\u7682\u5fc5\u6740","\u8c22\u8c22\u4f60","\u8df3\u821e","\u9739\u96f3\u821e","\u9f13\u638c","\u5077\u5185\u88e4","\u54e6\u8036","\u54ed","\u559c\u6b22","\u597d\u68d2","\u6454","\u6c42\u7b7e\u540d","\u83ca\u82b1","\u5c41","\u54ed","\u9876","+1","biu","\u4eb2\u4eb2","\u97ad\u5211","\u80e1\u5b50","\u50f5\u5c38","\u6349\u6025","\u626d\u626d","\u63d2\u697c\u4e0a","\u559c\u6b22","\u8dea\u6c42","\u7f9e\u7f9e","\u62a0\u9f3b\u5b50","\u4f11\u606f\u4e00\u4e0b","\u5df2\u6b7b","\u5fd9\u7740\u5462","\u6c57","\u6da8\u59ff\u52bf","\u7cca\u4f60\u718a\u8138","\u8c1c\u56e2","\u98de\u543b","love","\u54e6\u8036","\u54ed","\u5d29\u6e83","\u561a\u745f","\u65ad\u7f51","\u6d17\u6fa1","\u8d2d\u7269"],num:60,prev:"bearchildren_",folder:"bearchildren/",name:"\u718a\u5b69\u5b50",css:{cols:10,"class":"s_bearchildren",width:40,offset:40},type:"img",power:1},tiexing:{tip:["ILOVEU","\u4e0a\u73ed\u4e2d","\u4e0d\u8981\u561b","\u4e2d\u7bad","\u4ef0\u5367\u8d77\u5750","\u4f53\u64cd","\u54c8\u54c8","\u54ed","\u597d\u57fa\u53cb","\u5bc2\u5bde","\u561a\u745f","\u60ca\u5446\u4e86","\u6311\u8845","\u6413\u6fa1","\u649e\u5934","\u65e0\u804a","\u6d17\u6fa1","\u6d17\u8863\u670d","\u70b9\u624b\u6307","\u725b\u903c","\u73a9\u6c34\u679c","\u751f\u75c5","\u76ae\u97ad\u4f3a\u5019","\u7761\u89c9","\u793a\u7231","\u7ed9\u8dea\u4e86","\u80dc\u5229","\u8ba8\u538c","\u8ddf\u4e2b\u6b7b\u78d5","\u8e22\u7403","\u8eba\u67aa","\u9001\u7eb8","\u9003\u8dd1","\u9876","\u9a6c\u8428\u5409","\u4e0d\u670d","\u4eb2\u543b","\u4f24\u5fc3","\u5207\u514b\u95f9","\u52a0\u6cb9","\u52fe\u5f15","\u5343\u5e74\u6740","\u53bbtmd","\u53d1\u6296","\u5403","\u547c\u54c8","\u54ed","\u5931\u843d","\u5b64\u72ec","\u5e86\u795d","\u561a\u745f","\u5fc5\u80dc","\u60ca","\u62bd","\u62bd\u4e2b\u7684","\u6311\u8845","\u6361\u80a5\u7682","\u6492\u82b1","\u649e\u5899","\u671f\u5f85","\u677f\u51f3","\u72af\u8d31","\u7b11","\u8def\u8fc7","\u9119\u89c6","\u9762\u58c1","\u9876","\u9876\u697c\u4e0a","\u9c81","\u9f13\u638c"],num:70,prev:"tiexing_",folder:"tiexing/",name:"\u75d2\u5c0f\u8d31",css:{cols:10,"class":"s_tiexing",width:40,offset:40},type:"img",power:1}},initial:function(t){var e=this,s=t.container;t.customEmotionEnable&&(this.emotionConfig.custom.power=1,this.defaultGroup="custom"),this.$container=s,this.defaultGroup=t.defaultGroup||e.defaultGroup,s.html(this._template.inner),this.$content=s.find(".j_content"),this.$tab=s.find(".j_tab"),e.scrollPanel=e.requireInstance("tbui/widget/scroll_panel",{container:e.$content,height:277,content:""}),t.customEmotionEnable&&(this.customEmotion=this.requireInstance("ueditor/widget/custom_emotion"),this.customEmotion.bind("ok",function(){e.scrollPanel.$content.html(e.generateCustomTable())})),e.generateTabList(),e.switchTab(e.defaultGroup),e.initEvent()},initEvent:function(){this.$container;this.initEmotionEvent(),this.initTabEvent()},initEmotionEvent:function(){var t=this,e=this.getMouseenterHandler(this);this.$content.on("mouseleave",".j_emotion, .j_custom_emotion",function(){$(this).css("background-color","#ffffff"),$(".j_emotion_preview").hide().removeClass("emotion_preview_show")}),this.$content.on("mouseenter",".j_emotion, .j_custom_emotion",function(){e.call(this)}),this.$content.on("click",".j_emotion",function(){var e=$(this),s={url:e.data("surl"),type:e.data("stype"),title:e.tbattr("title")};"text"==e.data("stype")?$.stats.sendRequest("ev_type=click&st_mod=editor&st_type=text&st_value="+e.tbattr("title")):t.sendStats(e,"click"),t.trigger("insertemotion",s)}).on("click",".j_custom_emotion",function(e){var s=$(e.target);if(s.hasClass("j_delete")){if(confirm("\u786e\u8ba4\u8981\u5220\u9664\u6b64\u8868\u60c5\u5417\uff1f")){var o=s.parent().data("surl");t.customEmotion.removeCustomEmotion(o),t.scrollPanel.$content.html(t.generateCustomTable())}}else t.trigger("insertemotion",{url:$(this).data("surl"),type:"custom"})}).on("click",".j_add_emotion",function(){t.customEmotion.openDialog({forumId:PosterContext.getContext().forum.id})})},initTabEvent:function(){var t=this;this.$tab.on("click",".s_prev",function(){t.prevTab()}).on("click",".s_next",function(){t.nextTab()}).on("click","li",function(){var e=$(this).data("type");e&&t.switchTab(e)}).on("mouseenter",".s_tab_btn",function(){$(this).addClass("s_hover")}).on("mouseleave",".s_tab_btn",function(){$(this).removeClass("s_hover")})},sendStats:function(t,e){var s=t.data("value"),o=t.data("sname"),i=[40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60];try{o&&"10th"==o&&$.stats.track(s,"PC\u7aef\u5341\u5468\u5e74\u53d1\u5e16\u8868\u60c5\u70b9\u51fb\u7edf\u8ba1"),$.stats.sendRequest(-1!=$.inArray(s,i)?"st_all=doubleeleven&ev_type="+e+"&st_mod=editor&st_type="+o+"&st_value="+s:"ev_type="+e+"&st_mod=editor&st_type="+o+"&st_value="+s)}catch(n){}},getMouseenterHandler:function(){function t(){var t=e.width(),s=e.height();(t>60||s>60)&&(t>s?(e.width(60),e.height(60*(s/t))):(e.height(60),e.width(60*(t/s))));var o=(60-e.width())/2,i=(60-e.height())/2;e.css({left:o,top:i})}var e=null,s=null;return function(){var o=$(this),i=$(".j_emotion_preview");e&&e.remove(),o.css("background-color","#e8e8fd"),"text"!==o.data("stype")&&(e=$("<img/>"),e.addClass("review"),e.load(function(){clearTimeout(s),i.show();var n=e.width(),a=e.height();0==n||0==a?s=setTimeout(arguments.callee,50):(t(),1==o.data("posflag")&&i.addClass("emotion_preview_show"))}).error(function(){s=setTimeout(function(){e.tbattr("src",o.data("surl"))},50)}).tbattr("src",o.data("surl")),i.append(e))}},getEmotionFileName:function(t,e,s){return"i_f"==t&&e>=51&&(s="gif"),t+(10>e?"0":"")+e+"."+s},generateEmotions:function(t){var e=this,s=this.scrollPanel,o=this.emotionConfig,i=o[t],n=this.path,a=n+i.folder,l=i.css.cols,r=l/2,c=this.tableWidth/l,d=c;"text"==i.type&&(d/=2);var m,u=i.css["class"],p=i.css.offset,f=i.suffix||"gif",h=i.prev,_=this._template.table,b=this._template.tr,g=this._template.tdEmpty,v=this._template.td,x=this._template.a,w="",y=function(t){for(var s="",o=0,n=i.num;n>o;){for(var m="",_=0;l>_;_++,o++){var w=e.getEmotionFileName(h,o+1,f);if(w&&n>o){var y=a+w+"?t=20140803",j=r>_?0:1,C=p*o*-1;("lt"==t||"ali"==t)&&(C-=1),"ali"==t&&(C+=3);var E="text"==i.type?i.tip[o]:"&nbsp;",T=$.tb.format(x,{offset:C,content:E});m+=$.tb.format(v,{tdClassName:u,tdWidth:c,tdHeight:d,index:o,groupName:t,configType:i.type,tip:i.tip[o],url:y,posflag:j,content:T})}else m+=$.tb.format(g,{})}s+=$.tb.format(b,{content:m})}return s};m="custom"==i.type?this.generateCustomTable():y(t),w+=$.tb.format(_,{content:m}),s.setContent(w),s.$content.css("height",277)},generateCustomTable:function(){function t(t,e){return t?t.option?'<td><button type="button" class="j_add_emotion">\u6dfb\u52a0</button></td>':(t.posFlag=5>e?0:1,$.tb.format('<td class="emotion_cell"><a href="javascript:void(0)" class="j_custom_emotion" data-surl="#{url}" data-posflag="#{posFlag}"><div class="emotion_hole"><img title="#{title}" src="#{thumbnail}" onload="$.tb.resizePic(this, 50, 50, true);" /></div><div class="emotion_delete j_delete"></div></a></td>',t)):"<td>&nbsp;</td>"}function e(e,s){var o=[];o.push("<tr>");for(var i=0;10>i;i++)o.push(t(e[i+s],i));return o.push("</tr>"),o.join("")}var s=this.customEmotion.getCustomEmotions();s.push({option:"add"});for(var o=[],i=0,n=Math.floor(s.length/10)+1;n>i;i++)o.push(e(s,10*i));return"<table class='ue_emotion_table' cellspacing='1'>"+o.join("")+"</table>"},generateTabList:function(){for(var t=this.sequence,e=this.emotionConfig,s=this._template.tab,o=this._template.tabItem,i="",n=0,a=t.length;a>n;n++){var l=t[n];if(e[l].power){var r={isSelected:l===this.currentGroup?"selected":"",index:n,type:l,name:e[l].name};i+=$.tb.format(o,r)}}i=$.tb.format(s,{content:i}),this.$tab.html(i)},getTab:function(t){return this.$tab.find("li").filter('[data-type="'+t+'"]')},nextTab:function(){var t=this,e=this.$tab.find("ul");t.count=++t.count>=t.colsNum?t.colsNum-1:t.count,e.stop().animate({marginLeft:-502*t.count},500,"linear")},prevTab:function(){var t=this,e=this.$tab.find("ul");t.count=--t.count<1?0:t.count,e.stop().animate({marginLeft:-502*t.count},500,"linear")},activateTab:function(t){var e=this.$tab;e.find("li").removeClass("selected"),this.getTab(t).addClass("selected")},switchTab:function(t){var e=this;e.currentGroup=t,e.activateTab(t),e.generateEmotions(t)}}});_.Module.define({path:"ueditor/widget/emotion",requires:["ueditor/widget/ueditor_emotion"],sub:{initial:function(t,e){t=t||window.UE,e=e||window.EditorUI,this.initPlugin(t,this),this.initLayer(e,this),this.initModel(e,this),this.initAdapter(t,e,this)},initPlugin:function(){},initLayer:function(t,e){t.registerLayer("emotion",function(t){var i='<div class="j_emotion_container emotion_container"></div>',n=$(i),o=$.eduipopup().on("beforeshow",function(){if(!t.getValue("UeditorEmotion")){var i=o.edui().getBodyContainer();i.html(""),i.append(n);var r=e.requireInstance("ueditor/widget/ueditor_emotion",[{container:n,customEmotionEnable:PosterContext.getAuthorities().custom_emotion}]);t.setValue("UeditorEmotion",r),r.bind("insertemotion",function(e,i){t.trigger("insertemotion",i)}),t.bind("aftershow",function(){r.scrollPanel._resizeScroll()})}$.browser.msie&&6==$.browser.version&&$("#tb_rich_poster").find(".j_sign_id").hide()});return $.browser.msie&&6==$.browser.version&&o.on("afterhide",function(){$("#tb_rich_poster").find(".j_sign_id").show()}),t.setWidget(o),o})},initModel:function(t){t.registerModel("emotion",function(){var e=new t.EditorModel;t.bindLayer("emotion",e);var i=$.eduibutton({icon:"emotion",title:"\u63d2\u5165\u8868\u60c5"});return e.setButton(i),e})},initAdapter:function(t,e){t.registerUI("emotion",function(t){var i=this,n=e.getModel(t),o=n.getButton(),r=n.getWidget();return o.click(function(){r.parent().length||i.$container.find(".edui-dialog-container").append(r),r.css("zIndex",i.options.zIndex+1).edui().show(o,{offsetTop:-10,offsetLeft:225,caretLeft:247,caretTop:-8}),n.trigger("aftershow"),$.stats.track("emotion_btn","ueditor")}),r.edui().register("click",r,function(t){o[0]===t.target||$.contains(o[0],t.target)||r.edui().hide()}),n.bind("insertemotion",function(t,e){if("custom"==e.type)e.picType=1,i.execCommand("insertimage",[e]);else{var n='<img unselectable="on" pic_type="" class="BDE_Smiley" src="#{url}">',o="text"===e.type?e.title:$.tb.format(n,e);i.execCommand("inserthtml",o)}r.hide()}),o})}}});_.Module.define({path:"ueditor/widget/ueditor_video/ueditor_local_video",requires:[],sub:{tempHTML:['<div style="padding:30px 0px 5px 30px" class="clearfix"><input type="text" class="v_layer_input j_input" value="\u8bf7\u76f4\u63a5\u8f93\u5165\u89c6\u9891\u64ad\u653e\u9875\u5730\u5740"  ><a href="#" style="float:left;margin-left:5px;" class="ui_btn ui_btn_m j_btn"><span><em>\u63d2\u5165\u89c6\u9891</em></span></a></div>','<div  class="j_error_tip v_error_tip" style="display:none;padding-left:30px;line-height:22px;"></div>','<div style="color:#999;line-height:22px;padding:0 30px;" class="v_layer_text j_layer_text">\u76ee\u524d\u652f\u6301\u7231\u5947\u827a\u3001\u7f8e\u62cd\u3001\u4f18\u9177\u3001\u571f\u8c46\u3001\u641c\u72d0\u3001\u817e\u8baf\u3001\u4e50\u89c6\u3001ACFUN\u3001Bilibili\u7b49\u89c6\u9891\u7f51\u7ad9\u94fe\u63a5<br />\u89c6\u9891\u64ad\u653e\u9875\u94fe\u63a5</div>'].join(""),_dialogWidth:457,initial:function(t){var e=this;e.j_con=t&&t.j_con,this.parent=t&&t.parent,$.JsLoadManager.use("//web.archive.org/web/20201117141157/https://tb1.bdstatic.com/tb/_/sdkbase_391cbac.js",function(){e.createUploader(),e.getbaiduauth()}),this.parent.bind("closelocalvideo",function(){$.browser.msie&&$.browser.version<10&&$('[data^="https://web.archive.org/web/20201117141157/http://www.iqiyi.com/player/cupid/common/VideoUploader.swf"]').hide()})},init:function(t){var e=this;e.j_con=t.j_con,e.parent=t.parent,e._showDialog||($(e.j_con).offset(),this.vcop&&e.vcop.authtoken?(e.resetBtn("40px","150px",12),e.uploader||this.initUploader()):$.JsLoadManager.use("//web.archive.org/web/20201117141157/https://tb1.bdstatic.com/tb/_/sdkbase_391cbac.js",function(){e.createUploader(),e.getbaiduauth()}))},resetBtn:function(t,e,i){var o=this,a=$(o.j_con).offset();this.vcop.resetBtn({uploadBtn:{dom:this.j_con,btnH:t,btnW:e,btnT:a.top+"px",btnL:a.left+"px",btnZ:i,hasBind:!1}}),$.browser.msie&&$.browser.version<10&&$('[data^="https://web.archive.org/web/20201117141157/http://www.iqiyi.com/player/cupid/common/VideoUploader.swf"]').show()},createUploader:function(){var t=this,e=$(t.j_con).offset();if(window.qiyivcop)t.vcop=window.qiyivcop;else{var i=new Q.vcopClient({uploadBtn:{container:t.j_con,dom:t.j_con,btnH:"40px",btnW:"150px",btnT:e.top+"px",btnL:e.left+"px",btnZ:"12",hasBind:!1},appKey:"0E6E5A4747B5BF9E",appSecret:"0E6E5A4747B5BF9E",managerUrl:"https://web.archive.org/web/20201117141157/http://openapi.iqiyi.com/",uploadUrl:"https://web.archive.org/web/20201117141157/http://qichuan.iqiyi.com/"});window.qiyivcop=i,t.vcop=window.qiyivcop}},getbaiduauth:function(){var t=this;$(t.j_con).offset(),t.vcop.getAuthBaidu({ouid:PageData.user.open_uid||3238335284,nick:PageData.user.name_weak||"huair_12",client_id:"0E6E5A4747B5BF9E"},function(e){if(e&&(t.vcop.authtoken=e.data.access_token,t.resetBtn("40px","150px",12),t.initUploader(),$.browser.msie)){var i=$(t.j_con).offset();t.uploader&&t.uploader.initOneFile({btnH:"40px",btnW:"150px",btnT:i.top+"px",btnZ:12,btnL:i.left+"px"})}})},showError:function(t){var e=this,t=t||"<p>1\u3001\u8bf7\u5c06\u89c6\u9891\u5927\u5c0f\u63a7\u5236\u57281G\u4ee5\u5185</p><p>2\u3001\u652f\u6301\u4e0a\u4f20\u7684\u89c6\u9891\u683c\u5f0f\u6709:mpg\u3001mpeg\u3001mp4\u3001m4v\u3001flv\u3001f4v\u3001mkv\u3001avi\u3001rm\u3001rmvb\u3001wmv\u3001mov\u3001ts\u3001vob</p>",i='<div class="v_upload_wrapper"><p class="v_upload_title">\u89c6\u9891\u4e0a\u4f20\u5931\u8d25</p><div  style="line-height:22px;padding-top:10px;font-size:14px;color:#505050;font-family: arial;">'+t+"</div></div>";this.eContent=$(i);var o={html:this.eContent,title:"\u4e0a\u4f20\u89c6\u9891",width:540,height:124,closeable:!0};e._showDialog&&(e.success=!0,e.lDialogOp.close(),$(window).unbind("beforeunload.pageChange")),e.errorDialogOp=new $.dialog(o),e.errorDialogOp.bind("onclose",function(){$(window).unbind("beforeunload.pageChange")})},initUploader:function(){var t=this.vcop,e=this;t.authtoken?e.uploader=t.initUpload({access_token:t.authtoken,device_id:"test",uid:"test"},{onSuccess:function(t){if(t&&t.data){e.fileinfo=t.data;var i=e.fileinfo.file_size;if(i>1073741824)return void e.showError();e.renderDialog(),e.sartUpload()}},onError:function(t){e.showError(t&&t.msg?t.msg:"\u7f51\u7edc\u9519\u8bef")}}):t.getAuthNormal()},_showDialog:!1,renderDialog:function(){var t=this,e='<div class="v_upload_wrapper"><p class="v_upload_title">\u89c6\u9891\u4e0a\u4f20\u4e2d\uff0c\u8bf7\u4e0d\u8981\u5173\u95ed\u7a97\u53e3</p><div class="v_uploader_pro"><b class="j_progress"></b><span class="v_percent">0%</span><a href="#" class="v_control" data-type="uploading">\u6682\u505c</a></div><ul class="v_upload_info"><li style="width:156px"><span >\u901f\u5ea6\uff1a<span class="v_speed">0kb</span>/S</span></li><li style="width:195px">\u5df2\u4e0a\u4f20\uff1a<span class="v_finished">0MMB</span>/<span class="v_total">0MB</span></li><li><span>\u5269\u4f59\u65f6\u95f4\uff1a<span class="v_time">0</span>\u79d2</span></li></ul></div>';this.dContent=$(e);var i={html:this.dContent,title:"\u4e0a\u4f20\u89c6\u9891",width:540,height:114,modal:!1,closeable:!0};t.lDialogOp=new $.dialog(i),$(window).bind("beforeunload.pageChange",function(t){return t=t||window.event,t&&(t.returnValue="Any string"),"\u89c6\u9891\u6b63\u5728\u4e0a\u4f20\u4e2d\uff0c\u662f\u5426\u786e\u5b9a\u9000\u51fa\uff1f"}),$.browser.msie?this.dContent.find(".v_control").hide():this.dContent.delegate(".v_control","click",function(){var e=$(this),i=e.data("type");return"uploading"==i?(t.pauseUpload(),e.data("type","pause"),e.html("\u7ee7\u7eed")):(t.resumeUpload(),e.data("type","uploading"),e.html("\u6682\u505c")),!1}),t.lDialogOp.bind("onclose",function(){if(!t.success){var e=confirm("\u786e\u8ba4\u8981\u53d6\u6d88\u89c6\u9891\u4e0a\u4f20\u5417\uff1f");return 1==e?(t.cancelUpload(),$(window).unbind("beforeunload.pageChange"),t._showDialog=!1,!0):!1}t._showDialog=!1}),t.lDialogOp.show(),t._showDialog=!0},_MB:1048576,updateProgressBar:function(t){var e=this.dContent.find(".j_progress"),i=this.dContent.find(".v_percent"),o=this.dContent.find(".v_speed"),a=this.dContent.find(".v_time"),n=this.dContent.find(".v_total"),r=this.dContent.find(".v_finished"),s=this,l=t.total/1024,d=t.finished/1024;o.html(s.getFloorNum(t.speed,3)+"kb"),n.html(s.getFloorNum(l,2)+"MB"),r.html(s.getFloorNum(d,2)+"MB"),a.html(s.getFloorNum(t.remainTime,0)),i.html(t.percent+"%"),e.width(t.percent+"%")},getFloorNum:function(t,e){var i=t+"",o=i.split("."),a=o[0]+"";return o[1]&&e>0&&(a+="."+o[1].substr(0,e)),a},_addFile:{},sartUpload:function(){var t=this;t.startTime=(new Date).getTime(),t.success=!1,t.uploader.startUpload(t.fileinfo,{onFinish:function(e){e&&e.manualFinish===!0?t.uploader.finishUpload({onSuccess:function(){t.uploadSuccess()},onError:function(){t.showError()}}):t._addFile[t.fileinfo.file_id]||t.uploadSuccess()},onError:function(){t.showError()},onProgress:function(e){t.updateProgressBar(e)}})},uploadSuccess:function(){var t=this;t.success=!0,t.lDialogOp.close(),$(window).unbind("beforeunload.pageChange");var e=t.fileinfo.file_id;t._addFile[e]=e,setTimeout(function(){t.parent.trigger("insertvideo",{swf_url:"https://web.archive.org/web/20201117141157/http://www.iqiyi.com/src_"+e+".swf",html_url:"vsrc_"+e,pkey:"pkey_"+e,vpic:"vpic_"+e,html5:"null",vsrc:"vsrc_"+e})},100)},pauseUpload:function(){this.uploader.pauseUpload()},resumeUpload:function(){var t=this;t.uploader.resumeUpload({onFinish:function(){t.uploader.finishUpload({onSuccess:function(){t.uploadSuccess()},onError:function(){t.showError()}})},onError:function(){t.showError()},onProgress:function(e){t.updateProgressBar(e)}})},cancelUpload:function(){var t=this;t.uploader.cancelUpload({onSuccess:function(){},onError:function(){}})}}}),_.Module.define({path:"ueditor/widget/ueditor_video/ueditor_url_video",sub:{tempHTML:['<div style="padding:30px 0px 5px 30px" class="clearfix"><input type="text" class="v_layer_input form-control j_input" value="\u8bf7\u76f4\u63a5\u8f93\u5165\u89c6\u9891\u64ad\u653e\u9875\u5730\u5740"  ><a href="#" style="float:left;margin-left:5px;" class="btn_default btn_middle j_btn">\u63d2\u5165\u89c6\u9891</a></div>','<div  class="j_error_tip v_error_tip" style="display:none;padding-left:30px;line-height:22px;"></div>','<div style="color:#999;line-height:22px;padding:0 30px;" class="v_layer_text j_layer_text">\u76ee\u524d\u652f\u6301\u7231\u5947\u827a\u3001\u7f8e\u62cd\u3001\u4f18\u9177\u3001\u571f\u8c46\u3001\u641c\u72d0\u3001\u817e\u8baf\u3001\u4e50\u89c6\u3001ACFUN\u3001Bilibili\u7b49\u89c6\u9891\u7f51\u7ad9\u94fe\u63a5</div>'].join(""),_defaultHtml:"\u76ee\u524d\u652f\u6301\u7231\u5947\u827a\u3001\u7f8e\u62cd\u3001\u4f18\u9177\u3001\u571f\u8c46\u3001\u641c\u72d0\u3001\u817e\u8baf\u3001\u4e50\u89c6\u3001ACFUN\u3001Bilibili\u7b49\u89c6\u9891\u7f51\u7ad9\u94fe\u63a5",initial:function(t){t=$.extend({},t),this.parent=t.parent,this.urlLength=t.urlLength||1024;var e={convert_urls:[[/https:\/\/web.archive.org\/web\/20201117141157\/http:\/\/my\.tv\.sohu\.com\/u\/vw\/([0-9a-zA-Z_]*)$/gi,"https://web.archive.org/web/20201117141157/http://my.tv.sohu.com/fo/v4/$1/my.swf"],[/https:\/\/web.archive.org\/web\/20201117141157\/http:\/\/tv\.sohu\.com\/([0-9a-zA-Z_]*)\/([0-9a-zA-Z_]*)\.shtml$/gi,"https://web.archive.org/web/20201117141157/http://api.tv.sohu.com/url/$1/$2.shtml"],[/https:\/\/web.archive.org\/web\/20201117141157\/http:\/\/client\.joy\.cn\/flvplayer\/([0-9a-zA-Z]*)_([0-9]*)_[1-9]*_([0-9]*)\.swf$/gi,"https://web.archive.org/web/20201117141157/http://client.joy.cn/flvplayer/$1_$2_0_$3.swf"],[/https:\/\/web.archive.org\/web\/20201117141157\/http:\/\/www\.56\.com\/u([0-9]*)\/v_([0-9a-zA-Z_]*)\.html$/gi,"https://web.archive.org/web/20201117141157/http://player.56.com/v_$2.swf"],[/https:\/\/web.archive.org\/web\/20201117141157\/http:\/\/www\.56\.com\/w([0-9]*)\/play_album-aid-([0-9]*)_vid-([0-9a-zA-Z_]*)\.html$/gi,"https://web.archive.org/web/20201117141157/http://player.56.com/v_$3.swf"],[/https:\/\/web.archive.org\/web\/20201117141157\/http:\/\/www\.letv\.com\/ptv\/vplay\/([0-9a-zA-Z_]*)(\.html)?$/gi,"https://web.archive.org/web/20201117141157/http://www.letv.com/player/share/baidu/x$1.swf"],[/https:\/\/web.archive.org\/web\/20201117141157\/http:\/\/www\.letv\.com\/player\/x([0-9a-zA-Z_]*)\.swf$/gi,"https://web.archive.org/web/20201117141157/http://www.letv.com/player/share/baidu/x$1.swf"],[/https:\/\/web.archive.org\/web\/20201117141157\/http:\/\/www\.aipai\.com\/([a-z]*)([0-9]*)\/([0-9a-zA-Z]*)\.html$/gi,"https://web.archive.org/web/20201117141157/http://www.aipai.com/$1$2/$3/playerOut.swf"],[/https:\/\/web.archive.org\/web\/20201117141157\/http:\/\/mv\.molihe\.com\/show\/([0-9]*)$/gi,"https://web.archive.org/web/20201117141157/http://mv.molihe.com/molihe_play-1-$1.swf"],[/https:\/\/web.archive.org\/web\/20201117141157\/http:\/\/www\.tudou\.com\/programs\/view\/([0-9a-zA-Z]*)\/?$/gi,"https://web.archive.org/web/20201117141157/http://www.tudou.com/v/$1/v.swf"],[/https:\/\/web.archive.org\/web\/20201117141157\/http:\/\/www\.boosj\.com\/([0-9]*)\.html$/gi,"https://web.archive.org/web/20201117141157/http://static.boosj.com/v/swf/w_player1.0_$1.swf"],[/http:\/\/([0-9a-zA-Z_]*)\.kankanews\.com\/vods\/([0-9a-zA-Z_]*)\/([0-9a-zA-Z_]*)(\/)?$/gi,"https://web.archive.org/web/20201117141157/http://www.kankanews.com/object/kankanewsplayer-tieba.swf?autoPlay=false&streamType=recorded&mutiDynamicStreamPlay=true&cid=$2&vid=$3&server=http://www.kankanews.com/dataservice/&otherLink=true&bufferTime=4"],[/https:\/\/web.archive.org\/web\/20201117141157\/http:\/\/www\.kankanews\.com\/object\/kankanewsplayer([0-9a-zA-Z\-\.]*)\.swf/gi,"https://web.archive.org/web/20201117141157/http://www.kankanews.com/object/kankanewsplayer3.0.swf"],[/https:\/\/web.archive.org\/web\/20201117141157\/http:\/\/www\.m1905\.com\/video\/play\/([0-9]*)\.shtml$/gi,"https://web.archive.org/web/20201117141157/http://www.m1905.com/video/s/$1/v.swf?autoplay=0"],[/https:\/\/web.archive.org\/web\/20201117141157\/http:\/\/www\.m1905\.com\/video\/m\/([0-9]*)\/v\.swf/gi,"https://web.archive.org/web/20201117141157/http://www.m1905.com/video/s/$1/v.swf?autoplay=0"],[/https:\/\/web.archive.org\/web\/20201117141157\/http:\/\/v\.ifeng\.com\/news\/([0-9a-zA-Z_\-]*)\/([0-9]{6})\/([0-9a-zA-Z_\-]*)\.shtml/gi,"https://web.archive.org/web/20201117141157/http://v.ifeng.com/include/exterior.swf?guid=$3&AutoPlay=false"],[/https:\/\/web.archive.org\/web\/20201117141157\/http:\/\/s\.v\.ifeng\.com\/([0-9a-zA-Z_\-]*)\/([0-9a-zA-Z_\-]*)/gi,"https://web.archive.org/web/20201117141157/http://s.v.ifeng.com/tieba/$1/$2.swf"],[/(http:\/\/share\.vrs\.sohu\.com\/[0-9a-zA-Z_]*\/v\.swf)(\S*)(&xuid\s*)$/gi,"$1&autoplay=false$3"],[/https:\/\/web.archive.org\/web\/20201117141157\/http:\/\/v\.youku\.com\/v_show\/id_([0-9a-zA-Z_]+)\.html/gi,"https://web.archive.org/web/20201117141157/http://player.youku.com/player.php/sid/$1/v.swf"],[/https:\/\/web.archive.org\/web\/20201117141157\/http:\/\/www\.tudou\.com\/programs\/view\/([0-9a-zA-Z]*)\/?$/gi,"https://web.archive.org/web/20201117141157/http://www.tudou.com/v/$1/v.swf"],[/https:\/\/web.archive.org\/web\/20201117141157\/http:\/\/v\.ku6\.com\/show\/([0-9a-zA-Z_\.&\?]+).html/gi,"https://web.archive.org/web/20201117141157/http://player.ku6.com/refer/$1/v.swf"],[/https:\/\/web.archive.org\/web\/20201117141157\/http:\/\/v\.ku6\.com\/special\/([0-9a-zA-Z_\.&\?]+).html/gi,"https://web.archive.org/web/20201117141157/http://player.ku6.com/refer/$1/v.swf"],[/https:\/\/web.archive.org\/web\/20201117141157\/http:\/\/www\.56\.com\/u([0-9a-zA-Z_]+)\/([0-9a-zA-Z_\.&\?]+).html/gi,"https://web.archive.org/web/20201117141157/http://player.56.com/$2.swf"],[/(http:\/\/www\.cutv\.com\/static\/player\/v\.swf\?(id|pid|video)=[0-9a-zA-Z_\/\:\-\%\.]*)(\S*)$/gi,"$1&autoplay=false"]],mp4_url:[],convertToMp4:function(t){for(var e=this.mp4_url,i=t,o=0;o<e.length;o++)t=t.replace(e[o][0],e[o][1]);return t==i&&(t=""),t},auto_params:[["client.joy.cn","playstatus",/playstatus=/gi,"0"],["//web.archive.org/web/20201117141157/https://v.ifeng.com","AutoPlay",/AutoPlay=/gi,"false"],["m1905.com","autoplay",/autoplay=/gi,"0"],["kankanews.com","otherLink",/otherLink=/gi,"false"]],convert:function(t){for(var e=this.convert_urls,i=0;i<e.length;i++)t=t.replace(e[i][0],e[i][1]);return t},filter_param:function(t){t.indexOf("share.vrs.sohu.com")<0&&(t=t.replace(/(\&)?\w*auto\w*=[\w\d]+/gi,""));for(var e=this.auto_params,i=0;i<e.length;i++){var o=e[i];t.indexOf(o[0])>-1&&(t=t.replace(o[2],"old_invalid="),t+=(t.indexOf("?")>-1?"&":"?")+o[1]+"="+o[3])}return t}};this.Post_Video_URL=e},init:function(t,e){var i=this;t.addClass("url_video_container"),t.html(this.tempHTML),this.j_input=t.find(".j_input"),this.j_con=t,this.editor=e,this.j_error_tip=t.find(".j_error_tip"),this.j_layer_text=t.find(".j_layer_text"),this.j_btn=t.find(".j_btn"),this.j_btn.click(function(t){t.preventDefault(),t.stopPropagation(),i.accept()}),this.bindInput()},destroy:function(){this.j_con=null},onBlurInput:function(){var t=this.j_input[0],e=this;""==t.value?(t.value="\u8bf7\u76f4\u63a5\u8f93\u5165\u89c6\u9891\u64ad\u653e\u9875\u5730\u5740",t.style.color="#ccc",this.j_error_tip.hide()):"\u8bf7\u76f4\u63a5\u8f93\u5165\u89c6\u9891\u64ad\u653e\u9875\u5730\u5740"!=t.value&&e.inputTip()},insertFlash:function(t,e,i,o){var a=this;a.getVideoInfo(t,e);var n=(this.editor,a.videoInfo);return n&&n.swf_url?(this.parent.trigger("insertvideo",{swf_url:n.swf_url||"null",html_url:n.html_url||"null",pkey:n.pri_key||"null",vpic:n.img_url||"null",html5:n.html5||"null"}),"html"==o&&$.stats.sendRequest("fr=tb0_forum&st_mod=editor&st_type=htmlUrl&st_value=1"),"tdswf"==o&&$.stats.sendRequest("fr=tb0_forum&st_mod=editor&st_type=tdswfUrl&st_value=1"),!0):(0==e&&this.showError(i),!1)},bindInput:function(){var t=this.j_input,e=this;t.keyup(function(t){var i=t||window.event;86==i.keyCode&&e.inputTip()}),t.bind("input",function(){return""==this.value||"\u8bf7\u76f4\u63a5\u8f93\u5165\u89c6\u9891\u64ad\u653e\u9875\u5730\u5740"==this.value?(e.showError(e._defaultHtml,"#999999"),!0):(e.inputTip(),!0)}),t.bind("propertychange",function(){return""==this.value||"\u8bf7\u76f4\u63a5\u8f93\u5165\u89c6\u9891\u64ad\u653e\u9875\u5730\u5740"==this.value?(e.showError(e._defaultHtml,"#999999"),!0):(e.inputTip(),!0)}),this.j_input.blur(function(){e.onBlurInput()}),this.j_input.click(function(){e.onClickInput(),this.focus()})},showError:function(t,e){this.j_layer_text.html(t),e=e?e:"#ff0000",this.j_layer_text.css({color:e}),this.j_layer_text.show()},inputTip:function(){var t=this.j_input,e=this,i=t.val().trim();i=e.formatUrl(i);var o=e.checkInApi(i),a=e.checkType(i);return"illegal"==a?void e.showError("\u8f93\u5165\u94fe\u63a5\u6709\u8bef\uff0c\u8bf7\u91cd\u8bd5"):o&&"swf"==a?void e.showError("\u63d0\u793a\uff1a\u8be5\u89c6\u9891\u683c\u5f0f\u65e0\u6cd5\u5728\u624b\u673a\u6216pad\u4e0a\u64ad\u653e\u54e6~\u8bf7\u7c98\u8d34\u5176\u4ed6\u7c7b\u578b\u94fe\u63a5\u5730\u5740\u5427\u3002"):o||"html"!=a?void e.showError(e._defaultHtml,"#999999"):void e.showError("\u63d0\u793a\uff1a\u8d34\u5427\u6682\u4e0d\u652f\u6301\u8be5\u7f51\u7ad9\u7684\u64ad\u653e\u9875\u5730\u5740\uff0c\u8bf7\u76f4\u63a5\u4f7f\u7528\u89c6\u9891\u5730\u5740\u3002")},onClickInput:function(){var t=this.j_input[0];"\u8bf7\u76f4\u63a5\u8f93\u5165\u89c6\u9891\u64ad\u653e\u9875\u5730\u5740"==t.value&&(t.value="",t.style.color="#000000")},IE:!(!window.attachEvent||window.opera),validAddrPrefixs:["https://web.archive.org/web/20201117141157/http://img.ku6.com/common/V2.0.baidu.swf?vid=","https://web.archive.org/web/20201117141157/http://www.tudou.com/v/","https://web.archive.org/web/20201117141157/http://www.tudou.com/player/playlist.swf?lid=","https://web.archive.org/web/20201117141157/http://www.56.com/","https://web.archive.org/web/20201117141157/http://player.youku.com/","https://web.archive.org/web/20201117141157/http://6.cn/","https://web.archive.org/web/20201117141157/http://player.ku6.com/refer/","https://web.archive.org/web/20201117141157/http://tv.mofile.com/cn/xplayer.swf?v=","https://web.archive.org/web/20201117141157/http://v.blog.sohu.com/fo/v4/","https://web.archive.org/web/20201117141157/http://v.blog.sohu.com/fo/p4/","https://web.archive.org/web/20201117141157/http://vhead.blog.sina.com.cn/player/outer_player.swf?","https://web.archive.org/web/20201117141157/http://img.openv.tv/hd/swf/hd_player.swf?pid=","https://web.archive.org/web/20201117141157/http://www.cnboo.com/flash/player.swf?ids=","https://web.archive.org/web/20201117141157/http://video.pomoho.com/swf/out_player.swf?flvid=","https://web.archive.org/web/20201117141157/http://video.cctv.com/flash/cctv_player.swf?VideoID=","https://web.archive.org/web/20201117141157/http://misc.home.news.cn/video/swf/VideoDisplay.swf?videoSource=","https://web.archive.org/web/20201117141157/http://mv.baidu.com/export/flashplayer.swf?playlist=","https://web.archive.org/web/20201117141157/http://mv.baidu.com/export/flashplayer.swf?vid=","https://web.archive.org/web/20201117141157/http://client.joy.cn/flvplayer/","https://web.archive.org/web/20201117141157/http://www.meipai.com/","https://web.archive.org/web/20201117141157/http://baishi.baidu.com/","https://web.archive.org/web/20201117141157/http://www.acfun.tv","https://web.archive.org/web/20201117141157/http://www.bilibili.com","https://web.archive.org/web/20201117141157/http://bangumi.bilibili.com"],accept:function(){$.stats.hive("videoByLayer_insert"),this.editor,PosterContext.getAuthorities().white_list?PosterContext.getAuthorities().white_list:this.validAddrPrefixs;var t=this,e=(t.Post_Video_URL,t.formatUrl($.trim(t.j_input.val()))),i=t.checkInApi(e),o=t.checkType(e),a=e.toLowerCase();if(a.length<=0||"https://"==a||"http://"==a||"ftp://"==a||"rtsp://"==a||"mms://"==a)return this.showError("\u89c6\u9891\u94fe\u63a5\u4e0d\u80fd\u4e3a\u7a7a"),!1;if(e.getByteLength()>this.urlLength||"illegal"==o)return t.showError("\u8f93\u5165\u94fe\u63a5\u6709\u8bef\uff0c\u8bf7\u91cd\u8bd5"),!1;if(!i&&"html"==o)return void t.showError("\u63d0\u793a\uff1a\u8d34\u5427\u6682\u4e0d\u652f\u6301\u8be5\u7f51\u7ad9\u7684\u64ad\u653e\u9875\u5730\u5740\uff0c\u8bf7\u76f4\u63a5\u4f7f\u7528\u89c6\u9891\u5730\u5740\u3002");if(!i||"html"!=o)return t.showError("\u63d0\u793a\uff1a\u8be5\u89c6\u9891\u683c\u5f0f\u65e0\u6cd5\u5728\u624b\u673a\u6216pad\u4e0a\u64ad\u653e\u54e6~\u8bf7\u7c98\u8d34\u5176\u4ed6\u7c7b\u578b\u94fe\u63a5\u5730\u5740\u5427\u3002"),!1;var n=t.insertFlash(e,0,"\u5bf9\u4e0d\u8d77\uff0c\u60a8\u8f93\u5165\u7684\u89c6\u9891\u64ad\u653e\u9875\u94fe\u63a5\u65e0\u6548\uff0c\u8bf7\u91cd\u8bd5","html");return n?($.stats.sendRequest("fr=tb0_forum&st_mod=editor&st_type=videoByLayer&st_value=1"),!1):($.stats.sendRequest("fr=tb0_forum&st_mod=editor&st_type=htmlFail&st_value=1"),!1)},isRever:function(t){for(var e=["youku.com","tudou.com"],i=0,o=e.length;o>i;i++)if(-1!=t.search(e[i]))return!0;return!1},getVideoInfo:function(t,e){var i=this;$.ajax({url:"/f/commit/commonapi/getVideoInfoApi",data:{url:t,type:e},type:"post",dataType:"json",success:function(t){0==t.no&&(i.videoInfo=t.data)},async:!1})},formatUrl:function(t){var e=t.replace(/^http:\/\/http:\/\//g,"http://"),i=/^(https:\/\/|http:\/\/|ftp:\/\/|rtsp:\/\/|mms:\/\/)/;return i.test(e.toLowerCase())||(e="http://"+e),e},checkType:function(t){var e=/(\.xml|\.jpg|\.jpeg|\.bmp|\.png|\.gif|\.tif)$/;return e.test(t)?"illegal":(e=/\.swf/,e.test(t)?"swf":"html")},checkInApi:function(t){for(var e=["youku.com","tudou.com","qiyi.com","letv.com","56.com","ifeng.com","ku6.com","qq.com","sohu.com","sina.com.cn","funshion.com","yinyuetai.com","v.pps.tv","ipd.pps.tv","aipai.com","mgtv.com","meipai.com","baishi.baidu.com","acfun.tv","bilibili.com"],i=0,o=e.length;o>i;i++)if(-1!=t.search(e[i]))return!0;return!1}}});try{var CryptoJS=CryptoJS||function(t,e){var i={},o=i.lib={},a=function(){},n=o.Base={extend:function(t){a.prototype=this;var e=new a;return t&&e.mixIn(t),e.hasOwnProperty("init")||(e.init=function(){e.$super.init.apply(this,arguments)}),e.init.prototype=e,e.$super=this,e},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},r=o.WordArray=n.extend({init:function(t,i){t=this.words=t||[],this.sigBytes=i!=e?i:4*t.length},toString:function(t){return(t||l).stringify(this)},concat:function(t){var e=this.words,i=t.words,o=this.sigBytes;if(t=t.sigBytes,this.clamp(),o%4)for(var a=0;t>a;a++)e[o+a>>>2]|=(i[a>>>2]>>>24-8*(a%4)&255)<<24-8*((o+a)%4);else if(65535<i.length)for(a=0;t>a;a+=4)e[o+a>>>2]=i[a>>>2];else e.push.apply(e,i);return this.sigBytes+=t,this},clamp:function(){var e=this.words,i=this.sigBytes;e[i>>>2]&=4294967295<<32-8*(i%4),e.length=t.ceil(i/4)},clone:function(){var t=n.clone.call(this);return t.words=this.words.slice(0),t},random:function(e){for(var i=[],o=0;e>o;o+=4)i.push(4294967296*t.random()|0);return new r.init(i,e)}}),s=i.enc={},l=s.Hex={stringify:function(t){var e=t.words;t=t.sigBytes;for(var i=[],o=0;t>o;o++){var a=e[o>>>2]>>>24-8*(o%4)&255;i.push((a>>>4).toString(16)),i.push((15&a).toString(16))}return i.join("")},parse:function(t){for(var e=t.length,i=[],o=0;e>o;o+=2)i[o>>>3]|=parseInt(t.substr(o,2),16)<<24-4*(o%8);return new r.init(i,e/2)}},d=s.Latin1={stringify:function(t){var e=t.words;t=t.sigBytes;for(var i=[],o=0;t>o;o++)i.push(String.fromCharCode(e[o>>>2]>>>24-8*(o%4)&255));return i.join("")},parse:function(t){for(var e=t.length,i=[],o=0;e>o;o++)i[o>>>2]|=(255&t.charCodeAt(o))<<24-8*(o%4);return new r.init(i,e)}},c=s.Utf8={stringify:function(t){try{return decodeURIComponent(escape(d.stringify(t)))}catch(e){throw Error("Malformed UTF-8 data")}},parse:function(t){return d.parse(unescape(encodeURIComponent(t)))}},p=o.BufferedBlockAlgorithm=n.extend({reset:function(){this._data=new r.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=c.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(e){var i=this._data,o=i.words,a=i.sigBytes,n=this.blockSize,s=a/(4*n),s=e?t.ceil(s):t.max((0|s)-this._minBufferSize,0);if(e=s*n,a=t.min(4*e,a),e){for(var l=0;e>l;l+=n)this._doProcessBlock(o,l);l=o.splice(0,e),i.sigBytes-=a}return new r.init(l,a)},clone:function(){var t=n.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0});o.Hasher=p.extend({cfg:n.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){p.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(e,i){return new t.init(i).finalize(e)}},_createHmacHelper:function(t){return function(e,i){return new h.HMAC.init(t,i).finalize(e)}}});var h=i.algo={};return i}(Math);!function(t){function e(t,e,i,o,a,n,r){return t=t+(e&i|~e&o)+a+r,(t<<n|t>>>32-n)+e}function i(t,e,i,o,a,n,r){return t=t+(e&o|i&~o)+a+r,(t<<n|t>>>32-n)+e}function o(t,e,i,o,a,n,r){return t=t+(e^i^o)+a+r,(t<<n|t>>>32-n)+e}function a(t,e,i,o,a,n,r){return t=t+(i^(e|~o))+a+r,(t<<n|t>>>32-n)+e}for(var n=CryptoJS,r=n.lib,s=r.WordArray,l=r.Hasher,r=n.algo,d=[],c=0;64>c;c++)d[c]=4294967296*t.abs(t.sin(c+1))|0;r=r.MD5=l.extend({_doReset:function(){this._hash=new s.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(t,n){for(var r=0;16>r;r++){var s=n+r,l=t[s];t[s]=16711935&(l<<8|l>>>24)|4278255360&(l<<24|l>>>8)}var r=this._hash.words,s=t[n+0],l=t[n+1],c=t[n+2],p=t[n+3],h=t[n+4],u=t[n+5],v=t[n+6],m=t[n+7],f=t[n+8],g=t[n+9],w=t[n+10],b=t[n+11],_=t[n+12],y=t[n+13],x=t[n+14],D=t[n+15],k=r[0],$=r[1],C=r[2],M=r[3],k=e(k,$,C,M,s,7,d[0]),M=e(M,k,$,C,l,12,d[1]),C=e(C,M,k,$,c,17,d[2]),$=e($,C,M,k,p,22,d[3]),k=e(k,$,C,M,h,7,d[4]),M=e(M,k,$,C,u,12,d[5]),C=e(C,M,k,$,v,17,d[6]),$=e($,C,M,k,m,22,d[7]),k=e(k,$,C,M,f,7,d[8]),M=e(M,k,$,C,g,12,d[9]),C=e(C,M,k,$,w,17,d[10]),$=e($,C,M,k,b,22,d[11]),k=e(k,$,C,M,_,7,d[12]),M=e(M,k,$,C,y,12,d[13]),C=e(C,M,k,$,x,17,d[14]),$=e($,C,M,k,D,22,d[15]),k=i(k,$,C,M,l,5,d[16]),M=i(M,k,$,C,v,9,d[17]),C=i(C,M,k,$,b,14,d[18]),$=i($,C,M,k,s,20,d[19]),k=i(k,$,C,M,u,5,d[20]),M=i(M,k,$,C,w,9,d[21]),C=i(C,M,k,$,D,14,d[22]),$=i($,C,M,k,h,20,d[23]),k=i(k,$,C,M,g,5,d[24]),M=i(M,k,$,C,x,9,d[25]),C=i(C,M,k,$,p,14,d[26]),$=i($,C,M,k,f,20,d[27]),k=i(k,$,C,M,y,5,d[28]),M=i(M,k,$,C,c,9,d[29]),C=i(C,M,k,$,m,14,d[30]),$=i($,C,M,k,_,20,d[31]),k=o(k,$,C,M,u,4,d[32]),M=o(M,k,$,C,f,11,d[33]),C=o(C,M,k,$,b,16,d[34]),$=o($,C,M,k,x,23,d[35]),k=o(k,$,C,M,l,4,d[36]),M=o(M,k,$,C,h,11,d[37]),C=o(C,M,k,$,m,16,d[38]),$=o($,C,M,k,w,23,d[39]),k=o(k,$,C,M,y,4,d[40]),M=o(M,k,$,C,s,11,d[41]),C=o(C,M,k,$,p,16,d[42]),$=o($,C,M,k,v,23,d[43]),k=o(k,$,C,M,g,4,d[44]),M=o(M,k,$,C,_,11,d[45]),C=o(C,M,k,$,D,16,d[46]),$=o($,C,M,k,c,23,d[47]),k=a(k,$,C,M,s,6,d[48]),M=a(M,k,$,C,m,10,d[49]),C=a(C,M,k,$,x,15,d[50]),$=a($,C,M,k,u,21,d[51]),k=a(k,$,C,M,_,6,d[52]),M=a(M,k,$,C,p,10,d[53]),C=a(C,M,k,$,w,15,d[54]),$=a($,C,M,k,l,21,d[55]),k=a(k,$,C,M,f,6,d[56]),M=a(M,k,$,C,D,10,d[57]),C=a(C,M,k,$,v,15,d[58]),$=a($,C,M,k,y,21,d[59]),k=a(k,$,C,M,h,6,d[60]),M=a(M,k,$,C,b,10,d[61]),C=a(C,M,k,$,c,15,d[62]),$=a($,C,M,k,g,21,d[63]);r[0]=r[0]+k|0,r[1]=r[1]+$|0,r[2]=r[2]+C|0,r[3]=r[3]+M|0},_doFinalize:function(){var e=this._data,i=e.words,o=8*this._nDataBytes,a=8*e.sigBytes;i[a>>>5]|=128<<24-a%32;var n=t.floor(o/4294967296);for(i[(a+64>>>9<<4)+15]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),i[(a+64>>>9<<4)+14]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),e.sigBytes=4*(i.length+1),this._process(),e=this._hash,i=e.words,o=0;4>o;o++)a=i[o],i[o]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8);return e},clone:function(){var t=l.clone.call(this);return t._hash=this._hash.clone(),t}}),n.MD5=l._createHelper(r),n.HmacMD5=l._createHmacHelper(r)}(Math),!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.Cropper=e()}(this,function(){"use strict";function t(t){return se.call(t).slice(8,-1).toLowerCase()}function e(t){return"number"==typeof t&&!isNaN(t)}function i(t){return"undefined"==typeof t}function o(t){return"object"===("undefined"==typeof t?"undefined":Z(t))&&null!==t}function a(t){if(!o(t))return!1;try{var e=t.constructor,i=e.prototype;return e&&i&&le.call(i,"isPrototypeOf")}catch(a){return!1}}function n(e){return"function"===t(e)}function r(e){return Array.isArray?Array.isArray(e):"array"===t(e)}function s(t){return"string"==typeof t&&(t=t.trim?t.trim():t.replace(ie,"$1")),t}function l(t,i){if(t&&n(i)){var a=void 0;if(r(t)||e(t.length)){var s=t.length;for(a=0;s>a&&i.call(t,t[a],a,t)!==!1;a++);}else o(t)&&Object.keys(t).forEach(function(e){i.call(t,t[e],e,t)})}return t}function d(t){for(var e=arguments.length,i=Array(e>1?e-1:0),a=1;e>a;a++)i[a-1]=arguments[a];if(o(t)&&i.length>0){if(Object.assign)return Object.assign.apply(Object,[t].concat(i));i.forEach(function(e){o(e)&&Object.keys(e).forEach(function(i){t[i]=e[i]})})}return t}function c(t,e){for(var i=arguments.length,o=Array(i>2?i-2:0),a=2;i>a;a++)o[a-2]=arguments[a];return function(){for(var i=arguments.length,a=Array(i),n=0;i>n;n++)a[n]=arguments[n];return t.apply(e,o.concat(a))}}function p(t,i){var o=t.style;l(i,function(t,i){ee.test(i)&&e(t)&&(t+="px"),o[i]=t})}function h(t,e){return t.classList?t.classList.contains(e):t.className.indexOf(e)>-1}function u(t,i){if(i){if(e(t.length))return void l(t,function(t){u(t,i)});if(t.classList)return void t.classList.add(i);var o=s(t.className);o?o.indexOf(i)<0&&(t.className=o+" "+i):t.className=i}}function v(t,i){return i?e(t.length)?void l(t,function(t){v(t,i)}):t.classList?void t.classList.remove(i):void(t.className.indexOf(i)>=0&&(t.className=t.className.replace(i,""))):void 0}function m(t,i,o){return i?e(t.length)?void l(t,function(t){m(t,i,o)}):void(o?u(t,i):v(t,i)):void 0}function f(t){return t.replace(K,"$1-$2").toLowerCase()}function g(t,e){return o(t[e])?t[e]:t.dataset?t.dataset[e]:t.getAttribute("data-"+f(e))}function w(t,e,i){o(i)?t[e]=i:t.dataset?t.dataset[e]=i:t.setAttribute("data-"+f(e),i)}function b(t,e){if(o(t[e]))delete t[e];else if(t.dataset)try{delete t.dataset[e]}catch(i){t.dataset[e]=null}else t.removeAttribute("data-"+f(e))}function _(t,e,i){var o=s(e).split(te);return o.length>1?void l(o,function(e){_(t,e,i)}):void(t.removeEventListener?t.removeEventListener(e,i,!1):t.detachEvent&&t.detachEvent("on"+e,i))}function y(t,e,i,o){var a=s(e).split(te),n=i;return a.length>1?void l(a,function(e){y(t,e,i)}):(o&&(i=function(){for(var o=arguments.length,a=Array(o),r=0;o>r;r++)a[r]=arguments[r];return _(t,e,i),n.apply(t,a)}),void(t.addEventListener?t.addEventListener(e,i,!1):t.attachEvent&&t.attachEvent("on"+e,i)))}function x(t,e,o){if(t.dispatchEvent){var a=void 0;return n(Event)&&n(CustomEvent)?a=i(o)?new Event(e,{bubbles:!0,cancelable:!0}):new CustomEvent(e,{detail:o,bubbles:!0,cancelable:!0}):i(o)?(a=document.createEvent("Event"),a.initEvent(e,!0,!0)):(a=document.createEvent("CustomEvent"),a.initCustomEvent(e,!0,!0,o)),t.dispatchEvent(a)}return t.fireEvent?t.fireEvent("on"+e):!0}function D(t){var i=t||window.event;if(i.target||(i.target=i.srcElement||document),!e(i.pageX)&&e(i.clientX)){var o=t.target.ownerDocument||document,a=o.documentElement,n=o.body;i.pageX=i.clientX+((a&&a.scrollLeft||n&&n.scrollLeft||0)-(a&&a.clientLeft||n&&n.clientLeft||0)),i.pageY=i.clientY+((a&&a.scrollTop||n&&n.scrollTop||0)-(a&&a.clientTop||n&&n.clientTop||0))}return i}function k(t){var e=document.documentElement,i=t.getBoundingClientRect();return{left:i.left+((window.scrollX||e&&e.scrollLeft||0)-(e&&e.clientLeft||0)),top:i.top+((window.scrollY||e&&e.scrollTop||0)-(e&&e.clientTop||0))}}function $(t,e){return t.getElementsByTagName(e)}function C(t,e){return t.getElementsByClassName?t.getElementsByClassName(e):t.querySelectorAll("."+e)}function M(t){return document.createElement(t)}function B(t,e){t.appendChild(e)}function P(t){t.parentNode&&t.parentNode.removeChild(t)}function T(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function E(t){var e=t.match(Q);return e&&(e[1]!==location.protocol||e[2]!==location.hostname||e[3]!==location.port)}function A(t){var e="timestamp="+(new Date).getTime();return t+(-1===t.indexOf("?")?"?":"&")+e}function S(t,e){if(t.naturalWidth&&!ne)return void e(t.naturalWidth,t.naturalHeight);var i=M("img");i.onload=function(){e(this.width,this.height)},i.src=t.src}function j(t){var i=[],o=t.translateX,a=t.translateY,n=t.rotate,r=t.scaleX,s=t.scaleY;e(o)&&0!==o&&i.push("translateX("+o+"px)"),e(a)&&0!==a&&i.push("translateY("+a+"px)"),e(n)&&0!==n&&i.push("rotate("+n+"deg)"),e(r)&&1!==r&&i.push("scaleX("+r+")"),e(s)&&1!==s&&i.push("scaleY("+s+")");var l=i.length?i.join(" "):"none";return{WebkitTransform:l,msTransform:l,transform:l}}function z(t,e){var i=Math.abs(t.degree)%180,o=(i>90?180-i:i)*Math.PI/180,a=Math.sin(o),n=Math.cos(o),r=t.width,s=t.height,l=t.aspectRatio,d=void 0,c=void 0;return e?(d=r/(n+a/l),c=d/l):(d=r*n+s*a,c=r*a+s*n),{width:d,height:c}}function L(t,i){var o=M("canvas"),a=o.getContext("2d"),n=0,r=0,s=i.naturalWidth,l=i.naturalHeight,d=i.rotate,c=i.scaleX,p=i.scaleY,h=e(c)&&e(p)&&(1!==c||1!==p),u=e(d)&&0!==d,v=u||h,m=s*Math.abs(c||1),f=l*Math.abs(p||1),g=void 0,w=void 0,b=void 0;return h&&(g=m/2,w=f/2),u&&(b=z({width:m,height:f,degree:d}),m=b.width,f=b.height,g=m/2,w=f/2),o.width=m,o.height=f,v&&(n=-s/2,r=-l/2,a.save(),a.translate(g,w)),u&&a.rotate(d*Math.PI/180),h&&a.scale(c,p),a.drawImage(t,Math.floor(n),Math.floor(r),Math.floor(s),Math.floor(l)),v&&a.restore(),o}function U(t,e,i){var o="",a=e;for(i+=e;i>a;a++)o+=de(t.getUint8(a));return o}function F(t){var e=new DataView(t),i=e.byteLength,o=void 0,a=void 0,n=void 0,r=void 0,s=void 0,l=void 0,d=void 0,c=void 0,p=void 0,h=void 0;if(255===e.getUint8(0)&&216===e.getUint8(1))for(p=2;i>p;){if(255===e.getUint8(p)&&225===e.getUint8(p+1)){d=p;break}p++}if(d&&(a=d+4,n=d+10,"Exif"===U(e,a,4)&&(l=e.getUint16(n),s=18761===l,(s||19789===l)&&42===e.getUint16(n+2,s)&&(r=e.getUint32(n+4,s),r>=8&&(c=n+r)))),c)for(i=e.getUint16(c,s),h=0;i>h;h++)if(p=c+12*h+2,274===e.getUint16(p,s)){p+=8,o=e.getUint16(p,s),ne&&e.setUint16(p,1,s);break}return o}function I(t){var e=t.replace(J,"");e=e.replace(G,"");var i=window.atob(e),o=i.length,a=new ArrayBuffer(o),n=new Uint8Array(a),r=void 0;for(r=0;o>r;r++)n[r]=i.charCodeAt(r);return a}function O(t){var e=new Uint8Array(t),i=e.length,o="",a=void 0;for(a=0;i>a;a++)o+=de(e[a]);return"data:image/jpeg;base64,"+btoa(o)}function R(t,e){var i=t.pageX,o=t.pageY,a={endX:i,endY:o};return e?a:d({startX:i,startY:o},a)}function H(t){var e=d({},t),i=[];return l(t,function(t,o){delete e[o],l(e,function(e){var o=Math.abs(t.startX-e.startX),a=Math.abs(t.startY-e.startY),n=Math.abs(t.endX-e.endX),r=Math.abs(t.endY-e.endY),s=Math.sqrt(o*o+a*a),l=Math.sqrt(n*n+r*r),d=(l-s)/s;i.push(d)})}),i.sort(function(t,e){return Math.abs(t)<Math.abs(e)}),i[0]}function W(t){var e=0,i=0,o=0;return l(t,function(t){var a=t.startX,n=t.startY;e+=a,i+=n,o+=1}),e/=o,i/=o,{pageX:e,pageY:i}}var N={viewMode:0,dragMode:"crop",aspectRatio:0/0,data:null,preview:"",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:200,minContainerHeight:100,ready:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},V='<div class="cropper-container"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-action="e"></span><span class="cropper-line line-n" data-action="n"></span><span class="cropper-line line-w" data-action="w"></span><span class="cropper-line line-s" data-action="s"></span><span class="cropper-point point-e" data-action="e"></span><span class="cropper-point point-n" data-action="n"></span><span class="cropper-point point-w" data-action="w"></span><span class="cropper-point point-s" data-action="s"></span><span class="cropper-point point-ne" data-action="ne"></span><span class="cropper-point point-nw" data-action="nw"></span><span class="cropper-point point-sw" data-action="sw"></span><span class="cropper-point point-se" data-action="se"></span></div></div>',Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t
}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},X=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},Y=function(){function t(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),q=function(t){if(Array.isArray(t)){for(var e=0,i=Array(t.length);e<t.length;e++)i[e]=t[e];return i}return Array.from(t)},J=/^data:.*,/,G=/\s/g,K=/([a-z\d])([A-Z])/g,Q=/^(https?:)\/\/([^:\/?#]+):?(\d*)/i,te=/\s+/,ee=/^(width|height|left|top|marginLeft|marginTop)$/,ie=/^\s+(.*)\s+$/,oe=/(Macintosh|iPhone|iPod|iPad).*AppleWebKit/i,ae="undefined"!=typeof window?window.navigator:null,ne=ae&&oe.test(ae.userAgent),re=Object.prototype,se=re.toString,le=re.hasOwnProperty,de=(Array.prototype.slice,String.fromCharCode),ce={render:function(){var t=this;t.initContainer(),t.initCanvas(),t.initCropBox(),t.renderCanvas(),t.cropped&&t.renderCropBox()},initContainer:function(){var t=this,e=t.options,i=t.element,o=t.container,a=t.cropper,n="cropper-hidden",r=void 0;u(a,n),v(i,n),t.containerData=r={width:Math.max(o.offsetWidth,Number(e.minContainerWidth)||200),height:Math.max(o.offsetHeight,Number(e.minContainerHeight)||100)},p(a,{width:r.width,height:r.height}),u(i,n),v(a,n)},initCanvas:function(){var t=this,e=t.options.viewMode,i=t.containerData,o=t.imageData,a=90===Math.abs(o.rotate),n=a?o.naturalHeight:o.naturalWidth,r=a?o.naturalWidth:o.naturalHeight,s=n/r,l=i.width,c=i.height;i.height*s>i.width?3===e?l=i.height*s:c=i.width/s:3===e?c=i.width/s:l=i.height*s;var p={naturalWidth:n,naturalHeight:r,aspectRatio:s,width:l,height:c};p.oldLeft=p.left=(i.width-l)/2,p.oldTop=p.top=(i.height-c)/2,t.canvasData=p,t.limited=1===e||2===e,t.limitCanvas(!0,!0),t.initialImageData=d({},o),t.initialCanvasData=d({},p)},limitCanvas:function(t,e){var i=this,o=i.options,a=o.viewMode,n=i.containerData,r=i.canvasData,s=r.aspectRatio,l=i.cropBoxData,d=i.cropped&&l;if(t){var c=Number(o.minCanvasWidth)||0,p=Number(o.minCanvasHeight)||0;a>1?(c=Math.max(c,n.width),p=Math.max(p,n.height),3===a&&(p*s>c?c=p*s:p=c/s)):a>0&&(c?c=Math.max(c,d?l.width:0):p?p=Math.max(p,d?l.height:0):d&&(c=l.width,p=l.height,p*s>c?c=p*s:p=c/s)),c&&p?p*s>c?p=c/s:c=p*s:c?p=c/s:p&&(c=p*s),r.minWidth=c,r.minHeight=p,r.maxWidth=1/0,r.maxHeight=1/0}if(e)if(a){var h=n.width-r.width,u=n.height-r.height;r.minLeft=Math.min(0,h),r.minTop=Math.min(0,u),r.maxLeft=Math.max(0,h),r.maxTop=Math.max(0,u),d&&i.limited&&(r.minLeft=Math.min(l.left,l.left+(l.width-r.width)),r.minTop=Math.min(l.top,l.top+(l.height-r.height)),r.maxLeft=l.left,r.maxTop=l.top,2===a&&(r.width>=n.width&&(r.minLeft=Math.min(0,h),r.maxLeft=Math.max(0,h)),r.height>=n.height&&(r.minTop=Math.min(0,u),r.maxTop=Math.max(0,u))))}else r.minLeft=-r.width,r.minTop=-r.height,r.maxLeft=n.width,r.maxTop=n.height},renderCanvas:function(t){var e=this,i=e.canvasData,o=e.imageData,a=o.rotate;if(e.rotated){e.rotated=!1;var n=z({width:o.width,height:o.height,degree:a}),r=n.width/n.height,s=1===o.aspectRatio;if(s||r!==i.aspectRatio){if(i.left-=(n.width-i.width)/2,i.top-=(n.height-i.height)/2,i.width=n.width,i.height=n.height,i.aspectRatio=r,i.naturalWidth=o.naturalWidth,i.naturalHeight=o.naturalHeight,s&&a%90||a%180){var l=z({width:o.naturalWidth,height:o.naturalHeight,degree:a});i.naturalWidth=l.width,i.naturalHeight=l.height}e.limitCanvas(!0,!1)}}(i.width>i.maxWidth||i.width<i.minWidth)&&(i.left=i.oldLeft),(i.height>i.maxHeight||i.height<i.minHeight)&&(i.top=i.oldTop),i.width=Math.min(Math.max(i.width,i.minWidth),i.maxWidth),i.height=Math.min(Math.max(i.height,i.minHeight),i.maxHeight),e.limitCanvas(!1,!0),i.oldLeft=i.left=Math.min(Math.max(i.left,i.minLeft),i.maxLeft),i.oldTop=i.top=Math.min(Math.max(i.top,i.minTop),i.maxTop),p(e.canvas,d({width:i.width,height:i.height},j({translateX:i.left,translateY:i.top}))),e.renderImage(),e.cropped&&e.limited&&e.limitCropBox(!0,!0),t&&e.output()},renderImage:function(t){var e=this,i=e.canvasData,o=e.imageData,a=void 0,n=void 0,r=void 0,s=void 0;o.rotate&&(n=z({width:i.width,height:i.height,degree:o.rotate,aspectRatio:o.aspectRatio},!0),r=n.width,s=n.height,a={width:r,height:s,left:(i.width-r)/2,top:(i.height-s)/2}),d(o,a||{width:i.width,height:i.height,left:0,top:0}),p(e.image,d({width:o.width,height:o.height},j(d({translateX:o.left,translateY:o.top},o)))),t&&e.output()},initCropBox:function(){var t=this,e=t.options,i=e.aspectRatio,o=Number(e.autoCropArea)||.8,a=t.canvasData,n={width:a.width,height:a.height};i&&(a.height*i>a.width?n.height=n.width/i:n.width=n.height*i),t.cropBoxData=n,t.limitCropBox(!0,!0),n.width=Math.min(Math.max(n.width,n.minWidth),n.maxWidth),n.height=Math.min(Math.max(n.height,n.minHeight),n.maxHeight),n.width=Math.max(n.minWidth,n.width*o),n.height=Math.max(n.minHeight,n.height*o),n.oldLeft=n.left=a.left+(a.width-n.width)/2,n.oldTop=n.top=a.top+(a.height-n.height)/2,t.initialCropBoxData=d({},n)},limitCropBox:function(t,e){var i=this,o=i.options,a=o.aspectRatio,n=i.containerData,r=i.canvasData,s=i.cropBoxData,l=i.limited;if(t){var d=Number(o.minCropBoxWidth)||0,c=Number(o.minCropBoxHeight)||0,p=Math.min(n.width,l?r.width:n.width),h=Math.min(n.height,l?r.height:n.height);d=Math.min(d,n.width),c=Math.min(c,n.height),a&&(d&&c?c*a>d?c=d/a:d=c*a:d?c=d/a:c&&(d=c*a),h*a>p?h=p/a:p=h*a),s.minWidth=Math.min(d,p),s.minHeight=Math.min(c,h),s.maxWidth=p,s.maxHeight=h}e&&(l?(s.minLeft=Math.max(0,r.left),s.minTop=Math.max(0,r.top),s.maxLeft=Math.min(n.width,r.left+r.width)-s.width,s.maxTop=Math.min(n.height,r.top+r.height)-s.height):(s.minLeft=0,s.minTop=0,s.maxLeft=n.width-s.width,s.maxTop=n.height-s.height))},renderCropBox:function(){var t=this,e=t.options,i=t.containerData,o=t.cropBoxData;(o.width>o.maxWidth||o.width<o.minWidth)&&(o.left=o.oldLeft),(o.height>o.maxHeight||o.height<o.minHeight)&&(o.top=o.oldTop),o.width=Math.min(Math.max(o.width,o.minWidth),o.maxWidth),o.height=Math.min(Math.max(o.height,o.minHeight),o.maxHeight),t.limitCropBox(!1,!0),o.oldLeft=o.left=Math.min(Math.max(o.left,o.minLeft),o.maxLeft),o.oldTop=o.top=Math.min(Math.max(o.top,o.minTop),o.maxTop),e.movable&&e.cropBoxMovable&&w(t.face,"action",o.width===i.width&&o.height===i.height?"move":"all"),p(t.cropBox,d({width:o.width,height:o.height},j({translateX:o.left,translateY:o.top}))),t.cropped&&t.limited&&t.limitCanvas(!0,!0),t.disabled||t.output()},output:function(){var t=this;t.preview(),t.complete&&x(t.element,"crop",t.getData())}},pe="preview",he={initPreview:function(){var t=this,e=t.options.preview,i=M("img"),o=t.crossOrigin,a=o?t.crossOriginUrl:t.url;if(o&&(i.crossOrigin=o),i.src=a,B(t.viewBox,i),t.image2=i,e){var n=e.querySelector?[e]:document.querySelectorAll(e);t.previews=n,l(n,function(t){var e=M("img");console.log("preview will show"),w(t,pe,{width:t.offsetWidth,height:t.offsetHeight,html:t.innerHTML}),o&&(e.crossOrigin=o),e.src=a,e.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"',T(t),B(t,e)})}},resetPreview:function(){l(this.previews,function(t){var e=g(t,pe);p(t,{width:e.width,height:e.height}),t.innerHTML=e.html,b(t,pe)})},preview:function(){var t=this,e=t.imageData,i=t.canvasData,o=t.cropBoxData,a=o.width,n=o.height,r=e.width,s=e.height,c=o.left-i.left-e.left,h=o.top-i.top-e.top;t.cropped&&!t.disabled&&(p(t.image2,d({width:r,height:s},j(d({translateX:-c,translateY:-h},e)))),l(t.previews,function(t){var i=g(t,pe),o=i.width,l=i.height,u=o,v=l,m=1;a&&(m=o/a,v=n*m),n&&v>l&&(m=l/n,u=a*m,v=l),p(t,{width:u,height:v}),p($(t,"img")[0],d({width:r*m,height:s*m},j(d({translateX:-c*m,translateY:-h*m},e))))}))}},ue="undefined"!=typeof window?window.PointerEvent:null,ve=ue?"pointerdown":"touchstart mousedown",me=ue?"pointermove":"touchmove mousemove",fe=ue?" pointerup pointercancel":"touchend touchcancel mouseup",ge="wheel mousewheel DOMMouseScroll",we="dblclick",be="resize",_e="cropstart",ye="cropmove",xe="cropend",De="crop",ke="zoom",$e={bind:function(){var t=this,e=t.options,i=t.element,o=t.cropper;n(e.cropstart)&&y(i,_e,e.cropstart),n(e.cropmove)&&y(i,ye,e.cropmove),n(e.cropend)&&y(i,xe,e.cropend),n(e.crop)&&y(i,De,e.crop),n(e.zoom)&&y(i,ke,e.zoom),y(o,ve,t.onCropStart=c(t.cropStart,t)),e.zoomable&&e.zoomOnWheel&&y(o,ge,t.onWheel=c(t.wheel,t)),e.toggleDragModeOnDblclick&&y(o,we,t.onDblclick=c(t.dblclick,t)),y(document,me,t.onCropMove=c(t.cropMove,t)),y(document,fe,t.onCropEnd=c(t.cropEnd,t)),e.responsive&&y(window,be,t.onResize=c(t.resize,t))},unbind:function(){var t=this,e=t.options,i=t.element,o=t.cropper;n(e.cropstart)&&_(i,_e,e.cropstart),n(e.cropmove)&&_(i,ye,e.cropmove),n(e.cropend)&&_(i,xe,e.cropend),n(e.crop)&&_(i,De,e.crop),n(e.zoom)&&_(i,ke,e.zoom),_(o,ve,t.onCropStart),e.zoomable&&e.zoomOnWheel&&_(o,ge,t.onWheel),e.toggleDragModeOnDblclick&&_(o,we,t.onDblclick),_(document,me,t.onCropMove),_(document,fe,t.onCropEnd),e.responsive&&_(window,be,t.onResize)}},Ce=/^(e|w|s|n|se|sw|ne|nw|all|crop|move|zoom)$/,Me={resize:function(){var t=this,e=t.options.restore,i=t.container,o=t.containerData;if(!t.disabled&&o){var a=i.offsetWidth/o.width,n=void 0,r=void 0;(1!==a||i.offsetHeight!==o.height)&&(e&&(n=t.getCanvasData(),r=t.getCropBoxData()),t.render(),e&&(t.setCanvasData(l(n,function(t,e){n[e]=t*a})),t.setCropBoxData(l(r,function(t,e){r[e]=t*a}))))}},dblclick:function(){var t=this;t.disabled||t.setDragMode(h(t.dragBox,"cropper-crop")?"move":"crop")},wheel:function(t){var e=this,i=D(t),o=Number(e.options.wheelZoomRatio)||.1,a=1;e.disabled||(i.preventDefault(),e.wheeling||(e.wheeling=!0,setTimeout(function(){e.wheeling=!1},50),i.deltaY?a=i.deltaY>0?1:-1:i.wheelDelta?a=-i.wheelDelta/120:i.detail&&(a=i.detail>0?1:-1),e.zoom(-a*o,i)))},cropStart:function(t){var e=this;if(!e.disabled){var i=e.options,o=e.pointers,a=D(t),n=void 0;if(a.changedTouches?l(a.changedTouches,function(t){o[t.identifier]=R(t)}):o[a.pointerId||0]=R(a),n=Object.keys(o).length>1&&i.zoomable&&i.zoomOnTouch?"zoom":g(a.target,"action"),Ce.test(n)){if(x(e.element,"cropstart",{originalEvent:a,action:n})===!1)return;a.preventDefault(),e.action=n,e.cropping=!1,"crop"===n&&(e.cropping=!0,u(e.dragBox,"cropper-modal"))}}},cropMove:function(t){var e=this,i=e.action;if(!e.disabled&&i){var o=e.pointers,a=D(t);a.preventDefault(),x(e.element,"cropmove",{originalEvent:a,action:i})!==!1&&(a.changedTouches?l(a.changedTouches,function(t){d(o[t.identifier],R(t,!0))}):d(o[a.pointerId||0],R(a,!0)),e.change(a))}},cropEnd:function(t){var e=this,i=e.action;if(!e.disabled&&i){var o=e.pointers,a=D(t);a.preventDefault(),a.changedTouches?l(a.changedTouches,function(t){delete o[t.identifier]}):delete o[a.pointerId||0],Object.keys(o).length||(e.action=""),e.cropping&&(e.cropping=!1,m(e.dragBox,"cropper-modal",e.cropped&&this.options.modal)),x(e.element,"cropend",{originalEvent:a,action:i})}}},Be="e",Pe="w",Te="s",Ee="n",Ae="se",Se="sw",je="ne",ze="nw",Le={change:function(t){var e=this,i=e.options,o=e.containerData,a=e.canvasData,n=e.cropBoxData,r=i.aspectRatio,s=e.action,d=n.width,c=n.height,p=n.left,h=n.top,u=p+d,m=h+c,f=0,g=0,w=o.width,b=o.height,_=!0,y=void 0;!r&&t.shiftKey&&(r=d&&c?d/c:1),e.limited&&(f=n.minLeft,g=n.minTop,w=f+Math.min(o.width,a.width,a.left+a.width),b=g+Math.min(o.height,a.height,a.top+a.height));var x=e.pointers,D=x[Object.keys(x)[0]],$={x:D.endX-D.startX,y:D.endY-D.startY};switch(r&&($.X=$.y*r,$.Y=$.x/r),s){case"all":p+=$.x,h+=$.y;break;case Be:if($.x>=0&&(u>=w||r&&(g>=h||m>=b))){_=!1;break}d+=$.x,r&&(c=d/r,h-=$.Y/2),0>d&&(s=Pe,d=0);break;case Ee:if($.y<=0&&(g>=h||r&&(f>=p||u>=w))){_=!1;break}c-=$.y,h+=$.y,r&&(d=c*r,p+=$.X/2),0>c&&(s=Te,c=0);break;case Pe:if($.x<=0&&(f>=p||r&&(g>=h||m>=b))){_=!1;break}d-=$.x,p+=$.x,r&&(c=d/r,h+=$.Y/2),0>d&&(s=Be,d=0);break;case Te:if($.y>=0&&(m>=b||r&&(f>=p||u>=w))){_=!1;break}c+=$.y,r&&(d=c*r,p-=$.X/2),0>c&&(s=Ee,c=0);break;case je:if(r){if($.y<=0&&(g>=h||u>=w)){_=!1;break}c-=$.y,h+=$.y,d=c*r}else $.x>=0?w>u?d+=$.x:$.y<=0&&g>=h&&(_=!1):d+=$.x,$.y<=0?h>g&&(c-=$.y,h+=$.y):(c-=$.y,h+=$.y);0>d&&0>c?(s=Se,c=0,d=0):0>d?(s=ze,d=0):0>c&&(s=Ae,c=0);break;case ze:if(r){if($.y<=0&&(g>=h||f>=p)){_=!1;break}c-=$.y,h+=$.y,d=c*r,p+=$.X}else $.x<=0?p>f?(d-=$.x,p+=$.x):$.y<=0&&g>=h&&(_=!1):(d-=$.x,p+=$.x),$.y<=0?h>g&&(c-=$.y,h+=$.y):(c-=$.y,h+=$.y);0>d&&0>c?(s=Ae,c=0,d=0):0>d?(s=je,d=0):0>c&&(s=Se,c=0);break;case Se:if(r){if($.x<=0&&(f>=p||m>=b)){_=!1;break}d-=$.x,p+=$.x,c=d/r}else $.x<=0?p>f?(d-=$.x,p+=$.x):$.y>=0&&m>=b&&(_=!1):(d-=$.x,p+=$.x),$.y>=0?b>m&&(c+=$.y):c+=$.y;0>d&&0>c?(s=je,c=0,d=0):0>d?(s=Ae,d=0):0>c&&(s=ze,c=0);break;case Ae:if(r){if($.x>=0&&(u>=w||m>=b)){_=!1;break}d+=$.x,c=d/r}else $.x>=0?w>u?d+=$.x:$.y>=0&&m>=b&&(_=!1):d+=$.x,$.y>=0?b>m&&(c+=$.y):c+=$.y;0>d&&0>c?(s=ze,c=0,d=0):0>d?(s=Se,d=0):0>c&&(s=je,c=0);break;case"move":e.move($.x,$.y),_=!1;break;case"zoom":e.zoom(H(x),t),_=!1;break;case"crop":if(!$.x||!$.y){_=!1;break}y=k(e.cropper),p=D.startX-y.left,h=D.startY-y.top,d=n.minWidth,c=n.minHeight,$.x>0?s=$.y>0?Ae:je:$.x<0&&(p-=d,s=$.y>0?Se:ze),$.y<0&&(h-=c),e.cropped||(v(e.cropBox,"cropper-hidden"),e.cropped=!0,e.limited&&e.limitCropBox(!0,!0))}_&&(n.width=d,n.height=c,n.left=p,n.top=h,e.action=s,e.renderCropBox()),l(x,function(t){t.startX=t.endX,t.startY=t.endY})}},Ue={crop:function(){var t=this;return t.ready&&!t.disabled&&(t.cropped||(t.cropped=!0,t.limitCropBox(!0,!0),t.options.modal&&u(t.dragBox,"cropper-modal"),v(t.cropBox,"cropper-hidden")),t.setCropBoxData(t.initialCropBoxData)),t},reset:function(){var t=this;return t.ready&&!t.disabled&&(t.imageData=d({},t.initialImageData),t.canvasData=d({},t.initialCanvasData),t.cropBoxData=d({},t.initialCropBoxData),t.renderCanvas(),t.cropped&&t.renderCropBox()),t},clear:function(){var t=this;return t.cropped&&!t.disabled&&(d(t.cropBoxData,{left:0,top:0,width:0,height:0}),t.cropped=!1,t.renderCropBox(),t.limitCanvas(),t.renderCanvas(),v(t.dragBox,"cropper-modal"),u(t.cropBox,"cropper-hidden")),t},replace:function(t,e){var i=this;return!i.disabled&&t&&(i.isImg&&(i.element.src=t),e?(i.url=t,i.image.src=t,i.ready&&(i.image2.src=t,l(i.previews,function(e){$(e,"img")[0].src=t}))):(i.isImg&&(i.replaced=!0),i.options.data=null,i.load(t))),i},enable:function(){var t=this;return t.ready&&(t.disabled=!1,v(t.cropper,"cropper-disabled")),t},disable:function(){var t=this;return t.ready&&(t.disabled=!0,u(t.cropper,"cropper-disabled")),t},destroy:function(){var t=this,e=t.element,i=t.image;return t.loaded?(t.isImg&&t.replaced&&(e.src=t.originalUrl),t.unbuild(),v(e,"cropper-hidden")):t.isImg?_(e,"load",t.onStart):i&&P(i),b(e,"cropper"),t},move:function(t,e){var o=this,a=o.canvasData;return o.moveTo(i(t)?t:a.left+Number(t),i(e)?e:a.top+Number(e))},moveTo:function(t,o){var a=this,n=a.canvasData,r=!1;return i(o)&&(o=t),t=Number(t),o=Number(o),a.ready&&!a.disabled&&a.options.movable&&(e(t)&&(n.left=t,r=!0),e(o)&&(n.top=o,r=!0),r&&a.renderCanvas(!0)),a},zoom:function(t,e){var i=this,o=i.canvasData;return t=Number(t),t=0>t?1/(1-t):1+t,i.zoomTo(o.width*t/o.naturalWidth,e)},zoomTo:function(t,e){var i=this,o=i.options,a=i.canvasData,n=a.width,r=a.height,s=a.naturalWidth,l=a.naturalHeight;if(t=Number(t),t>=0&&i.ready&&!i.disabled&&o.zoomable){var d=s*t,c=l*t;if(x(i.element,"zoom",{originalEvent:e,oldRatio:n/s,ratio:d/s})===!1)return i;if(e){var p=i.pointers,h=k(i.cropper),u=p&&Object.keys(p).length?W(p):{pageX:e.pageX,pageY:e.pageY};a.left-=(d-n)*((u.pageX-h.left-a.left)/n),a.top-=(c-r)*((u.pageY-h.top-a.top)/r)}else a.left-=(d-n)/2,a.top-=(c-r)/2;a.width=d,a.height=c,i.renderCanvas(!0)}return i},rotate:function(t){var e=this;return e.rotateTo((e.imageData.rotate||0)+Number(t))},rotateTo:function(t){var i=this;return t=Number(t),e(t)&&i.ready&&!i.disabled&&i.options.rotatable&&(i.imageData.rotate=t%360,i.rotated=!0,i.renderCanvas(!0)),i},scale:function(t,o){var a=this,n=a.imageData,r=!1;return i(o)&&(o=t),t=Number(t),o=Number(o),a.ready&&!a.disabled&&a.options.scalable&&(e(t)&&(n.scaleX=t,r=!0),e(o)&&(n.scaleY=o,r=!0),r&&a.renderImage(!0)),a},scaleX:function(t){var i=this,o=i.imageData.scaleY;return i.scale(t,e(o)?o:1)},scaleY:function(t){var i=this,o=i.imageData.scaleX;return i.scale(e(o)?o:1,t)},getData:function(t){var e=this,i=e.options,o=e.imageData,a=e.canvasData,n=e.cropBoxData,r=void 0,s=void 0;return e.ready&&e.cropped?(s={x:n.left-a.left,y:n.top-a.top,width:n.width,height:n.height},r=o.width/o.naturalWidth,l(s,function(e,i){e/=r,s[i]=t?Math.round(e):e})):s={x:0,y:0,width:0,height:0},i.rotatable&&(s.rotate=o.rotate||0),i.scalable&&(s.scaleX=o.scaleX||1,s.scaleY=o.scaleY||1),s},setData:function(t){var i=this,o=i.options,r=i.imageData,s=i.canvasData,l={},d=void 0,c=void 0,p=void 0;return n(t)&&(t=t.call(i.element)),i.ready&&!i.disabled&&a(t)&&(o.rotatable&&e(t.rotate)&&t.rotate!==r.rotate&&(r.rotate=t.rotate,i.rotated=d=!0),o.scalable&&(e(t.scaleX)&&t.scaleX!==r.scaleX&&(r.scaleX=t.scaleX,c=!0),e(t.scaleY)&&t.scaleY!==r.scaleY&&(r.scaleY=t.scaleY,c=!0)),d?i.renderCanvas():c&&i.renderImage(),p=r.width/r.naturalWidth,e(t.x)&&(l.left=t.x*p+s.left),e(t.y)&&(l.top=t.y*p+s.top),e(t.width)&&(l.width=t.width*p),e(t.height)&&(l.height=t.height*p),i.setCropBoxData(l)),i},getContainerData:function(){var t=this;return t.ready?t.containerData:{}},getImageData:function(){var t=this;return t.loaded?t.imageData:{}},getCanvasData:function(){var t=this,e=t.canvasData,i={};return t.ready&&l(["left","top","width","height","naturalWidth","naturalHeight"],function(t){i[t]=e[t]}),i},setCanvasData:function(t){var i=this,o=i.canvasData,r=o.aspectRatio;return n(t)&&(t=t.call(i.element)),i.ready&&!i.disabled&&a(t)&&(e(t.left)&&(o.left=t.left),e(t.top)&&(o.top=t.top),e(t.width)?(o.width=t.width,o.height=t.width/r):e(t.height)&&(o.height=t.height,o.width=t.height*r),i.renderCanvas(!0)),i},getCropBoxData:function(){var t=this,e=t.cropBoxData,i=void 0;return t.ready&&t.cropped&&(i={left:e.left,top:e.top,width:e.width,height:e.height}),i||{}},setCropBoxData:function(t){var i=this,o=i.cropBoxData,r=i.options.aspectRatio,s=void 0,l=void 0;return n(t)&&(t=t.call(i.element)),i.ready&&i.cropped&&!i.disabled&&a(t)&&(e(t.left)&&(o.left=t.left),e(t.top)&&(o.top=t.top),e(t.width)&&t.width!==o.width&&(s=!0,o.width=t.width),e(t.height)&&t.height!==o.height&&(l=!0,o.height=t.height),r&&(s?o.height=o.width/r:l&&(o.width=o.height*r)),i.renderCropBox()),i},getCroppedCanvas:function(t){var e=this;if(!e.ready||!window.HTMLCanvasElement)return null;if(!e.cropped)return L(e.image,e.imageData);a(t)||(t={});var i=e.getData(),o=i.width,n=i.height,r=o/n,s=void 0,l=void 0,d=void 0;a(t)&&(s=t.width,l=t.height,s?(l=s/r,d=s/o):l&&(s=l*r,d=l/n));var c=Math.floor(s||o),p=Math.floor(l||n),h=M("canvas"),u=h.getContext("2d");h.width=c,h.height=p,t.fillColor&&(u.fillStyle=t.fillColor,u.fillRect(0,0,c,p));var v=function(){var t=L(e.image,e.imageData),a=t.width,r=t.height,s=e.canvasData,l=[t],c=i.x+s.naturalWidth*(Math.abs(i.scaleX||1)-1)/2,p=i.y+s.naturalHeight*(Math.abs(i.scaleY||1)-1)/2,h=void 0,u=void 0,v=void 0,m=void 0,f=void 0,g=void 0;return-o>=c||c>a?c=h=v=f=0:0>=c?(v=-c,c=0,h=f=Math.min(a,o+c)):a>=c&&(v=0,h=f=Math.min(o,a-c)),0>=h||-n>=p||p>r?p=u=m=g=0:0>=p?(m=-p,p=0,u=g=Math.min(r,n+p)):r>=p&&(m=0,u=g=Math.min(n,r-p)),l.push(Math.floor(c),Math.floor(p),Math.floor(h),Math.floor(u)),d&&(v*=d,m*=d,f*=d,g*=d),f>0&&g>0&&l.push(Math.floor(v),Math.floor(m),Math.floor(f),Math.floor(g)),l}();return u.drawImage.apply(u,q(v)),h},setAspectRatio:function(t){var e=this,o=e.options;return e.disabled||i(t)||(o.aspectRatio=Math.max(0,t)||0/0,e.ready&&(e.initCropBox(),e.cropped&&e.renderCropBox())),e},setDragMode:function(t){var e=this,i=e.options,o=e.dragBox,a=e.face,n=void 0,r=void 0;return e.loaded&&!e.disabled&&(n="crop"===t,r=i.movable&&"move"===t,t=n||r?t:"none",w(o,"action",t),m(o,"cropper-crop",n),m(o,"cropper-move",r),i.cropBoxMovable||(w(a,"action",t),m(a,"cropper-crop",n),m(a,"cropper-move",r))),e}},Fe="cropper",Ie=Fe+"-hidden",Oe="error",Re="load",He="ready",We="crop",Ne=/^data:/,Ve=/^data:image\/jpeg;base64,/,Ze=void 0,Xe=function(){function t(e,i){X(this,t);var o=this;o.element=e,o.options=d({},N,a(i)&&i),o.loaded=!1,o.ready=!1,o.complete=!1,o.rotated=!1,o.cropped=!1,o.disabled=!1,o.replaced=!1,o.limited=!1,o.wheeling=!1,o.isImg=!1,o.originalUrl="",o.canvasData=null,o.cropBoxData=null,o.previews=null,o.pointers={},o.init()}return Y(t,[{key:"init",value:function(){var t=this,e=t.element,i=e.tagName.toLowerCase(),o=void 0;if(!g(e,Fe)){if(w(e,Fe,t),"img"===i){if(t.isImg=!0,t.originalUrl=o=e.getAttribute("src"),!o)return;o=e.src}else"canvas"===i&&window.HTMLCanvasElement&&(o=e.toDataURL());t.load(o)}}},{key:"load",value:function(t){var e=this,i=e.options,o=e.element;if(t){if(e.url=t,e.imageData={},!i.checkOrientation||!window.ArrayBuffer)return void e.clone();if(Ne.test(t))return void(Ve?e.read(I(t)):e.clone());var a=new XMLHttpRequest;a.onerror=a.onabort=function(){e.clone()},a.onload=function(){e.read(a.response)},i.checkCrossOrigin&&E(t)&&o.crossOrigin&&(t=A(t)),a.open("get",t),a.responseType="arraybuffer",a.withCredentials="use-credentials"===o.crossOrigin,a.send()}}},{key:"read",value:function(t){var e=this,i=e.options,o=F(t),a=e.imageData,n=0,r=1,s=1;if(o>1)switch(e.url=O(t),o){case 2:r=-1;break;case 3:n=-180;break;case 4:s=-1;break;case 5:n=90,s=-1;break;case 6:n=90;break;case 7:n=90,r=-1;break;case 8:n=-90}i.rotatable&&(a.rotate=n),i.scalable&&(a.scaleX=r,a.scaleY=s),e.clone()}},{key:"clone",value:function(){var t=this,e=t.element,i=t.url,o=void 0,a=void 0,n=void 0,r=void 0;t.options.checkCrossOrigin&&E(i)&&(o=e.crossOrigin,o?a=i:(o="anonymous",a=A(i))),t.crossOrigin=o,t.crossOriginUrl=a;var s=M("img");o&&(s.crossOrigin=o),s.src=a||i,t.image=s,t.onStart=n=c(t.start,t),t.onStop=r=c(t.stop,t),t.isImg?e.complete?t.start():y(e,Re,n):(y(s,Re,n),y(s,Oe,r),u(s,"cropper-hide"),e.parentNode.insertBefore(s,e.nextSibling))}},{key:"start",value:function(t){var e=this,i=e.isImg?e.element:e.image;t&&(_(i,Re,e.onStart),_(i,Oe,e.onStop)),S(i,function(t,i){d(e.imageData,{naturalWidth:t,naturalHeight:i,aspectRatio:t/i}),e.loaded=!0,e.build()})}},{key:"stop",value:function(){var t=this,e=t.image;_(e,Re,t.onStart),_(e,Oe,t.onStop),P(e),t.image=null}},{key:"build",value:function(){var t=this,e=t.options,i=t.element,o=t.image,a=void 0,r=void 0,s=void 0,l=void 0,d=void 0,c=void 0;if(t.loaded){t.ready&&t.unbuild();var p=M("div");p.innerHTML=V,t.container=a=i.parentNode,t.cropper=r=C(p,"cropper-container")[0],t.canvas=s=C(r,"cropper-canvas")[0],t.dragBox=l=C(r,"cropper-drag-box")[0],t.cropBox=d=C(r,"cropper-crop-box")[0],t.viewBox=C(r,"cropper-view-box")[0],t.face=c=C(d,"cropper-face")[0],B(s,o),u(i,Ie),a.insertBefore(r,i.nextSibling),t.isImg||v(o,"cropper-hide"),t.initPreview(),t.bind(),e.aspectRatio=Math.max(0,e.aspectRatio)||0/0,e.viewMode=Math.max(0,Math.min(3,Math.round(e.viewMode)))||0,t.cropped=e.autoCrop,e.autoCrop?e.modal&&u(l,"cropper-modal"):u(d,Ie),e.guides||u(C(d,"cropper-dashed"),Ie),e.center||u(C(d,"cropper-center"),Ie),e.background&&u(r,"cropper-bg"),e.highlight||u(c,"cropper-invisible"),e.cropBoxMovable&&(u(c,"cropper-move"),w(c,"action","all")),e.cropBoxResizable||(u(C(d,"cropper-line"),Ie),u(C(d,"cropper-point"),Ie)),t.setDragMode(e.dragMode),t.render(),t.ready=!0,t.setData(e.data),t.completing=setTimeout(function(){n(e.ready)&&y(i,He,e.ready,!0),x(i,He),x(i,We,t.getData()),t.complete=!0},0)}}},{key:"unbuild",value:function(){var t=this;t.ready&&(t.complete||clearTimeout(t.completing),t.ready=!1,t.complete=!1,t.initialImageData=null,t.initialCanvasData=null,t.initialCropBoxData=null,t.containerData=null,t.canvasData=null,t.cropBoxData=null,t.unbind(),t.resetPreview(),t.previews=null,t.viewBox=null,t.cropBox=null,t.dragBox=null,t.canvas=null,t.container=null,P(t.cropper),t.cropper=null)}}],[{key:"noConflict",value:function(){return window.Cropper=Ze,t}},{key:"setDefaults",value:function(t){d(N,a(t)&&t)}}]),t}();return d(Xe.prototype,ce),d(Xe.prototype,he),d(Xe.prototype,$e),d(Xe.prototype,Me),d(Xe.prototype,Le),d(Xe.prototype,Ue),"undefined"!=typeof window&&(Ze=window.Cropper,window.Cropper=Xe),Xe})}catch(err){}_.Module.define({path:"ueditor/widget/ueditor_video/ueditor_video_url_dialog",sub:{tempHTML:['<div style="padding:30px 0px 5px 30px" class="clearfix"><input type="text" class="v_layer_input form-control j_input" value="\u8bf7\u76f4\u63a5\u8f93\u5165\u89c6\u9891\u64ad\u653e\u9875\u5730\u5740"  ><a href="#" style="float:left;margin-left:5px;" class="btn_default btn_middle j_btn">\u63d2\u5165\u89c6\u9891</a></div>','<div  class="j_error_tip v_error_tip" style="display:none;padding-left:30px;line-height:22px;"></div>','<div style="color:#999;line-height:22px;padding:0 30px;" class="v_layer_text j_layer_text">\u76ee\u524d\u652f\u6301\u7231\u5947\u827a\u3001\u7f8e\u62cd\u3001\u4f18\u9177\u3001\u571f\u8c46\u3001\u641c\u72d0\u3001\u817e\u8baf\u3001\u4e50\u89c6\u3001ACFUN\u3001Bilibili\u7b49\u89c6\u9891\u7f51\u7ad9\u94fe\u63a5</div>'].join(""),mDialog:null,tempHTML:'<div class="video-poster-detail-url">\n	<table>\n		<tbody>\n			<tr>\n				<td class="td-title">\u64ad\u653e\u5730\u5740</td>\n				<td>\n					<input class="form-control video-poster-detail-url-src" video-poster-detail-url-src type="text" placeholder="\u8bf7\u8f93\u5165\u64ad\u653e\u5730\u5740">\n					\n					\n				</td>\n			</tr>\n			<tr>\n				<td class="td-title"></td>\n				<td>\n					<div class="video-poster-detail-url-src-errtip" video-poster-detail-url-src-errtip ></div>\n				</td>\n			</tr>\n			<tr>\n				<td class="td-title"></td>\n				<td>\n					<div class="video-poster-detail-url-src-subtitle" >		\n						\u76ee\u524d\u652f\u6301\u7231\u5947\u827a\u3001\u7f8e\u62cd\u3001\u4f18\u9177\u3001\u4e50\u89c6\u7b49\u89c6\u9891\u7f51\u7ad9\u94fe\u63a5\n					</div>\n				</td>\n			</tr>\n		</tbody>\n	</table>\n	<div class="video-poster-detail-url-btn-wrap"><button class="btn-default btn-large" video-poster-detail-url-src-btn >\u63d2\u5165</button></div>\n</div>',_defaultHtml:"\u76ee\u524d\u652f\u6301\u7231\u5947\u827a\u3001\u7f8e\u62cd\u3001\u4f18\u9177\u3001\u571f\u8c46\u3001\u641c\u72d0\u3001\u817e\u8baf\u3001\u4e50\u89c6\u3001ACFUN\u3001Bilibili\u7b49\u89c6\u9891\u7f51\u7ad9\u94fe\u63a5",initial:function(t){t=$.extend({},t),this.fuckCDN=!0,this.model=t.model,this.parent=t.parent,this.editor=t.editor,this.urlLength=t.urlLength||1024;var e={convert_urls:[[/https:\/\/web.archive.org\/web\/20201117141157\/http:\/\/my\.tv\.sohu\.com\/u\/vw\/([0-9a-zA-Z_]*)$/gi,"https://web.archive.org/web/20201117141157/http://my.tv.sohu.com/fo/v4/$1/my.swf"],[/https:\/\/web.archive.org\/web\/20201117141157\/http:\/\/tv\.sohu\.com\/([0-9a-zA-Z_]*)\/([0-9a-zA-Z_]*)\.shtml$/gi,"https://web.archive.org/web/20201117141157/http://api.tv.sohu.com/url/$1/$2.shtml"],[/https:\/\/web.archive.org\/web\/20201117141157\/http:\/\/client\.joy\.cn\/flvplayer\/([0-9a-zA-Z]*)_([0-9]*)_[1-9]*_([0-9]*)\.swf$/gi,"https://web.archive.org/web/20201117141157/http://client.joy.cn/flvplayer/$1_$2_0_$3.swf"],[/https:\/\/web.archive.org\/web\/20201117141157\/http:\/\/www\.56\.com\/u([0-9]*)\/v_([0-9a-zA-Z_]*)\.html$/gi,"https://web.archive.org/web/20201117141157/http://player.56.com/v_$2.swf"],[/https:\/\/web.archive.org\/web\/20201117141157\/http:\/\/www\.56\.com\/w([0-9]*)\/play_album-aid-([0-9]*)_vid-([0-9a-zA-Z_]*)\.html$/gi,"https://web.archive.org/web/20201117141157/http://player.56.com/v_$3.swf"],[/https:\/\/web.archive.org\/web\/20201117141157\/http:\/\/www\.le\.com\/ptv\/vplay\/([0-9a-zA-Z_]*)(\.html)?$/gi,"https://web.archive.org/web/20201117141157/http://www.le.com/player/share/baidu/x$1.swf"],[/https:\/\/web.archive.org\/web\/20201117141157\/http:\/\/www\.le\.com\/player\/x([0-9a-zA-Z_]*)\.swf$/gi,"https://web.archive.org/web/20201117141157/http://www.le.com/player/share/baidu/x$1.swf"],[/https:\/\/web.archive.org\/web\/20201117141157\/http:\/\/www\.aipai\.com\/([a-z]*)([0-9]*)\/([0-9a-zA-Z]*)\.html$/gi,"https://web.archive.org/web/20201117141157/http://www.aipai.com/$1$2/$3/playerOut.swf"],[/https:\/\/web.archive.org\/web\/20201117141157\/http:\/\/mv\.molihe\.com\/show\/([0-9]*)$/gi,"https://web.archive.org/web/20201117141157/http://mv.molihe.com/molihe_play-1-$1.swf"],[/https:\/\/web.archive.org\/web\/20201117141157\/http:\/\/www\.tudou\.com\/programs\/view\/([0-9a-zA-Z]*)\/?$/gi,"https://web.archive.org/web/20201117141157/http://www.tudou.com/v/$1/v.swf"],[/https:\/\/web.archive.org\/web\/20201117141157\/http:\/\/www\.boosj\.com\/([0-9]*)\.html$/gi,"https://web.archive.org/web/20201117141157/http://static.boosj.com/v/swf/w_player1.0_$1.swf"],[/http:\/\/([0-9a-zA-Z_]*)\.kankanews\.com\/vods\/([0-9a-zA-Z_]*)\/([0-9a-zA-Z_]*)(\/)?$/gi,"https://web.archive.org/web/20201117141157/http://www.kankanews.com/object/kankanewsplayer-tieba.swf?autoPlay=false&streamType=recorded&mutiDynamicStreamPlay=true&cid=$2&vid=$3&server=http://www.kankanews.com/dataservice/&otherLink=true&bufferTime=4"],[/https:\/\/web.archive.org\/web\/20201117141157\/http:\/\/www\.kankanews\.com\/object\/kankanewsplayer([0-9a-zA-Z\-\.]*)\.swf/gi,"https://web.archive.org/web/20201117141157/http://www.kankanews.com/object/kankanewsplayer3.0.swf"],[/https:\/\/web.archive.org\/web\/20201117141157\/http:\/\/www\.m1905\.com\/video\/play\/([0-9]*)\.shtml$/gi,"https://web.archive.org/web/20201117141157/http://www.m1905.com/video/s/$1/v.swf?autoplay=0"],[/https:\/\/web.archive.org\/web\/20201117141157\/http:\/\/www\.m1905\.com\/video\/m\/([0-9]*)\/v\.swf/gi,"https://web.archive.org/web/20201117141157/http://www.m1905.com/video/s/$1/v.swf?autoplay=0"],[/https:\/\/web.archive.org\/web\/20201117141157\/http:\/\/v\.ifeng\.com\/news\/([0-9a-zA-Z_\-]*)\/([0-9]{6})\/([0-9a-zA-Z_\-]*)\.shtml/gi,"https://web.archive.org/web/20201117141157/http://v.ifeng.com/include/exterior.swf?guid=$3&AutoPlay=false"],[/https:\/\/web.archive.org\/web\/20201117141157\/http:\/\/s\.v\.ifeng\.com\/([0-9a-zA-Z_\-]*)\/([0-9a-zA-Z_\-]*)/gi,"https://web.archive.org/web/20201117141157/http://s.v.ifeng.com/tieba/$1/$2.swf"],[/(http:\/\/share\.vrs\.sohu\.com\/[0-9a-zA-Z_]*\/v\.swf)(\S*)(&xuid\s*)$/gi,"$1&autoplay=false$3"],[/https:\/\/web.archive.org\/web\/20201117141157\/http:\/\/v\.youku\.com\/v_show\/id_([0-9a-zA-Z_]+)\.html/gi,"https://web.archive.org/web/20201117141157/http://player.youku.com/player.php/sid/$1/v.swf"],[/https:\/\/web.archive.org\/web\/20201117141157\/http:\/\/www\.tudou\.com\/programs\/view\/([0-9a-zA-Z]*)\/?$/gi,"https://web.archive.org/web/20201117141157/http://www.tudou.com/v/$1/v.swf"],[/https:\/\/web.archive.org\/web\/20201117141157\/http:\/\/v\.ku6\.com\/show\/([0-9a-zA-Z_\.&\?]+).html/gi,"https://web.archive.org/web/20201117141157/http://player.ku6.com/refer/$1/v.swf"],[/https:\/\/web.archive.org\/web\/20201117141157\/http:\/\/v\.ku6\.com\/special\/([0-9a-zA-Z_\.&\?]+).html/gi,"https://web.archive.org/web/20201117141157/http://player.ku6.com/refer/$1/v.swf"],[/https:\/\/web.archive.org\/web\/20201117141157\/http:\/\/www\.56\.com\/u([0-9a-zA-Z_]+)\/([0-9a-zA-Z_\.&\?]+).html/gi,"https://web.archive.org/web/20201117141157/http://player.56.com/$2.swf"],[/(http:\/\/www\.cutv\.com\/static\/player\/v\.swf\?(id|pid|video)=[0-9a-zA-Z_\/\:\-\%\.]*)(\S*)$/gi,"$1&autoplay=false"]],mp4_url:[],convertToMp4:function(t){for(var e=this.mp4_url,i=t,o=0;o<e.length;o++)t=t.replace(e[o][0],e[o][1]);return t==i&&(t=""),t},auto_params:[["client.joy.cn","playstatus",/playstatus=/gi,"0"],["//web.archive.org/web/20201117141157/https://v.ifeng.com","AutoPlay",/AutoPlay=/gi,"false"],["m1905.com","autoplay",/autoplay=/gi,"0"],["kankanews.com","otherLink",/otherLink=/gi,"false"]],convert:function(t){for(var e=this.convert_urls,i=0;i<e.length;i++)t=t.replace(e[i][0],e[i][1]);return t},filter_param:function(t){t.indexOf("share.vrs.sohu.com")<0&&(t=t.replace(/(\&)?\w*auto\w*=[\w\d]+/gi,""));for(var e=this.auto_params,i=0;i<e.length;i++){var o=e[i];t.indexOf(o[0])>-1&&(t=t.replace(o[2],"old_invalid="),t+=(t.indexOf("?")>-1?"&":"?")+o[1]+"="+o[3])}return t}};this.Post_Video_URL=e,this.init()},init:function(){var t=this;this.mDialog=new $.dialog({title:"\u63d2\u5165\u89c6\u9891\u5730\u5740",html:'<div class="video-poster" video-poster ></div>',width:550,height:160,show:!1,resizeable:!0,holderClassName:"video-poster-dialog"}),$template=$(t.tempHTML),this.mDialog.element.find("[video-poster]").html($template),this.mDialog.show(),this.$srcInput=this.mDialog.element.find("[video-poster-detail-url-src]"),this.$srcErrTip=this.mDialog.element.find("[video-poster-detail-url-src-errtip]"),this.$inserBtn=this.mDialog.element.find("[video-poster-detail-url-src-btn]"),this.bindEvent()},bindEvent:function(){var t=this;this.$inserBtn.click(function(e){e.preventDefault(),e.stopPropagation(),t.accept()}),this.$srcInput.on("keyup",function(){var e=t.$srcInput.val();t.inputTip(e)})},insertFlash:function(t,e,i,o){var a=this;a.getVideoInfo(t,e);var n=(this.editor,a.videoInfo);return n&&n.swf_url?(this.parent.trigger("insertvideo",{swf_url:n.swf_url||"null",html_url:n.html_url||"null",pkey:n.pri_key||"null",vpic:n.img_url||"null",html5:n.html5||"null"}),"html"==o&&$.stats.sendRequest("fr=tb0_forum&st_mod=editor&st_type=htmlUrl&st_value=1"),"tdswf"==o&&$.stats.sendRequest("fr=tb0_forum&st_mod=editor&st_type=tdswfUrl&st_value=1"),a.mDialog.close(),!0):(0==e&&this.showError(i),!1)},showError:function(t){this.$srcErrTip.html(t)},inputTip:function(t){var e=this,i=$.trim(t);i=e.formatUrl(i);var o=e.checkInApi(i),a=e.checkType(i);return"illegal"==a?void e.showError("\u8f93\u5165\u94fe\u63a5\u6709\u8bef\uff0c\u8bf7\u91cd\u8bd5"):o&&"swf"==a?void e.showError("\u63d0\u793a\uff1a\u8be5\u89c6\u9891\u683c\u5f0f\u65e0\u6cd5\u5728\u624b\u673a\u6216pad\u4e0a\u64ad\u653e\u54e6~\u8bf7\u7c98\u8d34\u5176\u4ed6\u7c7b\u578b\u94fe\u63a5\u5730\u5740\u5427\u3002"):o||"html"!=a?void 0:void e.showError("\u63d0\u793a\uff1a\u8d34\u5427\u6682\u4e0d\u652f\u6301\u8be5\u7f51\u7ad9\u7684\u64ad\u653e\u9875\u5730\u5740\uff0c\u8bf7\u76f4\u63a5\u4f7f\u7528\u89c6\u9891\u5730\u5740\u3002")
},IE:!(!window.attachEvent||window.opera),validAddrPrefixs:["https://web.archive.org/web/20201117141157/http://img.ku6.com/common/V2.0.baidu.swf?vid=","https://web.archive.org/web/20201117141157/http://www.tudou.com/v/","https://web.archive.org/web/20201117141157/http://www.tudou.com/player/playlist.swf?lid=","https://web.archive.org/web/20201117141157/http://www.56.com/","https://web.archive.org/web/20201117141157/http://player.youku.com/","https://web.archive.org/web/20201117141157/http://6.cn/","https://web.archive.org/web/20201117141157/http://player.ku6.com/refer/","https://web.archive.org/web/20201117141157/http://tv.mofile.com/cn/xplayer.swf?v=","https://web.archive.org/web/20201117141157/http://v.blog.sohu.com/fo/v4/","https://web.archive.org/web/20201117141157/http://v.blog.sohu.com/fo/p4/","https://web.archive.org/web/20201117141157/http://vhead.blog.sina.com.cn/player/outer_player.swf?","https://web.archive.org/web/20201117141157/http://img.openv.tv/hd/swf/hd_player.swf?pid=","https://web.archive.org/web/20201117141157/http://www.cnboo.com/flash/player.swf?ids=","https://web.archive.org/web/20201117141157/http://video.pomoho.com/swf/out_player.swf?flvid=","https://web.archive.org/web/20201117141157/http://video.cctv.com/flash/cctv_player.swf?VideoID=","https://web.archive.org/web/20201117141157/http://misc.home.news.cn/video/swf/VideoDisplay.swf?videoSource=","https://web.archive.org/web/20201117141157/http://mv.baidu.com/export/flashplayer.swf?playlist=","https://web.archive.org/web/20201117141157/http://mv.baidu.com/export/flashplayer.swf?vid=","https://web.archive.org/web/20201117141157/http://client.joy.cn/flvplayer/","https://web.archive.org/web/20201117141157/http://www.meipai.com/","https://web.archive.org/web/20201117141157/http://baishi.baidu.com/","https://web.archive.org/web/20201117141157/http://www.acfun.cn","https://web.archive.org/web/20201117141157/http://www.bilibili.com","https://web.archive.org/web/20201117141157/http://bangumi.bilibili.com"],accept:function(){$.stats.hive("videoByLayer_insert"),this.editor,PosterContext.getAuthorities().white_list?PosterContext.getAuthorities().white_list:this.validAddrPrefixs;var t=this,e=(t.Post_Video_URL,t.formatUrl($.trim(t.$srcInput.val()))),i=t.checkInApi(e),o=t.checkType(e),a=e.toLowerCase();if(a.length<=0||"https://"==a||"http://"==a||"ftp://"==a||"rtsp://"==a||"mms://"==a)return this.showError("\u89c6\u9891\u94fe\u63a5\u4e0d\u80fd\u4e3a\u7a7a"),!1;if(e.getByteLength()>this.urlLength||"illegal"==o)return t.showError("\u8f93\u5165\u94fe\u63a5\u6709\u8bef\uff0c\u8bf7\u91cd\u8bd5"),!1;if(!i&&"html"==o)return void t.showError("\u63d0\u793a\uff1a\u8d34\u5427\u6682\u4e0d\u652f\u6301\u8be5\u7f51\u7ad9\u7684\u64ad\u653e\u9875\u5730\u5740\uff0c\u8bf7\u76f4\u63a5\u4f7f\u7528\u89c6\u9891\u5730\u5740\u3002");if(!i||"html"!=o)return t.showError("\u63d0\u793a\uff1a\u8be5\u89c6\u9891\u683c\u5f0f\u65e0\u6cd5\u5728\u624b\u673a\u6216pad\u4e0a\u64ad\u653e\u54e6~\u8bf7\u7c98\u8d34\u5176\u4ed6\u7c7b\u578b\u94fe\u63a5\u5730\u5740\u5427\u3002"),!1;var n=t.insertFlash(e,0,"\u5bf9\u4e0d\u8d77\uff0c\u60a8\u8f93\u5165\u7684\u89c6\u9891\u64ad\u653e\u9875\u94fe\u63a5\u65e0\u6548\uff0c\u8bf7\u91cd\u8bd5","html");return n?($.stats.sendRequest("fr=tb0_forum&st_mod=editor&st_type=videoByLayer&st_value=1"),!1):($.stats.sendRequest("fr=tb0_forum&st_mod=editor&st_type=htmlFail&st_value=1"),!1)},isRever:function(t){for(var e=["youku.com","tudou.com"],i=0,o=e.length;o>i;i++)if(-1!=t.search(e[i]))return!0;return!1},getVideoInfo:function(t,e){var i=this;$.ajax({url:"/f/commit/commonapi/getVideoInfoApi",data:{url:t,type:e},type:"post",dataType:"json",success:function(t){0==t.no&&(i.videoInfo=t.data)},async:!1})},formatUrl:function(t){var e=t.replace(/^http:\/\/http:\/\//g,"http://"),i=/^(https:\/\/|http:\/\/|ftp:\/\/|rtsp:\/\/|mms:\/\/)/;return i.test(e.toLowerCase())||(e="http://"+e),e},checkType:function(t){var e=/(\.xml|\.jpg|\.jpeg|\.bmp|\.png|\.gif|\.tif)$/;return e.test(t)?"illegal":(e=/\.swf/,e.test(t)?"swf":"html")},checkInApi:function(t){for(var e=["youku.com","tudou.com","qiyi.com","le.com","56.com","ifeng.com","ku6.com","qq.com","sohu.com","sina.com.cn","funshion.com","yinyuetai.com","v.pps.tv","ipd.pps.tv","aipai.com","mgtv.com","meipai.com","baishi.baidu.com","acfun.cn","bilibili.com"],i=0,o=e.length;o>i;i++)if(-1!=t.search(e[i]))return!0;return!1}}}),_.Module.define({path:"ueditor/widget/scroll_horizontal",sub:{dom:null,$content:null,$scrollBar:null,$scrollButton:null,hasScroll:!1,scrollStep:50,_scrollLeft:0,maxWidth:0,initial:function(t){this.baiduUI(t),this.bindEvents(t),$(t.container).append(this.dom),this.setWidth(t.width||100),t.content&&this.setContent(t.content),t.scrollBarShow&&this.bind("onScrollBarShow",t.scrollBarShow),t.scrollBarHide&&this.bind("onScrollBarHide",t.scrollBarHide)},baiduUI:function(t){this.dom=$('<div class="scroll_horizontal_panel"></div>'),this.dom.html(['<div class="scroll_horizontal_content j_panel_content clearfix"><ul></ul></div>','<div class="scroll_horizontal_bar j_scroll_bar">','<div class="scroll_horizontal_button j_scroll_button">&nbsp;</div>',"</div>"].join("")),this.$content=this.dom.find(".j_panel_content:first"),this.$scrollBar=this.dom.find(".j_scroll_bar:first"),this.$scrollButton=this.dom.find(".j_scroll_button:first"),t.padding&&this.$content.css("padding",t.padding)},bindEvents:function(){var t=this,e=t.$content.get(0);this.$scrollButton.on("drag",function(i,o){if(o){var a=o.position;e.scrollLeft=a.left/t.$content.width()*e.scrollWidth}}),this.$content.mousewheel(function(e,i){e.preventDefault(),e.stopPropagation(),t.hasScroll&&t.scrollLeftTo(t._scrollLeft-i*t.scrollStep)})},scrollLeftTo:function(t){var e=this,i=e.$content.get(0),t=Math.max(Math.min(t,i.scrollWidth-e.$content.width()),0);t!=e._scrollLeft&&(e._scrollLeft=t,e.$content.stop(),e.$content.scrollLeft(e._scrollLeft),e.resizeScroll())},setWidth:function(t){this.maxWidth=t,this.resizeWidth(),this.resizeScroll(),this.$scrollButton.draggable({containment:"parent"})},setContent:function(t){this.$content.html(t),this.$content.get(0).scrollLeft=this._scrollLeft=0,this.resizeWidth(),this.resizeScroll()},appendContent:function(t){this.$content.append(t),this.resizeWidth(),this.scrollLeftTo(2e4)},clearContent:function(){this.setContent("")},resizeWidth:function(){this.$content.css("width","");var t=this.$content.get(0),e=t.scrollWidth,i=Math.min(e,this.maxWidth);this.$content.css("width",i)},resizeScroll:function(){var t=this.$content.get(0),e=t.scrollWidth,i=t.scrollLeft,o=this.$content.innerWidth();o>=e?(this.$scrollBar.hide(),this.dom.addClass("no_scroll_bar"),this.trigger("onScrollBarHide"),this.hasScroll=!1):(this.$scrollBar.show(),this.dom.removeClass("no_scroll_bar"),this.$scrollBar.width(o),this.$scrollButton.width(o/e*o),this.$scrollButton.css("left",i/e*o),this.trigger("onScrollBarShow"),this.hasScroll=!0)}}}),_.Module.define({path:"ueditor/widget/ueditor_video/ueditor_video_dialog",requires:[],sub:{mDialog:null,needCloseDialog:!0,isWhiteUser:!1,videoUploadSize:2097152,coverImg:"",supportStepInfo:"",URLS:{uploadImage:"https://web.archive.org/web/20201117141157/https://uploadphotos.baidu.com/Pic/upload?pid=tieba&filetype=base64",uploadVideoBlock:"/video/pc/uploadBlock",getUserVideoInfo:"video/pc/getBaseInfo",postVideoThread:"/video/pc/publishVideoThread",uploadMonitor:"/video/pc/uploadMonitor",beginCutFrame:"/video/pc/beginCutFrame",getFrame:"/video/pc/getFrame",getImageInfo:"/video/pc/uploadHiphoto"},postParam:{title:"",tags:[],video_url:"",video_md5:"",video_format:"",total_len:0,block_num:0,thumbnail_url:"",thumbnail_pic_id:0,thumbnail_width:0,thumbnail_height:0,channel_id:0},fileMd5Time:0,userVideoChannelInfo:[],limitChooseTags:4,limitTitleLen:31,limitAbstractLen:2e3,limitTagLen:8,tmpTagName:"",tmpTitle:"",tmpAbstract:"",videoFileUploading:!1,selfDefineTags:[],newDefineTags:[],defaultTags:[],videoTypeAccess:["mp4","flv","f4v","webm","m4v","mov","3gp","rm","rmvb","ram","wmv","avi","asf","mpg","mpeg","dvix","dv","vob","dat","mkv","cpk","qt","fli","flc","mod"],initial:function(t){this.fuckCDN=!0,this.option=t;var e=this;$.stats.track("\u65b0\u89c6\u9891\u4e0a\u4f20\u70b9\u51fb","PC\u65b0\u89c6\u9891\u4e0a\u4f20\u7edf\u8ba1","frs","click"),$.getJSON("/fex/check/isRealName",function(t){t.data===!1&&1===PageData.user.is_login&&(e.realname=!1,$.tb.checkRealName())}),this.initUserVideoInfo(function(){e.showUploadFrontPage()})},initUserVideoInfo:function(t){var e=this;$.ajax({url:this.URLS.getUserVideoInfo,type:"GET",data:{},success:function(i){0===parseInt(i.no,10)?(e.defaultTags=i.data.tags,e.userVideoChannelInfo=i.data.channel_infos,e.isWhiteUser=i.data.is_white_user,t&&t()):alert(i.msg?i.msg:JSON.stringify(i))},error:function(){alert("\u7528\u6237\u6807\u7b7e\u548c\u5fae\u5427\u4fe1\u606f\u83b7\u53d6\u5931\u8d25")}})},bindEvent:function(){},postVideo:function(){},showPostSuccessDialog:function(){var t='<div class="video-poster-success">\n    <img src="//web.archive.org/web/20201117141157/https://tb2.bdstatic.com/tb/img/success-icon_838102e.png" class="video-poster-success-icon">\n    <p class="video-poster-success-text">\u89c6\u9891\u5df2\u7ecf\u5c31\u7eea\uff0c\u8bf7\u7b49\u5f85\u5ba1\u6838\uff0c\u53d1\u5e03\u6210\u529f\u60a8\u4f1a\u6536\u5230\u63d0\u9192</p>\n</div>\n<div class="video-poster-success-bottom" >\n    <button class="btn-default btn-large" post-video-success-close-btn >\u5173\u95ed</button>\n</div>';this.mDialog&&this.mDialog.close(),this.mDialog=new $.dialog({title:"\u53d1\u5e03\u89c6\u9891\u8d34",html:'<div class="video-poster video-poster-warning video-poster-success" video-poster ></div>',width:550,height:240,show:!1,holderClassName:"video-poster-dialog"});var e=this,i=$(t);this.mDialog.element.find("[video-poster]").append(i),this.mDialog.element.on("click","[post-video-success-close-btn]",function(t){t.preventDefault(),e.mDialog.close()}),this.mDialog.show(),$("html").removeClass("tb-ueditor-fullscreen")},showRemovePostContentWarningPage:function(t){var e="//web.archive.org/web/20201117141157/https://tb2.bdstatic.com/tb/img/warning-icon_9668285.png",i=["<div>",'<img src="'+e+'" class="video-poster-warning-icon">','<p class="video-poster-warning-text">\u89c6\u9891\u6dfb\u52a0\u6b63\u6587\u529f\u80fd\u6682\u672a\u4e0a\u7ebf\uff0c\u60a8\u521a\u521a\u6dfb\u52a0\u7684\u6b63\u6587\u5185\u5bb9\u6b64\u6b21\u5c06\u4e0d\u80fd\u88ab\u4fdd\u5b58</p>',"</div>",'<div class="video-poster-warning-bottom" >','<button class="btn-default btn-large" post-video-continue >\u7ee7\u7eed\u53d1\u5e03</button>','<button class="btn-sub btn-large" post-video-cancel >\u53d6\u6d88</button>',"</div>"].join(""),o=new $.dialog({title:"\u53d1\u5e03\u89c6\u9891\u8d34",html:'<div class="video-poster video-poster-warning" video-poster ></div>',width:550,height:410,show:!1,holderClassName:"video-poster-dialog"}),a=this,n=$(i);o.element.find("[video-poster]").append(n),o.element.on("click","[post-video-cancel]",function(t){t.preventDefault(),o.close(),a.mDialog.close()}).on("click","[post-video-continue]",function(e){e.preventDefault(),t&&t(),o.close()}),o.show()},sendMonitor:function(t){t.tbs=PageData.tbs,t.user=PageData.user,t.forum=PageData.forum,$.post(this.URLS.uploadMonitor,t,function(){})},showUploadDetailPage:function(t){var e=this,i=[],o=!1,a=this.defaultTags,n=!1;this.postParam.tags=[],this.fileSize=t.size,window.onbeforeunload=function(){return confirm("\u60a8\u786e\u5b9a\u8981\u79bb\u5f00\u6b64\u7f51\u7ad9\u5417\uff1f\u7cfb\u7edf\u53ef\u80fd\u4e0d\u4f1a\u4fdd\u5b58\u60a8\u6240\u586b\u5199\u7684\u5185\u5bb9")};var r=$.cookie(PageData.user.id+"_selfVideoTags");"undefined"===r&&(r=null),r&&(r=JSON.parse(r)),"string"==typeof r&&(r=[r]);for(var s in a)i.push('<li data-name="'+a[s]+'" video-tag-item>'+a[s]+"</li>");if(r){this.selfDefineTags=r;for(var s in this.selfDefineTags)if(this.selfDefineTags.hasOwnProperty(s)){var l=this.selfDefineTags[s];i.push('<li data-name="'+l+'" video-tag-item> '+l+'<i class="iconfont icon-image video-tag-item-rm" video-tag-item-rm >&#xe606;</i></li>')}}i=i.join("");var d='<div>\n    <div class="video-poster-dialog-title">\n        <a href="#" video-poster-dialog-close title="\u5173\u95ed\u672c\u7a97\u53e3">&nbsp;</a>\n    </div>\n    <div class="video-poster-dialog-content">\n        <div class="video-poster-content-title">\u4e0a\u4f20\u89c6\u9891\u6587\u4ef6</div>\n        <div class="video-poster-content-process" video-poster-content-process>\n            <div class="video-poster-content-process-icon"></div>\n            <div class="video-poster-content-process-detail">\n                <div class="video-poster-content-process-name" video-poster-content-process-name></div>\n                <div class="video-poster-content-process-info">\n                    <div class="video-poster-content-process-uploading" video-poster-content-process-uploading>\n                        <div class="video-poster-content-process-left" video-poster-content-process-speed>\n                        </div>\n                        <div class="video-poster-content-process-right" video-poster-content-process-percent></div>\n                        </div>\n                    <div class="video-poster-content-process-success" video-poster-content-process-success>\n                        \u4e0a\u4f20\u6210\u529f\n                        <div class="video-poster-content-process-right"video-poster-content-process-delete>\u5220\u9664</div>\n                    </div>\n                    <div class="video-poster-content-process-fail" video-poster-content-process-fail>\n                        \u4e0a\u4f20\u5931\u8d25\n                        <div class="video-poster-content-process-right" video-poster-content-process-delete>\u91cd\u65b0\u4e0a\u4f20</div>\n                    </div>\n                </div>\n                <div class="video-poster-content-process-bar">\n                    <div class="video-poster-content-process-bar-outsite" video-uploader-process-bar>\n                        <div class="video-poster-content-process-bar-inner" video-uploader-process-bar-inner></div>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div class="video-poster-content-add" video-poster-content-add>\n            <div class="video-poster-content-add-btn" video-poster-content-add-btn>\u4e0a\u4f20\u89c6\u9891</div>\n            <input type="file" accept="*" class="video-upload-file-input" video-poster-video-upload>\n            <div class="video-poster-content-add-text">\n                <div>1.\u89c6\u9891\u5efa\u8bae\u4e0d\u8981\u8fc7\u4e8e\u6a21\u7cca\uff0c\u5206\u8fa8\u7387\u4e0d\u53ef\u4f4e\u4e8e640*360\u3002</div>\n                <div>2.\u89c6\u9891\u5927\u5c0f\u4e0d\u8d85\u8fc7500M\uff0c\u5982\u6709\u66f4\u5927\u89c6\u9891\u4e0a\u4f20\u9700\u6c42\uff0c\u8bf7\u8054\u7cfb\u5b98\u65b9\u53f7\uff1a<a href="https://web.archive.org/web/20201117141157/https://tieba.baidu.com/home/main?un=%E5%A5%BD%E7%8E%A9%E7%9A%84%E8%A7%86%E9%A2%91%E8%BE%BE%E4%BA%BA&id=tb.1.4bf8149f.bbqCRYcjz9ulAUhvZs8KEQ&fr=home" target="_blank">\u8d34\u5427\u89c6\u9891\u5b98\u65b9</a>\u3002\u6700\u5927\u53ef\u5f00\u653e2G\u4e0a\u4f20\u670d\u52a1</div>\n                <div>3.\u89c6\u9891\u683c\u5f0f\u53c2\u8003\uff1a<a class="detail-tip" href="#" video-poster-format-tip>\u5e38\u89c1\u89c6\u9891\u683c\u5f0f</a></div>\n            </div>\n            <div class="video-poster-content-add-errtip" video-poster-content-errtip></div>\n        </div>\n        <div class="video-poster-split-line"></div>\n        <div class="video-poster-content-title">\u89c6\u9891\u5c01\u9762\u8bbe\u7f6e<span class="video-poster-cover-description">(\u683c\u5f0fjpeg\u3001png\uff0c\u6587\u4ef6\u5927\u5c0f\u22645MB\uff0c\u5efa\u8bae\u5c3a\u5bf8\u22651146*717\uff0c\u6700\u4f4e\u5c3a\u5bf8\u2265960*600)</span></div>\n        <div class="video-poster-content-cover">\n            <div class="video-poster-content-cover-preview">\n                <div class="video-poster-content-cover-preview-upload" video-poster-content-cover-preview-upload></div>\n                <div class="video-poster-content-cover-preview-wrap" video-poster-content-cover-preview-wrap><span class="suspension">\u4e0a\u4f20\u5c01\u9762</span></div>\n                <input type="file" accept="image/*" class="video-upload-file-input" video-poster-thumbnail-input>\n            </div>\n            <div class="video-poster-content-cover-list" video-poster-content-cover-list>\n                <span class="video-poster-content-cover-list-arrow"></span>\n                <div class="video-poster-content-cover-tip" video-poster-content-cover-tip>\u89c6\u9891\u6b63\u5728\u89e3\u6790\uff0c\u5c01\u9762\u56fe\u622a\u56fe\u4e2d\u2026</div>\n                <div class="video-poster-content-cover-items" video-poster-content-cover-items></div>\n            </div>\n        </div>\n        <div class="video-poster-info">\n            <div class="video-poster-info-title">\n                <span>\u6dfb\u52a0\u6807\u9898 </span>\n                <span class="title-desc">(\u5fc5\u586b)</span>\n            </div>\n            <div class="video-poster-info-title-input-wrapper">\n                <div class="video-poster-info-title-input-box">\n                    <input class="form-control video-poster-detail-title" video-poster-detail-title type="text">\n                    <p class="video-title-place-holder" video-title-place-holder>\u53d1\u8d34\u5c0f\u79d8\u8bc0\uff1a1. \u4e3a\u8d34\u5b50\u6dfb\u52a0\u6807\u9898\u66f4\u5bb9\u6613\u88ab\u63a8\u8350\u4e0a\u9996\u9875\u5462 2. \u6807\u9898\u5c3d\u91cf\u4e0d\u8981\u4e0e\u6b63\u6587\u91cd\u590d\u54e6 3. \u8bf7\u586b\u519931\u5b57\u4ee5\u5185\u7684\u6807\u9898</p>\n                    <p class="title-input-current-num" title-input-current-num>(0/31)</p>\n                </div>\n                <div class="video-poster-errtip" video-poster-title-errtip></div>\n                <p class="video-poster-info-title video-poster-info-abstract-title">\n                    <span>\u6dfb\u52a0\u6458\u8981</span>\n                </p>\n                <div class="video-poster-info-abstract-wrapper">\n                    <div class="video-poster-abstract-style-wrapper">\n                        <div id="video-poster-abstract-ueditor-replace" video-poster-abstract-ueditor-replace style="width: 700px; height: 197px; padding-bottom: 36px;"></div>\n                        <p class="video-poster-abstract-current-num" video-poster-abstract-current-num>(0/2000)</p>\n                    </div>\n                    <div class="poster_error j_error video-poster-errtip" video-poster-abstract-errtip></div>\n                </div>\n                <ul class="video-poster-info-recommend-topic-list">\n                    <li class="recommend-topic-title">\u63a8\u8350\u8bdd\u9898</li>\n                </ul>\n            </div>\n\n            <div class="video-poster-content-title video-poster-content-tag">\u6dfb\u52a0\u6807\u7b7e<span class="video-poster-cover-description">(\u5fc5\u586b)</span></div>\n            <div class="video-poster-content-tag-list">\n                <ul video-poster-content-tags class="video-poster-content-tags"></ul>\n                <input type="text" placeholder="\u81ea\u5b9a\u4e49\u6807\u7b7e" class="video-poster-tag-input form-control"\n                    video-poster-tag-input>\n                <div class="video-poster-content-tag-tip" video-poster-content-tag-tip></div>\n            </div>\n            <div class="post-video-btn-wrap">\n                <button class="btn-default btn-lager post-video-btn" post-video-btn>\u53d1\u5e03</button>\n            <div class="video-poster-errtip video-poster-post-errtip" video-poster-post-errtip></div>\n        </div>\n    </div>\n</div>';this.mDialog&&this.mDialog.close(),this.mDialog=null,this.mDialog=new $.dialog({html:'<div class="video-poster-detail-dialog" video-poster ></div>',width:780,height:"100%",top:0,show:!1,draggable:!1}),$("html").addClass("tb-ueditor-fullscreen");var c=this.mDialog.element;c.find("[video-poster]").html(d),this.mDialog.bind("onclose",function(){return n||confirm("\u60a8\u786e\u5b9a\u8981\u5173\u95ed\u5417\uff1f\u7cfb\u7edf\u53ef\u80fd\u4e0d\u4f1a\u4fdd\u5b58\u60a8\u6240\u586b\u5199\u7684\u5185\u5bb9")?(window.onbeforeunload=function(){},!0):!1});var e=this;c.find("[video-poster-content-process-name]").text("\u89c6\u9891\u6587\u4ef6\u540d\uff1a"+t.name),c.find("[video-poster-content-tags]").append(i),c.find("[video-poster-format-tip]").attr("data-text",e.supportStepInfo);var p=c.find("[video-poster-detail-title]"),h=c.find("[video-poster-title-errtip]"),u=c.find("[title-input-current-num]"),v=c.find("[video-title-place-holder]"),m=c.find("[video-poster-abstract-errtip]"),f=c.find("[video-poster-abstract-current-num]"),g=c.find("[video-poster-img-errtip]"),w=c.find("[video-poster-post-errtip]"),b=c.find("[video-uploader-process-bar-inner]"),_=c.find("[video-poster-content-tag-tip]"),y=c.find("[video-poster-content-errtip]"),x=c.find("[video-poster-content-process]"),D=c.find("[video-poster-content-process-speed]"),k=c.find("[video-poster-content-process-percent]"),C=c.find("[video-poster-content-tags]"),M=c.find("[video-poster-content-add]"),B=c.find("[video-poster-content-cover-preview-wrap]"),P=c.find("[video-poster-content-cover-preview-upload]");x.show(),M.hide(),k.text(""),D.text("\u51c6\u5907\u4e2d..."),this.mDialog.show(),e.initCoverList();var T=c.find("[video-poster-content-cover-list]"),E=c.find("[video-poster-content-cover-items]");e.scrollPanel=e.requireInstance("ueditor/widget/scroll_horizontal/scroll_horizontal",{container:T,width:502,content:E}),this.abstractEditor=UE.getEditor("video-poster-abstract-ueditor-replace",{contentWidth:728,initialFrameWidth:740,toolbar:["at","bold","red","formula","emotion","topic","paste"]}),this.abstractEditor.addListener("beforepaste",function(t,e){var i=/<img[^>]*class="BDE_Colorful"[^>]*code="([\w\d]*)".*?(?:>|\/>)/gi;e.html=e.html.replace(i,function(t,e){return String.fromCharCode(e)}),e.html=e.html.replace(/<\/?[^>]+>/g,"")}),this.$placeholder=$('<div class="video-poster-abstract-placeholder">\u8bf7\u586b\u51992000\u5b57\u4ee5\u5185\u7684\u6458\u8981</div>'),this.abstractEditor.ready(function(){var t=c.find("[video-poster-abstract-ueditor-replace]");e.$placeholder.prependTo(c.find(".edui-editor-body")),e.$placeholder.on("click",function(){e.$placeholder.hide(),t.focus()}),t.on("focus",function(){e.$placeholder.hide()}),t.on("blur",function(){e.abstractEditor.getContent()||e.$placeholder.show()}),c.find(".edui-btn-emotion").one("click",function(){for(var t=c.find(".ueditor_emotion_tab .s_tab_btn"),e=0;e<t.length;e++){var i=$(t[e]);i.data("index")>2&&i.remove()}c.find(".ueditor_emotion_tab .s_prev").remove(),c.find(".ueditor_emotion_tab .s_next").remove()})}),$.ajax({type:"GET",url:"/hottopic/browse/topicList"}).done(function(t){if(0===+t.errno&&t.data.bang_topic&&t.data.bang_topic.topic_list){for(var i=t.data.bang_topic.topic_list.slice(0,10),o=[],a=0;a<i.length;a++)o.push('<li class="recommend-topic-item" data-topic="'+i[a].topic_name+'">#'+i[a].topic_name+"#</li>");var n=$(o.join(""));c.find(".video-poster-info-recommend-topic-list").append(n).on("click",function(t){if(t.preventDefault(),$(t.target).hasClass("recommend-topic-item")){var i="#"+$(t.target).data("topic")+"#";e.abstractEditor.execCommand("inserthtml",i)}})}});var A=!0,S=!0;c.find("[video-poster-content-cover-tip]").text("\u89c6\u9891\u6b63\u5728\u89e3\u6790\uff0c\u5c01\u9762\u56fe\u622a\u56fe\u4e2d\u2026"),c.on("click","[video-poster-content-add-btn]",function(t){t.preventDefault(),c.find("[video-poster-video-upload]").trigger("click")}).on("click","[video-poster-content-process-delete]",function(){e.initCoverList(),x.hide(),M.show(),e.checkSubmitState()}).on("click","[video-poster-dialog-close]",function(){$("html").removeClass("tb-ueditor-fullscreen"),e.mDialog&&e.mDialog.close()}).on("mouseover",".video-poster-content-add-text .detail-tip",function(t){t.preventDefault();var i=$(this);e.showBubbleTip(i,i.attr("data-text"))}).on("mouseout",".video-poster-content-add-text .detail-tip",function(t){t.preventDefault();var i=$(this);e.closeBubbleTip(i)}).on("change","[video-poster-video-upload]",function(){if(this.files&&this.files[0]){var t=this.files[0];e.reUploadVideoFile(t),$(this).val("")}}).on("click","[video-poster-content-cover-list-item]",function(){var t=$(this);t.addClass("choosed").siblings().removeClass("choosed"),P.hide(),B.show(),e.coverImg=t.attr("realsrc"),B.css("background-image","url("+t.attr("realsrc")+")");var i=new Image;i.src=t.attr("realsrc"),i.onload=function(){e.postParam.thumbnail_url=t.attr("realsrc"),e.postParam.thumbnail_pic_id="",e.postParam.thumbnail_width=i.width,e.postParam.thumbnail_height=i.height}}).on("click","[video-poster-content-cover-preview-upload]",function(t){t.preventDefault(),c.find("[video-poster-thumbnail-input]").trigger("click")}).on("click","[video-poster-content-cover-preview-wrap]",function(t){t.preventDefault(),c.find("[video-poster-thumbnail-input]").trigger("click")}).on("click","[video-title-place-holder]",function(){$(this).hide(),p.focus()}).on("keyup keydown input blur","[video-poster-detail-title]",function(t){var i=$(this);S&&(S=!1,setTimeout(function(){var o=$.trim(i.val());o?v.hide():v.show();var a=e.limitTitleLen,n=Math.min(Math.floor(e.strlen(o)/2),a+1);u.text("("+n+"/"+a+")"),n>a?(i.val(e.tmpTitle),h.text("\u5df2\u7ecf\u8d85\u8fc731\u4e2a\u5b57\u5566~"),t.preventDefault()):(e.tmpTitle=o,h.text("")),e.postParam.title=o,e.checkSubmitState(),S=!0},100))}).on("keyup keydown focus input","[video-poster-abstract-ueditor-replace]",function(t){A&&(A=!1,setTimeout(function(){var i=e.abstractEditor,o=i.getContent(),a=e.limitAbstractLen,n=Math.min(Math.floor(i.getContentByteLength()/2),a+1);n>a?(i.setContent(e.tmpAbstract),m.text("\u5df2\u7ecf\u8d85\u8fc72000\u4e2a\u5b57\u5566~"),t.preventDefault()):(e.tmpAbstract=o,m.text(""),f.text("("+n+"/"+a+")")),e.postParam.video_abstract=o,A=!0},100))}).on("keyup","[video-poster-tag-input]",function(t){var i=$(this);if(13==t.keyCode){t.preventDefault();var o=$.trim(i.val());if(""==o)return!1;var a=e.limitTagLen;if(e.strlen(o)>a)return _.text("\u6bcf\u4e2a\u6807\u7b7e\u6700\u591a4\u4e2a\u6c49\u5b57"),t.preventDefault(),!1;if(e.tmpTagName=o,_.text(""),e.postParam.tags.length>=e.limitChooseTags)_.text("\u6700\u591a\u9009\u62e9"+e.limitChooseTags+"\u4e2a\u6807\u7b7e");else if(e.selfDefineTags.indexOf(o)<0&&e.defaultTags.indexOf(o)<0){var n=['<li  class="btn-default" data-name="'+o+'" video-tag-item>'+o,'<i class="iconfont icon-image video-tag-item-rm" video-tag-item-rm >&#xe606;</i>',"</li>"].join("");i.val(""),C.append(n),$.stats.track("\u7528\u6237\u751f\u6210\u81ea\u5b9a\u4e49\u6807\u7b7e","PC\u65b0\u89c6\u9891\u4e0a\u4f20\u7edf\u8ba1","frs","click"),e.selfDefineTags.push(o),e.postParam.tags.push(o),e.newDefineTags.push(o),_.text("")}else _.text("\u6807\u7b7e\u5df2\u7ecf\u5b58\u5728");return e.checkSubmitState(),!0}}).on("click","[video-tag-item-rm]",function(t){t.preventDefault(),t.stopPropagation();var i=$(this),o=i.parent(),a=o.attr("data-name");return e.selfDefineTags=e.removeTagFromList(a,e.selfDefineTags),e.newDefineTags=e.removeTagFromList(a,e.newDefineTags),e.postParam.tags=e.removeTagFromList(a,e.postParam.tags),o.remove(),e.checkSubmitState(),!1}).on("click","[video-tag-item]",function(t){t.preventDefault(),t.stopPropagation(),_.text(""),e.chooseTag(this)}).on("change","[video-poster-thumbnail-input]",function(t){t.preventDefault(),this.files&&this.files[0]&&(e.uploadVideoThumbnail(this.files[0]),g.text(""),c.find("[video-poster-thumbnail-input]").val(""))}).on("click","[post-video-btn]",function(){if(!$(this).hasClass("post-video-btn-active"))return!1;if(1==o)return!1;_.text(""),y.text("");var t=!1;if(e.postParam.title=$.trim(c.find("[video-poster-detail-title]").val()),0==e.postParam.tags.length&&(_.text("\u8bf7\u9009\u62e9\u89c6\u9891\u6807\u7b7e"),t=!0),""==e.postParam.title?t=!0:"#"==e.postParam.title[0]&&"#"==e.postParam.title[e.postParam.title.length-1]&&(t=!0),e.videoFileUploading?(y.text("\u4e0a\u4f20\u4e2d\u8bf7\u8010\u5fc3\u7b49\u5f85"),t=!0):""==e.postParam.video_url&&(y.text("\u8bf7\u4e0a\u4f20\u89c6\u9891"),t=!0),t)return!1;o=!0;var i=$(this);i.removeClass("btn-default").addClass("btn-default-disabled").text("\u53d1\u5e03\u4e2d..."),e.postParam.channel_id=0;var a={channel_id:e.postParam.channel_id,video_tags:e.postParam.tags,fname:PageData.forum.name,fid:PageData.forum.id,video_url:e.postParam.video_url,video_width:0,video_height:0,video_duration:0,video_format:e.postParam.video_format,video_size:e.postParam.total_len,video_md5:e.postParam.video_md5,thumbnail_pic_id:e.postParam.thumbnail_pic_id,thumbnail_width:e.postParam.thumbnail_width,thumbnail_height:e.postParam.thumbnail_height,desc:e.postParam.title,video_abstract:e.abstractEditor.getContentUbb(),tbs:PageData.tbs};$(".j_use_core").is(":checked")&&(a.pro_zone=1),$(".j_poster_to_profile_in_frs").tbattr("checked")&&(a.is_personal_thread=1),w.text("");var r=!e.postParam.thumbnail_pic_id;e.getImageInfo(r,e.postParam.thumbnail_url,function(t){t&&(a.thumbnail_pic_id=t),$.ajax({url:e.URLS.postVideoThread,type:"POST",dataType:"json",data:a,success:function(t){0==parseInt(t.no,10)?(n=!0,e.updateLastSelfDefineTag(),e.showPostSuccessDialog()):(o=!1,i.addClass("btn-default").removeClass("btn-default-disabled").text("\u91cd\u65b0\u53d1\u5e03"),alert("\u53d1\u5e03\u5931\u8d25["+t.msg+"]"),w.text("\u53d1\u5e03\u5931\u8d25,"+t.msg),e.sendMonitor({msg:"post faild",data:t}))},error:function(){o=!1,i.addClass("btn-default").removeClass("btn-default-disabled").text("\u91cd\u65b0\u53d1\u5e03"),alert("\u8bf7\u6c42\u8d85\u65f6"),w.text("\u8bf7\u6c42\u8d85\u65f6"),e.sendMonitor({msg:"post faild",data:"http fail"})}})})}),setTimeout(function(){e.uploadInstance=new uploadVideo({blockUploadPreFn:function(){},blockUploadErrFn:function(t,i){var o="\u5931\u8d25\u91cd\u8bd5"+i+"\u6b21",a={};a=$.extend({},t),a.block_data&&delete a.block_data,a.file&&delete a.file,e.sendMonitor({msg:"upload retry",data:a,retryTimes:i}),y.html(o)},blockUploadDoneFn:function(t,i){b.css({width:680*t/i});var o=(e.fileSize/1024/1024).toFixed(1),a=(e.fileSize/1024/1024*t/i).toFixed(1),n=(Date.now()-e.fileMd5Time)/1e3,r=(a/n).toFixed(1),s=((o-a)/r).toFixed();D.html('\u89c6\u9891\u4e0a\u4f20\u4e2d<span><span class="blue_color">'+a+"M</span>/"+o+"M</span> \u5f53\u524d\u901f\u5ea6"+r+"MB/s - \u5269\u4f59"+s+"s"),k.text("\u5df2\u4e0a\u4f20"+Math.ceil(100*t/i)+"%")},uploadReadyFn:function(t){e.sendMonitor({msg:"file md5 couting",data:Date.now()-e.fileMd5Time,filesize:t.size,unit:"ms"})},uploadPreFn:function(){e.fileMd5Time=Date.now(),e.videoFileUploading=!0},uploadDoneFn:function(t,i){e.videoFileUploading=!1,t?(e.postParam.video_url=i.video_url,e.postParam.video_md5=i.video_md5,e.postParam.video_format=i.video_format,e.postParam.total_len=i.total_len,e.postParam.upload_id=i.upload_id,e.mDialog.element.find("[video-uploader-process]").hide(),e.mDialog.element.find("[video-uploader-result]").text("\u89c6\u9891\u4e0a\u4f20\u6210\u529f!"),e.mDialog.element.find("[video-poster-content-process-uploading]").hide(),e.mDialog.element.find("[video-poster-content-process-success]").show(),b.css({width:680}),e.sendMonitor({msg:"upload file success",data:e.postParam}),e.checkSubmitState(),e.getCoverFrameBegin()):(e.sendMonitor({msg:"upload file fail",data:i}),y.text("\u4e0a\u4f20\u5931\u8d25"))},uploadErrFn:function(t){e.mDialog.element.find("[video-uploader-retry]").show();var i="\u4e0a\u4f20\u5931\u8d25";e.mDialog.element.find("[video-poster-content-process-uploading]").hide(),e.mDialog.element.find("[video-poster-content-process-fail]").show(),y.text(i),e.sendMonitor({msg:"upload file fail",data:t})}}),e.uploadInstance.upload(t)},1)},removeTagFromList:function(t,e){var i=e.indexOf(t);return i>=0&&(e=e.slice(0,i).concat(e.slice(i+1,e.length))),e},updateLastSelfDefineTag:function(){$.cookie(PageData.user.id+"_selfVideoTags",JSON.stringify(this.newDefineTags),86400)},chooseTag:function(t){var e=$(t),i=this.mDialog.element.find("[video-poster-content-tag-tip]"),o=e.attr("data-name");$.stats.track("\u6807\u7b7e\u70b9\u51fb","PC\u65b0\u89c6\u9891\u4e0a\u4f20\u7edf\u8ba1","frs","click",{obj_name:o}),e.hasClass("btn-default")?(e.addClass("btn-sub"),e.removeClass("btn-default"),this.postParam.tags=this.removeTagFromList(o,this.postParam.tags)):this.postParam.tags.length>=this.limitChooseTags?i.text("\u6700\u591a\u9009\u62e9"+this.limitChooseTags+"\u4e2a\u6807\u7b7e"):(e.addClass("btn-default"),e.removeClass("btn-sub"),this.postParam.tags.push(o)),this.checkSubmitState()},uploadVideoThumbnail:function(t){var e=!1,i=['<form class="uploadImageForm" ><input type="hidden" class="uploadFile" name="file"></form>','<div class="video-poster-thumbnail-main clearfix" video-poster-thumbnail-main >','<div class="video-poster-thumbnail-cropper-wrap clearfix" >','<div class="video-poster-thumbnail-cropper-section">\n        <!-- <h3>Demo:</h3> -->\n    <div class="video-poster-thumbnail-subtitle">\u81ea\u5b9a\u4e49\u89c6\u9891\u5c01\u9762</div>\n    <div class="img-container">\n        <img src="" alt="Picture">\n    </div>\n</div>\n<div class="video-poster-thumbnail-preview-section">\n    <!-- <h3>Preview:</h3> -->\n    <div class="video-poster-thumbnail-subtitle">\u5c01\u9762\u9884\u89c8</div>\n    <div class="img-preview-wrap clearfix">\n      <div class="img-preview ">\n\n      </div>\n      <img  class="img-preview-play-btn " src="//web.archive.org/web/20201117141157/https://tb2.bdstatic.com/tb/img/play-icon_f15a299.png" >\n    </div>\n    <!-- <h3>Data:</h3> -->\n     <!-- <div class="docs-data">\n      <div class="input-group input-group-sm">\n        <label class="input-group-addon" for="dataX">X</label>\n        <input type="text" class="form-control" id="dataX" placeholder="x">\n        <span class="input-group-addon">px</span>\n      </div>\n      <div class="input-group input-group-sm">\n        <label class="input-group-addon" for="dataY">Y</label>\n        <input type="text" class="form-control" id="dataY" placeholder="y">\n        <span class="input-group-addon">px</span>\n      </div>\n      <div class="input-group input-group-sm">\n        <label class="input-group-addon" for="dataWidth">Width</label>\n        <input type="text" class="form-control" id="dataWidth" placeholder="width">\n        <span class="input-group-addon">px</span>\n      </div>\n      <div class="input-group input-group-sm">\n        <label class="input-group-addon" for="dataHeight">Height</label>\n        <input type="text" class="form-control" id="dataHeight" placeholder="height">\n        <span class="input-group-addon">px</span>\n      </div>\n      <div class="input-group input-group-sm">\n        <label class="input-group-addon" for="dataRotate">Rotate</label>\n        <input type="text" class="form-control" id="dataRotate" placeholder="rotate">\n        <span class="input-group-addon">deg</span>\n      </div>\n      <div class="input-group input-group-sm">\n        <label class="input-group-addon" for="dataScaleX">ScaleX</label>\n        <input type="text" class="form-control" id="dataScaleX" placeholder="scaleX">\n      </div>\n      <div class="input-group input-group-sm">\n        <label class="input-group-addon" for="dataScaleY">ScaleY</label>\n        <input type="text" class="form-control" id="dataScaleY" placeholder="scaleY">\n      </div>\n    </div> -->\n</div>\n',"</div>",'<div class="video-poster-thumbnail-bottom" >','<button class="btn-default btn-large " video-poster-thumbnail-save >\u4fdd\u5b58\u5c01\u9762</button>','<button class="btn-sub btn-large " video-upload-image-btn >\u91cd\u65b0\u4e0a\u4f20</button>',"</div>","</div>"].join(""),o=this;
o.imageDialog&&o.imageDialog.close(),o.imageDialog=new $.dialog({title:"\u4e0a\u4f20\u89c6\u9891\u5c01\u9762",html:'<div class="video-poster-thumbnail" video-poster-thumbnail ></div>',width:790,height:440,show:!0,holderClassName:"video-poster-thumbnail-dialog",draggable:!1});var a=$(i),o=this;o.imageDialog.element.find("[video-poster-thumbnail]").append(a);var n=function(t,e){if(t){if(!/image\/\w+/.test(t.type))return void alert("\u8bf7\u4e0a\u4f20\u56fe\u7247\uff01");var i=new FileReader;i.onload=function(){var t=window.btoa(this.result.toString()),i="data:image/jpeg;base64, "+t,o=e.find(".img-container img");o.tbattr("src",i);var a={viewMode:1,aspectRatio:16/9,preview:".video-poster-thumbnail-dialog .img-preview",ready:function(t){console.log(t.type)},cropstart:function(t){console.log(t.type,t.detail.action)},cropmove:function(t){console.log(t.type,t.detail.action)},cropend:function(t){console.log(t.type,t.detail.action)},zoom:function(t){console.log(t.type,t.detail.ratio)}};r&&r.destroy(),r=new Cropper(o[0],a)},i.readAsBinaryString(t)}};n(t,o.imageDialog.element),o.imageDialog.element.on("click","[video-poster-thumbnail-save]",function(t){if(t.preventDefault(),1==e)return!1;$(this).removeClass("btn-default").addClass("btn-default-disabled").text("\u4e0a\u4f20\u4e2d..."),e=!0;var i=r.getCroppedCanvas(),a=i.toDataURL("image/jpeg");console.log("upload image size: ",a.length),l(a,function(t){var e=o.mDialog.element.find("[video-poster-thumbnail-preview]"),i=o.mDialog.element.find("[video-poster-content-cover-preview-upload]"),a=o.mDialog.element.find("[video-poster-content-cover-preview-wrap]"),n=0;o.postParam.thumbnail_url=t.pic_water.replace(/^http:\/\/imgsrc/g,"https://web.archive.org/web/20201117141157/https://imgsa"),o.postParam.thumbnail_pic_id=t.pic_id,o.postParam.thumbnail_width=t.fullpic_width,o.postParam.thumbnail_height=t.fullpic_height,o.imageDialog.close(),o.imageDialog=null,e.on("error",function(){n||(setTimeout(function(){e.tbattr("src",o.postParam.thumbnail_url+"?t="+(new Date).getTime())},100),++n)}),e.show().tbattr("src",o.postParam.thumbnail_url),o.coverImg=o.postParam.thumbnail_url,a.css("background-image","url("+o.postParam.thumbnail_url+")"),i.hide(),a.show(),o.mDialog.element.find("[video-poster-thumbnail-preview-btn]").show()})}).on("click","[video-upload-image-btn]",function(){o.mDialog.element.find("[video-poster-thumbnail-input]").trigger("click")});var r=null,s=null,l=function(t,e){if(void 0!=t&&""!=t){var i=t.replace("data:image/jpeg;base64,",""),a={file:i};s=$.ajax({type:"POST",data:a,url:o.URLS.uploadImage,success:function(t){0==t.err_no?e&&e(t.info):(o.sendMonitor({msg:"image upload file fail",data:t}),alert("\u4e0a\u4f20\u5931\u8d25.["+JSON.stringify(t)+"]"))},error:function(t){o.sendMonitor({msg:"image upload file fail",data:data}),alert("\u4e0a\u4f20\u5931\u8d25.["+JSON.stringify(t)+"]")}})}}},checkUploadFile:function(t,e){var i=this,o=t.name.split("."),a=o[o.length-1],n=i.mDialog.element.find("[video-poster-content-errtip]"),r=5e8,s="\u76ee\u524d\u4ec5\u652f\u6301\u4e0a\u4f20500M\u4ee5\u5185\u7684\u89c6\u9891\uff0c\u4e0a\u4f20\u66f4\u5927\u89c6\u9891\u9700\u6c42\u8bf7\u8054\u7cfb\u5b98\u65b9\u53f7";i.isWhiteUser&&(r=2e9,s="\u76ee\u524d\u4ec5\u652f\u6301\u4e0a\u4f202G\u4ee5\u5185\u89c6\u9891\uff0c\u4e4b\u540e\u5c06\u5f00\u901a\u66f4\u5927\u5c3a\u5bf8\u4e0a\u4f20"),i.videoTypeAccess.indexOf(a.toLowerCase())<0?n.text("\u6682\u4e0d\u652f\u6301\u6b64\u683c\u5f0f"):t.size>r?n.text(s):e()},uploadVideoFile:function(t){var e=this;e.checkUploadFile(t,function(){e.showUploadDetailPage(t)})},reUploadVideoFile:function(t){var e=this;e.checkUploadFile(t,function(){e.mDialog.element.find("[video-poster-content-errtip]").text(""),e.mDialog.element.find("[video-poster-content-process-name]").text("\u89c6\u9891\u6587\u4ef6\u540d\uff1a"+t.name),e.mDialog.element.find("[video-poster-content-add]").hide(),e.mDialog.element.find("[video-poster-content-process]").show(),e.mDialog.element.find("[video-poster-content-process-success]").hide(),e.mDialog.element.find("[video-poster-content-process-fail]").hide(),e.mDialog.element.find("[video-poster-content-process-uploading]").show(),e.mDialog.element.find("[video-uploader-process-bar-inner]").css({width:0}),e.fileSize=t.size,e.mDialog.element.find("[video-poster-content-process-speed]").text("\u51c6\u5907\u4e2d..."),e.mDialog.element.find("[video-poster-content-process-percent]").text("\u5df2\u4e0a\u4f200%"),e.uploadInstance.upload(t)})},checkSubmitState:function(){var t=this,e=t.postParam.tags.length>0,i=t.postParam.title,o=t.postParam.video_url,a=t.mDialog.element.find("[post-video-btn]");e&&i&&o?a.addClass("post-video-btn-active"):a.removeClass("post-video-btn-active")},showUploadFrontPage:function(){var t=this,e="//web.archive.org/web/20201117141157/https://tb2.bdstatic.com/tb/img/upload-icon_d6ddbb8.png",i="//web.archive.org/web/20201117141157/https://tb2.bdstatic.com/tb/img/url-icon_897d050.png",o=["1.\u4e0a\u4f20:\u5c06\u89c6\u9891\u4e0a\u4f20\u81f3\u670d\u52a1\u5668","2.\u5ba1\u6838:\u4e0a\u4f20\u5b8c\u6210\u540e\u5373\u8fdb\u5165\u5ba1\u6838\uff0c\u6b64\u9636\u6bb5\u9700\u8981\u4e00\u6bb5\u65f6\u95f4\uff0c\u8bf7\u7a0d\u5019","3.\u8f6c\u7801:\u5ba1\u6838\u5b8c\u6210\u540e\uff0c\u670d\u52a1\u5668\u5c06\u89c6\u9891\u8f6c\u7801\u6210\u64ad\u653e\u5668\u53ef\u8bc6\u522b\u7684\u683c\u5f0f","4.\u53d1\u5e03:\u5ba1\u6838\u8f6c\u7801\u5b8c\u6210\u540e\uff0c\u89c6\u9891\u6b63\u5f0f\u53d1\u5e03"].join("<br>");this.postStepInfo=o;var a=["\u76ee\u524d\u6211\u4eec\u652f\u6301\u7684\u89c6\u9891\u683c\u5f0f\u6709\uff1a","\u5e38\u89c1\u5728\u7ebf\u6d41\u5a92\u4f53\u683c\u5f0f\uff1amp4\u3001flv\u3001f4v\u3001webm","\u79fb\u52a8\u8bbe\u5907\u683c\u5f0f\uff1am4v\u3001mov\u30013gp","realplayer\uff1arm\u3001rmvb\u3001ram","\u5fae\u8f6f\u683c\u5f0f\uff1awmv\u3001avi\u3001asf","MPEG\u89c6\u9891\uff1ampg\u3001mpeg","DV\u89c6\u9891: .dvix .dv","\u5176\u4ed6\u683c\u5f0f\uff1avob\u3001dat\u3001mkv\u3001cpk\u3001qt\u3001fli\u3001flc\u3001mod"].join("<br>");this.supportStepInfo=a;var n=["\u9ad8\u6e05(360P): \u89c6\u9891\u5206\u8fa8\u7387 >= 640 x 360\uff0c\u89c6\u9891\u7801\u7387 >= 800kbps","\u8d85\u6e05(720P): \u89c6\u9891\u5206\u8fa8\u7387 >= 960 x 540\uff0c\u89c6\u9891\u7801\u7387 >= 1500kbps","\u84dd\u5149(1080P): \u89c6\u9891\u5206\u8fa8\u7387 >= 1920 x 1080\uff0c\u89c6\u9891\u7801\u7387 >= 2500kbps"].join("<br>");this.videoClarityInfo=n;var r=["1.\u89c6\u9891\u5efa\u8bae\u4e0d\u8981\u8fc7\u4e8e\u6a21\u7cca\uff0c\u5206\u8fa8\u7387\u4e0d\u53ef\u4f4e\u4e8e640*360(\u6e05\u6670\u5ea6\u6807\u6e05)","2.\u89c6\u9891\u5927\u5c0f\u4e0d\u8d85\u8fc7500M\uff0c\u4e4b\u540e\u5c06\u5f00\u901a\u5927\u5c3a\u5bf8\u4e0a\u4f20\u8ba1\u5212\uff0c\u656c\u8bf7\u671f\u5f85"].join("<br>");this.videoSizeInfo=r;var s=["<div drag-upload >",'<div class="video-poster-local-upload-btn-wrap" >',"<div>",'<button class="btn-default  video-poster-local-upload-btn" video-upload-btn ><img src="'+e+'" class="video-poster-local-upload-icon"><span>\u672c\u5730\u4e0a\u4f20</span></button>','<input type="file" accept="*" class="video-upload-file-input" video-upload-file-input >','<div class="video-upload-errtip"  video-poster-content-errtip ></div>',"</div>",'<div><a class="video-poster-add-url-btn" video-poster-add-url-btn ><img src="'+i+'" class="video-poster-add-url-icon">\u6dfb\u52a0\u94fe\u63a5</a></div>',"</div>",'<div class="video-poster-suggest">',"<p>1.\u89c6\u9891\u5efa\u8bae\u4e0d\u8981\u8fc7\u4e8e\u6a21\u7cca\uff0c\u5206\u8fa8\u7387\u4e0d\u53ef\u4f4e\u4e8e640*360\u3002</p>",'<p>2.\u89c6\u9891\u5927\u5c0f\u4e0d\u8d85\u8fc7500M\uff0c\u5982\u6709\u66f4\u5927\u89c6\u9891\u4e0a\u4f20\u9700\u6c42\uff0c\u8bf7\u8054\u7cfb\u5b98\u65b9\u53f7\uff1a<a href="https://web.archive.org/web/20201117141157/https://tieba.baidu.com/home/main?un=%E5%A5%BD%E7%8E%A9%E7%9A%84%E8%A7%86%E9%A2%91%E8%BE%BE%E4%BA%BA&id=tb.1.4bf8149f.bbqCRYcjz9ulAUhvZs8KEQ&fr=home" target="_blank">\u8d34\u5427\u89c6\u9891\u5b98\u65b9</a>\u3002\u6700\u5927\u53ef\u5f00\u653e2G\u4e0a\u4f20\u670d\u52a1</p>',"</div>",'<div class="video-poster-bottom" >','<p  class="video-poster-bottom-wraning" > <a href="https://web.archive.org/web/20201117141157/http://tieba.baidu.com/hermes/feedback?red_tag=j2018546882" target="_blank">\u5efa\u8bae\u53cd\u9988\u70b9\u8fd9\u91cc</a></p>','<p  class="video-poster-bottom-subinfo">','<a data-text="'+r+'" >\u5927\u5c0f\u9650\u5236</a>&nbsp;','<a data-text="'+o+'">\u53d1\u5e03\u6d41\u7a0b</a>&nbsp;','<a data-text="'+a+'">\u652f\u6301\u683c\u5f0f</a>&nbsp;',"</div>","</div>"].join("");this.mDialog&&this.mDialog.close(),this.mDialog=new $.dialog({title:"\u53d1\u5e03\u89c6\u9891\u8d34",html:'<div class="video-poster" video-poster ></div>',width:550,height:410,show:!1,resizeable:!0,holderClassName:"video-poster-dialog"});var l=$(s);this.mDialog.element.find("[video-poster]").append(l),this.mDialog.element.on("dragover",function(e){e.preventDefault(),e.stopPropagation(),t.mDialog.element.find("[drag-upload]").css({opacity:.5})}).on("drop",function(e){if(e.preventDefault(),e.stopPropagation(),!window.FileReader)return alert("\u60a8\u7684\u6d4f\u89c8\u5668\u4e0d\u652f\u6301\u6b64\u529f\u80fd\uff0c\u8bf7\u4f7f\u7528\u652f\u6301HTML5\u7684\u6d4f\u89c8\u5668"),!1;t.mDialog.element.find("[drag-upload]").css({opacity:1});var i=e.originalEvent.dataTransfer.files;if(i[0]){var o=i[0];t.option.editor.getContent()?t.showRemovePostContentWarningPage(function(){t.uploadVideoFile(o)}):t.uploadVideoFile(o),$.stats.track("\u65b0\u89c6\u9891\u4e0a\u4f20","PC\u65b0\u89c6\u9891\u4e0a\u4f20\u7edf\u8ba1","frs","click")}}).on("click","[video-upload-btn]",function(e){if(e.preventDefault(),t.data===!1&&1===PageData.user.is_login)window.realname.show();else{if(!window.FileReader)return alert("\u60a8\u7684\u6d4f\u89c8\u5668\u4e0d\u652f\u6301\u6b64\u529f\u80fd\uff0c\u8bf7\u4f7f\u7528\u652f\u6301HTML5\u7684\u6d4f\u89c8\u5668"),!1;$.stats.track("\u89c6\u9891\u4e0a\u4f20\u6309\u94ae\u70b9\u51fb","PC\u65b0\u89c6\u9891\u4e0a\u4f20\u7edf\u8ba1","frs","click"),t.option.editor.getContent()?t.showRemovePostContentWarningPage(function(){t.mDialog.element.find("[video-upload-file-input]").trigger("click")}):t.mDialog.element.find("[video-upload-file-input]").trigger("click")}}).on("mouseover",".video-poster-bottom-subinfo a",function(e){e.preventDefault();var i=$(this);t.showBubbleTip(i,i.attr("data-text"))}).on("mouseout",".video-poster-bottom-subinfo a",function(e){e.preventDefault();var i=$(this);t.closeBubbleTip(i)}).on("change","[video-upload-file-input]",function(){if($(this),this.files&&this.files[0]){var e=this.files[0];t.uploadVideoFile(e)}}).on("click","[video-poster-add-url-btn]",function(){t.mDialog.close(),$.stats.track("\u89c6\u9891\u89c6\u9891\u6309\u94ae\u70b9\u51fb","PC\u65b0\u89c6\u9891\u4e0a\u4f20\u7edf\u8ba1","frs","click");var e=$.extend({},t.option);t.requireInstance("ueditor/widget/ueditor_video/ueditor_video_url_dialog",e)}),this.mDialog.show()},showBubbleTip:function(t,e){var i='<div class="video-poster-bubble-tip "><span class="video-poster-bubble-tip-text ">'+e+'</span><span class="video-poster-bubble-tip-arrow ">\u25c6</span></div>';this.closeBubbleTip(t,e);var o=$(i);o.width(),t.css({position:"relative"});var a={},n={};e==this.videoSizeInfo?a={left:-75,width:200}:e==this.postStepInfo?a={left:-150,width:370}:e==this.supportStepInfo?a={left:-140,width:330}:e==this.videoClarityInfo&&(a={left:-200,width:400},n={marginLeft:"55%"}),"detail-tip"==t.context.className&&(a={left:-140,top:25},n={top:-7}),o.css(a),o.find(".video-poster-bubble-tip-arrow").css(n),t.offset(),t.append(o)},closeBubbleTip:function(t){var e=t.find(".video-poster-bubble-tip");e.length>0&&e.remove()},strlen:function(t){for(var e=0,i=0;i<t.length;i++){var o=t.charCodeAt(i);o>=1&&126>=o||o>=65376&&65439>=o?e++:e+=2}return e},getCoverFrameBegin:function(){var t=this;$.ajax({url:t.URLS.beginCutFrame,type:"GET",data:{video_url:t.postParam.video_url},success:function(e){t.mDialog.element.find("[video-poster-content-cover-tip]").text("\u89c6\u9891\u6b63\u5728\u89e3\u6790\uff0c\u5c01\u9762\u56fe\u622a\u56fe\u4e2d\u2026"),setTimeout(function(){t.getCoverFrame()},1e3*e.data)},error:function(){}})},getCoverFrame:function(){var t=this;$.ajax({url:t.URLS.getFrame,type:"GET",data:{video_url:t.postParam.video_url},success:function(e){if(0==e.no){var i=t.mDialog.element.find("[video-poster-content-cover-items]"),o=[],a="//web.archive.org/web/20201117141157/https://tb2.bdstatic.com/tb/img/icon_cover_select_ed727c4.png";e.data.forEach(function(t){o.push('<div class="video-poster-content-cover-list-item" video-poster-content-cover-list-item realSrc='+t+'><div class="real-img" style="background-image:url('+t+')"></div><img class="hover-img" src='+a+"></div>")}),i.html(o.join("")),t.mDialog.element.find("[video-poster-content-cover-tip]").text("\u53ef\u4ee5\u9009\u62e9\u4ee5\u4e0b\u5c01\u9762")}else t.getCoverFrame()},error:function(){}})},initCoverList:function(){var t=this;t.postParam.video_url="",t.mDialog.element.find("[video-poster-content-cover-tip]").text("\u7cfb\u7edf\u4f1a\u81ea\u52a8\u622a\u53d6\u89c6\u9891\u5c01\u9762");for(var e=[],i=0;10>i;i++)e.push('<div class="video-poster-content-cover-list-item"></div>');t.mDialog.element.find("[video-poster-content-cover-preview-upload]").show(),t.coverImg="",t.mDialog.element.find("[video-poster-content-cover-preview-wrap]").css("background-image","url()").hide(),t.mDialog.element.find("[video-poster-content-cover-items]").html(e.join(""))},getImageInfo:function(t,e,i){var o=this;t?$.ajax({url:o.URLS.getImageInfo,type:"GET",data:{pic_url:e},success:function(t){0===t.no?i&&i(t.data):o.sendMonitor({msg:"\u56fe\u7247\u83b7\u53d6\u5931\u8d25",data:t.data})}}):i&&i()}}});try{var uploadVideo=function(t){this.blockUploadPreFn=t.blockUploadPreFn,this.blockUploadErrFn=t.blockUploadErrFn,this.blockUploadDoneFn=t.blockUploadDoneFn,this.uploadPreFn=t.uploadPreFn,this.uploadReadyFn=t.uploadReadyFn,this.uploadDoneFn=t.uploadDoneFn,this.uploadErrFn=t.uploadErrFn};uploadVideo.prototype={blockSize:2097152,ajaxInstance:null,uploadProcess:0,uploadPause:0,maxRetry:5,retryIndex:0,blockCount:0,uploadUrl:"/video/pc/uploadBlock",upload:function(t){this.file=t,this.uploadProcess=1,this.uploadPause=0;var e=this,i=(t.name,t.size),o=Math.ceil(i/this.blockSize);this.blockCount=o;var a=t.name.split("."),n=a[a.length-1];e.uploadPreFn&&e.uploadPreFn(),console.log("\u8ba1\u7b97\u6587\u4ef6MD5\uff0c\u6bd4\u8f83\u8017\u65f6"),setTimeout(function(){e.computeBigFileFakeMd5(t,0,function(a){console.log("\u8ba1\u7b97\u6587\u4ef6MD5\uff0c\u8ba1\u7b97\u5b8c\u6bd5",a);var r={block_no:0,block_num:o,total_len:i,video_md5:a,video_format:n,file:t,upload_id:""};e.uploadReadyFn&&e.uploadReadyFn(r),e.uploadSinglePart(r)})},1)},computeBigFileFakeMd5:function(t,e,i){var o=this;this.fileAllPartsMD5||(this.fileAllPartsMD5=""),this.computeFileMd5(t,e,e+o.blockSize,function(a){if(console.log("\u8ba1\u7b97\u6587\u4ef6\u5355\u5757MD5\uff0c\u8ba1\u7b97\u5b8c\u6bd5",a),console.log("\u76ee\u524d\u8ba1\u7b97\u5927\u5c0f",e,"\u4e00\u5171",t.size),o.fileAllPartsMD5+=a,e>=t.size){var n=CryptoJS.algo.MD5.create();n.update(CryptoJS.enc.Latin1.parse(o.fileAllPartsMD5));var r=n.finalize();i&&i(r.toString())}else e+=o.blockSize,o.computeBigFileFakeMd5(t,e,i)})},computeFileMd5:function(t,e,i,o){console.log(typeof t);var a=CryptoJS.algo.MD5.create(),n=new FileReader;if(n.onload=function(t){a.update(CryptoJS.enc.Latin1.parse(t.target.result));var e=a.finalize();console.log(e.toString()),o(e.toString())},t.slice)var t=t.slice(e,i);else if(t.webkitSlice)var t=t.webkitSlice(e,i);else if(File.prototype.mozSlice)var t=blofileBlobb.mozSlice(e,i);n.readAsBinaryString(t)},cancel:function(){this.ajaxInstance&&this.ajaxInstance.abort(),this.uploadPause=1,this.uploadProcess=3},uploadSinglePart:function(t){var e=t.block_no,i=t.block_num,o=t.file;if(e>i)return!0;var a=this;a.uploadProcess=2;var n=e*this.blockSize,r=Math.min(o.size,n+this.blockSize),s=new FormData,l=o.slice(n,r);console.log("\u8ba1\u7b97\u5206\u5757MD5\uff0c\u7565\u5fae\u8017\u65f6","start",n,"end",r),this.computeFileMd5(o,n,r,function(d){var c=d;console.log("\u8ba1\u7b97\u5206\u5757MD5\uff0c\u8ba1\u7b97\u5b8c\u6bd5",d),s.append("block_no",e+1),s.append("block_num",i),s.append("block_md5",c),s.append("block_len",r-n),s.append("total_len",o.size),s.append("video_md5",t.video_md5),s.append("video_format",t.video_format),s.append("upload_id",t.upload_id),s.append("tbs",PageData.tbs),s.append("block_data",l),a.blockUploadPreFn&&a.blockUploadPreFn(s),a.ajaxInstance=$.ajax({url:a.uploadUrl,type:"POST",data:s,async:!0,processData:!1,contentType:!1,success:function(o){if(0!=o.no)return a.retryIndex>a.maxRetry?(console.log("error:",o," \u91cd\u8bd5\u5931\u8d25\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458"),alert(o.msg?o.msg:JSON.stringify(o)),a.uploadProcess=5,a.blockUploadErrFn&&a.blockUploadErrFn(s),a.uploadErrFn&&a.uploadErrFn(t)):(console.log("error:",o,a.retryIndex+"\u6b21\u91cd\u8bd5\u4e2d... "),a.retryIndex++,a.blockUploadErrFn&&a.blockUploadErrFn(t,a.retryIndex),setTimeout(function(){a.uploadSinglePart(t)},200*a.retryIndex)),!1;var n=o.data;if(console.log("\u4e0a\u4f20\u5206\u5757\u6210\u529f:"+e+" / "+i),a.blockUploadDoneFn&&a.blockUploadDoneFn(e+1,i),e++,n.video_url||e>a.blockCount){console.log("\u4e0a\u4f20\u6587\u4ef6\u6210\u529f:"+n.video_url),a.uploadProcess=4;var r={video_md5:t.video_md5,block_num:t.block_num,video_url:n.video_url,total_len:t.total_len,video_format:t.video_format,upload_id:t.upload_id};return a.uploadDoneFn&&a.uploadDoneFn(!0,r),!0}return 1==a.uploadPause?(a.uploadProcess=5,!1):(n&&n.upload_id&&(t.upload_id=n.upload_id),t.block_no=e,s=null,a.uploadSinglePart(_.extend({},t)),void(t=null))},error:function(e){a.uploadErrFn&&a.uploadErrFn(t),a.blockUploadErrFn&&a.blockUploadErrFn(s),a.mDialog.element.find("[video-poster-content-process-uploading]").hide(),a.mDialog.element.find("[video-poster-content-process-fail]").show(),alert(e?JSON.stringify(e):"\u6587\u4ef6\u4e0a\u4f20\u5931\u8d25"),console.error("error:",e)}})})}}}catch(err){}_.Module.define({path:"ueditor/widget/ueditor_video",requires:["ueditor/widget/ueditor_video/ueditor_url_video","ueditor/widget/ueditor_video/ueditor_local_video"],sub:{$btn:null,videoUploadBubble:null,tempHTML:['<div class="v_layer_content j_content">','<ul class="v_ul clearfix"><li class="v_url_btn" ><a href="#" onclick="return false;" class="v_url_bg"></a></li><li class="v_local_btn"><a a href="#" onclick="return false;"  class="v_url_container" ></a><a href="#" onclick="return false;" class="v_local_bg" ></a></li></ul></div>'].join(""),initial:function(t){if(this.fuckCDN=!0,this.option=t,t.isVideoPgcUser){this.$btn=t.$btn?t.$btn:"";var e=$.cookie(window.PageData.user.id+"_FRSVideoUploadTip");e||this.initVideoUploadBubble({wrap:t.$btn}),this.bindNewEvent()}else this.initVideoUrlLayer(t)},initVideoUrlLayer:function(t){this.isOfficialFroum=t.isOfficialFroum,this.CAN_LOCAL_UPLOAD=t.CAN_LOCAL_UPLOAD,this.init(t.container)},init:function(t){var e=this,i=this.CAN_LOCAL_UPLOAD;e.j_con=t,1==i?e.bindEvent():e.urlVideo?e.urlVideo.init(e.j_con):(e.urlVideo=e.requireInstance("ueditor/widget/ueditor_video/ueditor_url_video",{parent:e}),e.urlVideo.init(e.j_con))},bindEvent:function(){var t=this;t.j_con.find(".v_url_btn").click(function(e){e.preventDefault(),e.stopPropagation(),t.urlVideo?t.urlVideo.init(t.j_con):(t.urlVideo=t.requireInstance("ueditor/widget/ueditor_video/ueditor_url_video",{parent:t}),t.urlVideo.init(t.j_con)),t.trigger("closelocalvideo")});var e=t.j_con.find(".v_url_container");e.mouseenter(function(){e.addClass("v_url_container_hover")}).mouseleave(function(){e.removeClass("v_url_container_hover")}),t.localVideo?t.localVideo.init({parent:t,j_con:t.j_con.find(".v_url_container")[0]}):t.localVideo=t.requireInstance("ueditor/widget/ueditor_video/ueditor_local_video",{parent:t,j_con:t.j_con.find(".v_url_container")[0]})},destroy:function(){this.j_con=null},initVideoUploadBubble:function(t){var e={arrow_dir:"up",bubble_css:{top:15,left:-50,width:140,height:50,zIndex:6e4},arrow_pos:{left:65},wrap:t.wrap,closeBtn:!0,content:"\u7535\u8111\u4e5f\u53ef\u4ee5\u53d1\u89c6\u9891\u8d34\u5566"};this.videoUploadBubble=this.requireInstance("tbui/widget/bubble_tip",[e]),this.videoUploadBubble.showBubble(),$.cookie(window.PageData.user.id+"_FRSVideoUploadTip",1,31536e3),this.videoUploadBubble.bind("onclose",function(){return!0});var i=this;setTimeout(function(){i.videoUploadBubble.closeBubble()},5e3)},bindNewEvent:function(){var t=this;this.$btn&&this.$btn.on("click",".edui-icon-video",function(){t.videoUploadBubble&&t.videoUploadBubble.closeBubble(),this.uploadVideo=t.requireInstance("ueditor/widget/ueditor_video/ueditor_video_dialog",{parent:t,editor:t.option.editor,model:t.option.model})}).on("click",".ui_bubble_closed",function(){t.videoUploadBubble&&t.videoUploadBubble.closeBubble()})}}});_.Module.define({path:"ueditor/widget/video",requires:["poster/widget/post_manager","ueditor/widget/ueditor_video"],sub:{initial:function(e,t,i){e=e||window.UE,t=t||window.EditorUI,i||(i={}),this.fuckCDN=!0,this.isVideoPgcUser=i.is_video_pgc_user,this.initPlugin(e,this),this.initLayer(t,this),this.initModel(t,this),this.initAdapter(e,t,this),this.postManager=this.requireInstance("poster/widget/post_manager"),this.initPostDataProcessor(),this.initPostValidate()},initPlugin:function(e){this.isVideoPgcUser;e.plugins.video=function(){function t(e){e.title=e.title||e.swf_url,e.vsrc=e.html_url,e.url=decodeURI(e.html_url),e.url.toLowerCase().indexOf("baidu.com")>-1?(e.width=480,e.height=410):e.url.toLowerCase().indexOf("player.video.qiyi.com")>-1?(e.width=500,e.height=415):(e.width=500,e.height=450);var t='<img unselectable="on" class="BDE_Flash" src="//web.archive.org/web/20201117141157/https://tb2.bdstatic.com/tb/img/flash_335fbc8.png" data-video_url="#{url}" data-vsrc="#{vsrc}" data-pkey="#{pkey}" data-vpic="#{vpic}" title="#{title}" width="219" height="175" data-width="#{width}" data-height="#{height}"'+("null"!=e.html5?' data-html5_url="#{html5}"':"")+"><br/>",i=$.tb.format(t,e);return i}function i(e){return e.replace(/<img[^>]*class="?(?:BDE_Flash|BDE_Music)[^>]*>/gi,function(e){var t=e.replace(/.* title\="?([^\s">]+).*/i,"$1").replace(/&amp;/gi,"&"),i=e.replace(/.* data\-width\="?([^\s">]+).*/i,"$1"),a=e.replace(/.* data\-height\="?([^\s">]+).*/i,"$1"),r=e.replace(/.* class="?([^\s">]+).*/i,"$1"),n="",o="",s='<embed allowfullscreen="true" pluginspage="https://web.archive.org/web/20201117141157/http://www.macromedia.com/go/getflashplayer" type="application/x-shockwave-flash" wmode="transparent" play="true" loop="false" menu="false" allowscriptaccess="never" scale="noborder"'+(0==t.toLowerCase().indexOf("https://web.archive.org/web/20201117141157/http://player.ku6.com")?' flashvars="adss=0"':" ")+'src="'+t+'"  class="'+r+'" width="'+i+'" height="'+a+'" ';if("BDE_Flash"==r){n=e.replace(/.* data-video_url="?([^\s">]+).*/i,"$1").replace(/&amp;/gi,"&"),o=e.match(/.* data-html5_url="?([^\s">]+).*/i),o&&(o=o[1].replace(/&amp;/gi,"&"),s+=' vhsrc="'+o+'"');var d=e.replace(/.* data-vsrc="?([^\s">]+).*/i,"$1").replace(/&amp;/gi,"&"),l=e.replace(/.* data-pkey="?([^\s">]+).*/i,"$1"),c=e.replace(/.* data-vpic="?([^\s">]+).*/i,"$1").replace(/&amp;/gi,"&");"null"!=l&&l.length<40&&(s+=' vsrc="'+d+'"',"null"!=c&&(s+=' vpic="'+c+'"'),s+=' pkey="'+l+'"')}return s+=" ><br/>"})}function a(t,a){e.utils.each(t.getNodesByTagName("img"),function(t){if("BDE_Flash"==t.getAttr("class")&&a){var r=i(t.toHtml());t.parentNode.replaceChild(e.uNode.createElement(r),t)}})}var r=this;r.addOutputRule(function(e){a(e,!0)},!0),r.addInputRule(function(e){a(e,!1)}),r.getVideoNumber=function(){return $(r.body).find(".BDE_Flash").size()},r.hasLocalVideo=function(){return $(r.body).find(".BDE_Flash").filter(function(){var e=$(this).data("pkey");return null!=e&&""!=e&&"pkey_"==e.substr(0,5)}).size()>0},r.getVideoUrl=function(){var e=$(r.body).find(".BDE_Flash");return e.size()>0?e.data("vsrc"):null},r.getFileId=function(){var e=r.getVideoUrl(),t=r.hasLocalVideo();return t&&e.length>0?e.substr(5):""},r.commands.insertvideo={execCommand:function(i,a){a=e.utils.isArray(a)?a:[a];for(var n,o=[],s=0,d=a.length;d>s;s++)n=a[s],o.push(t(n));r.execCommand("inserthtml",o.join(""),!0)},queryCommandState:function(){var e=r.selection.getRange().getClosedNode(),t=e&&"BDE_Video"==e.className;return t?1:0}},r.addListener("aftergetcontent",function(t,i){e.utils.each(i.getNodesByTagName("embed"),function(e){if("BDE_Flash"==e.getAttr("class")){e.setAttr("src",e.getAttr("src").replace(/&amp;/g,"&"));var t=e.getAttr("vsrc");t&&e.setAttr("vsrc",t.replace(/&amp;/g,"&"));var i=e.getAttr("vhsrc");i&&e.setAttr("vhsrc",i.replace(/&amp;/g,"&"))}})});var n=r.getExtendContent&&r.getExtendContent;r.getExtendContent=function(){var e={videoNumber:r.getVideoNumber(),hasLocalVideo:r.hasLocalVideo(),videoUrl:r.getVideoUrl(),fileId:r.getFileId()};return $.extend(n?n():{},e)}}},initLayer:function(e,t){var i=this.isVideoPgcUser;e.registerLayer("video",function(e,a,r){if(i)return{};this.fuckCDN=!0;var n={can_local_upload:'<div class="j_video_container video_container"><div class="v_layer_content j_content"><ul class="v_ul clearfix"><li class="v_url_btn" ><a href="#" onclick="return false;" class="v_url_bg"></a></li><li class="v_local_btn"><a a href="#" onclick="return false;"  class="v_url_container" ></a><a href="#" onclick="return false;" class="v_local_bg" ></a></li></ul></div></div>',normal:['<div class="j_video_container video_container"><div class="v_layer_content j_content">','<div style="padding:30px 0px 5px 30px" class="clearfix"><input type="text" class="v_layer_input form-control j_input" value="\u8bf7\u76f4\u63a5\u8f93\u5165\u89c6\u9891\u64ad\u653e\u9875\u5730\u5740"  ><a href="#" style="float:left;margin-left:5px;" class="btn_default btn_middle j_btn">\u63d2\u5165\u89c6\u9891</a></div>','<div  class="j_error_tip v_error_tip" style="display:none;padding-left:30px;line-height:22px;"></div>','<div style="color:#999;line-height:22px;padding-left:30px;" class="v_layer_text j_layer_text">\u76ee\u524d\u652f\u6301\u7231\u5947\u827a\u3001\u7f8e\u62cd\u3001\u4f18\u9177\u3001\u571f\u8c46\u3001\u641c\u72d0\u3001\u817e\u8baf\u3001\u4e50\u89c6\u7b49\u89c6\u9891\u7f51\u7ad9\u94fe\u63a5</div>',"</div></div>"].join("")},o=(r.can_local_upload,$.eduipopup().on("beforeshow",function(){var i=o.edui().getBodyContainer(),a=$(n.normal);if(i.html(""),i.append(a),e.getValue("UeditorVideo"))e.getValue("UeditorVideo").init(a);else{var r=t.requireInstance("ueditor/widget/ueditor_video",[{container:a,CAN_LOCAL_UPLOAD:0}]);e.setValue("UeditorVideo",r),r.bind("insertvideo",function(t,i){e.trigger("insertvideo",i)})}}).on("afterhide",function(){var t=e.getValue("UeditorVideo");t&&t.trigger("closelocalvideo")}));return e.setWidget(o),o})},initModel:function(e){this.isVideoPgcUser;e.registerModel("video",function(){var t=new e.EditorModel;this.fuckCDN=!0,e.bindLayer("video",t);var i=$.eduibutton({icon:"video",title:"\u63d2\u5165\u89c6\u9891"});return t.setButton(i),t})},initAdapter:function(e,t,i){var a=this.isVideoPgcUser;e.registerUI("video",function(e){var r=this;this.fuckCDN=!0;var n=t.getModel(e),o=n.getButton();if(a){var s=i.requireInstance("ueditor/widget/ueditor_video",[{$btn:o,isVideoPgcUser:a,editor:r,model:n}]);s.bind("insertvideo",function(e,t){n.trigger("insertvideo",t)}),n.bind("insertvideo",function(e,t){r.execCommand("insertvideo",t)})}else{var d=n.getWidget();o.click(function(){d.parent().length||r.$container.find(".edui-dialog-container").append(d),"none"===d.css("display")?d.css("zIndex",r.options.zIndex+1).edui().show(o,{offsetTop:-10,offsetLeft:85,caretLeft:105,caretTop:-8}):d.edui().hide(),$.stats.track("video_btn","ueditor")}),d.edui().register("click",d,function(e){o[0]===e.target||$.contains(o[0],e.target)||d.edui().hide()}),n.bind("insertvideo",function(e,t){r.execCommand("insertvideo",t),d.edui().hide()})}return n.getButton()})},initPostDataProcessor:function(){this.postManager.addPostDataProcess(function(e){var t=(e.context||{},e.editorExtendContent||{}),i={};return t.videoNumber>0?(i.video_url=t.videoUrl,t.hasLocalVideo&&(i.file_id=t.fileId),i):!1})},initPostValidate:function(){this.postManager.addPostValidate(function(e){var t=(e.context||{},e.editorExtendContent||{});if(t.videoNumber>1){var i="\u62b1\u6b49\uff0c\u6bcf\u5c42\u697c\u63d2\u5165\u7684\u89c6\u9891\u4e2a\u6570\u4e0d\u80fd\u8d85\u8fc71\u4e2a\uff0c\u8bf7\u4fee\u6539\u540e\u91cd\u65b0\u63d0\u4ea4";return i}return!0})}}});_.Module.define({path:"tbui/widget/sketchpad/sketchpad_core",sub:{template:'<canvas class="sketchpad_bg"></canvas>         <canvas class="sketchpad_result"></canvas>         <canvas class="sketchpad_mask"></canvas>         <textarea class="sketchpad_text_input" style="display: none;"></textarea>',defaultOptions:{width:400,height:300,fixCanvas:!1,onhistorychange:function(){}},initial:function(t,e){e=$.extend({},this.defaultOptions,e);var i=this;this.element=$(t);var s=$(this.template);s.filter("canvas").each(function(){this.width=e.width,this.height=e.height}),this.element.addClass("sketchpad").css({width:e.width,height:e.height}).append(s),this.fixCanvas=e.fixCanvas,this.history=[],this.onhistorychange=e.onhistorychange,this.redoStack=[],this.clearState=!1,this.bgCanvas=this.element.find(".sketchpad_bg"),this.bgContext=this.bgCanvas[0].getContext("2d"),this.mouseDownHandler=this._mouseDownLineHandler,this.mouseUpHandler=this._mouseUpLineHandler,this.mouseMoveHandler=this._mouseMoveLineHandler,this.initCanvas(),this.initTextInput(),this.currentCommand=null,this.setPaintType("brush"),this.setPaintShape("rect"),this.setLineWidth(3),this.setPaintColor("black"),this.setPaintFontSize(12),this.refreshPosition(),this.element.on("dragover",function(t){t.preventDefault(),t.stopPropagation()}),this.element[0].addEventListener("drop",function(t){t.preventDefault(),t.stopPropagation();var e=t.dataTransfer.files[0],s=new FileReader;s.onload=function(t){var e=new Image;e.onload=function(){i.setBackgroundImage(e)},e.src=t.target.result},s.readAsDataURL(e)})},initTextInput:function(){this.textInput=this.element.find(".sketchpad_text_input")},initCanvas:function(){var t=this;this.resultCanvas=this.element.find(".sketchpad_result"),this.resultContext=this.resultCanvas[0].getContext("2d"),this.maskCanvas=this.element.find(".sketchpad_mask"),this.maskContext=this.maskCanvas[0].getContext("2d"),this.maskCanvas.on("click",function(e){if("text"==t.paintType)if(t.textDrawing){t.textDrawing=!1;var i=t.textInput.val();if(i.length>0){var s=t.textInput[0].offsetLeft+1,n=t.textInput[0].offsetTop,o=t.drawText(t.resultContext,i,s,n,t.textInput.innerWidth());t._pushHistory(o),t.textInput.val("")}t.textInput.hide()}else{t.textDrawing=!0;var a=e.clientX-t.offset.left+(window.pageXOffset||document.body.scrollLeft||document.documentElement.scrollLeft),r=e.clientY-t.offset.top+(window.pageYOffset||document.body.scrollTop||document.documentElement.scrollTop);t.textInput.css({left:a,top:r}).show().focus()}}),this.maskCanvas.on("mousedown",function(e){e.preventDefault(),t.mouseDownHandler(e)});var e=function(e){t.mouseUpHandler(e)},i=function(e){t.mouseMoveHandler(e)};$(document).on("mouseup",e).on("mousemove",i),t.clearEvents=function(){$(document).unbind("mouseup",e).unbind("mousemove",i)}},_mouseDownLineHandler:function(t){var e=this;e.drawing=!0,e.iLastX=t.clientX-e.offset.left+(window.pageXOffset||document.body.scrollLeft||document.documentElement.scrollLeft),e.iLastY=t.clientY-e.offset.top+(window.pageYOffset||document.body.scrollTop||document.documentElement.scrollTop),e.drawPoint(e.resultContext,e.iLastX,e.iLastY,e.lineWidth),null==e.currentCommand&&(e.currentCommand={type:"brush",path:[],color:e.paintColor,lineWidth:e.lineWidth,clearState:e.clearState,startPoint:{x:e.iLastX,y:e.iLastY,diameter:e.lineWidth}})},_mouseMoveLineHandler:function(t){var e=this;if(e.drawing){var i=t.clientX-e.offset.left+(window.pageXOffset||document.body.scrollLeft||document.documentElement.scrollLeft),s=t.clientY-e.offset.top+(window.pageYOffset||document.body.scrollTop||document.documentElement.scrollTop),n={fromX:e.iLastX,fromY:e.iLastY,toX:i,toY:s};e.drawLine(e.resultContext,n),e.currentCommand.path.push(n),e.iLastX=i,e.iLastY=s}},_mouseUpLineHandler:function(){var t=this;t.drawing&&(t.drawing=!1,t.iLastX=-1,t.iLastY=-1,t._pushHistory(t.currentCommand),t.currentCommand=null)},_mouseDownShapeHandler:function(t){var e=this;e.drawing=!0,e.iLastX=t.clientX-e.offset.left+(window.pageXOffset||document.body.scrollLeft||document.documentElement.scrollLeft),e.iLastY=t.clientY-e.offset.top+(window.pageYOffset||document.body.scrollTop||document.documentElement.scrollTop)},_mouseMoveShapeHandler:function(t){var e=this;if(e.drawing){e._clear(e.maskContext);var i=t.clientX-e.offset.left+(window.pageXOffset||document.body.scrollLeft||document.documentElement.scrollLeft),s=t.clientY-e.offset.top+(window.pageYOffset||document.body.scrollTop||document.documentElement.scrollTop);e.currentCommand=e.drawShape(e.maskContext,e.iLastX,e.iLastY,i-e.iLastX,s-e.iLastY)}},_mouseUpShapeHandler:function(){var t=this;t.drawing&&(t.drawing=!1,t.iLastX=-1,t.iLastY=-1,t._clear(t.maskContext),t.currentCommand&&(t.doCommand(t.currentCommand),t._pushHistory(t.currentCommand),t.currentCommand=null))},_mouseDownTextHandler:function(){},_mouseMoveTextHandler:function(){},_mouseUpTextHandler:function(){},_pushHistory:function(t){this.history.push(t),this.onhistorychange(this.history,this.redoStack)},drawLine:function(t,e){t.beginPath(),t.moveTo(e.fromX,e.fromY),t.lineTo(e.toX,e.toY),t.stroke()},drawPoint:function(t,e,i,s){t.beginPath(),t.arc(e,i,s/2,0,2*Math.PI,!0),t.closePath(),t.fill()},drawPath:function(t,e){var i=e.startPoint;this.drawPoint(t,i.x,i.y,i.diameter);for(var s=e.path,n=0,o=s.length;o>n;n++)this.drawLine(t,s[n])},drawRect:function(t,e,i,s,n){return t.strokeRect(e,i,s,n),{type:"shape",shape:"rect",x:e,y:i,width:s,height:n,color:this.paintColor,lineWidth:this.lineWidth}},drawEllipse:function(t,e,i,s,n){var o=.5522848,a=s/2*o,r=n/2*o,l=e+s,h=i+n,d=e+s/2,u=i+n/2;return t.beginPath(),t.moveTo(e,u),t.bezierCurveTo(e,u-r,d-a,i,d,i),t.bezierCurveTo(d+a,i,l,u-r,l,u),t.bezierCurveTo(l,u+r,d+a,h,d,h),t.bezierCurveTo(d-a,h,e,u+r,e,u),t.closePath(),t.stroke(),{type:"shape",shape:"ellipse",x:e,y:i,width:s,height:n,color:this.paintColor,lineWidth:this.lineWidth}},drawText:function(t,e,i,s,n,o){o=o||this.fontSize;var a=e.split(""),r=1.2*o,l=s;l+=o;for(var h=0,d=a.length,u="";d>h;h++){var c=a[h];if("\n"==c)t.fillText(u,i,l),u="",l+=r;else{var p=u+c,f=t.measureText(p),m=f.width;m>n?(t.fillText(u,i,l),u=c,l+=r):u=p}}return t.fillText(u,i,l),{type:"text",x:i,y:s,text:e,maxWidth:n,color:this.paintColor,fontSize:o}},setPaintType:function(t){this.paintType=t,"shape"==t?(this.mouseDownHandler=this._mouseDownShapeHandler,this.mouseUpHandler=this._mouseUpShapeHandler,this.mouseMoveHandler=this._mouseMoveShapeHandler):"brush"==t?(this.mouseDownHandler=this._mouseDownLineHandler,this.mouseUpHandler=this._mouseUpLineHandler,this.mouseMoveHandler=this._mouseMoveLineHandler):(this.mouseDownHandler=this._mouseDownTextHandler,this.mouseUpHandler=this._mouseUpTextHandler,this.mouseMoveHandler=this._mouseMoveTextHandler),"text"==t?this.element.css("cursor","text"):this.element.css("cursor","crosshair")},setClear:function(t){this.clearState=t,this.resultContext.globalCompositeOperation=t?"destination-out":"source-over"},_setPaintColor:function(t){this.resultContext.strokeStyle=t,this.maskContext.strokeStyle=t,this.resultContext.fillStyle=t,this.maskContext.fillStyle=t,this.textInput.css("color",t)},setPaintColor:function(t){this._setPaintColor(t),this.paintColor=t},_setLineWidth:function(t){this.resultContext.lineWidth=t,this.maskContext.lineWidth=t,this.resultContext.lineCap="round",this.maskContext.lineCap="round"},setLineWidth:function(t){this._setLineWidth(t),this.lineWidth=t},setPaintShape:function(t){"rect"==t?this.drawShape=this.drawRect:"ellipse"==t&&(this.drawShape=this.drawEllipse)},setBackgroundImage:function(t){if(this.fixCanvas){var e=this.width/this.height,i=null,s=0,n=0;(t.width>this.width||t.height>this.height)&&(t.width/t.height>e?(i=t.width/this.width,t.width=this.width,t.height=t.height/i):(i=t.height/this.height,t.height=this.height,t.width=t.width/i)),s=(this.width-t.width)/2,n=(this.height-t.height)/2,this._clear(this.bgContext),this.bgContext.drawImage(t,s,n,t.width,t.height)}else this.bgCanvas.tbattr({width:t.width,height:t.height}),this.resultCanvas.tbattr({width:t.width,height:t.height}),this.maskCanvas.tbattr({width:t.width,height:t.height}),this.element.css({width:t.width,height:t.height}),this.width=t.width,this.height=t.height,this.bgContext.drawImage(t,0,0);this.setPaintColor(this.paintColor),this.setLineWidth(this.lineWidth),this.setPaintFontSize(this.fontSize)},removeBackgroundImage:function(){this._clear(this.bgContext)},_setPaintFontSize:function(t){this.resultContext.font=t+"px '\u5b8b\u4f53'",this.textInput.css("fontSize",t)},setPaintFontSize:function(t){this._setPaintFontSize(t),this.fontSize=t},doCommand:function(t){this.resultContext.save(),this.resultContext.strokeStyle=t.color,this.resultContext.fillStyle=t.color,"text"==t.type?this.resultContext.font=t.fontSize+"px '\u5b8b\u4f53'":this.resultContext.lineWidth=t.lineWidth,"shape"==t.type&&"rect"==t.shape?this.resultContext.strokeRect(t.x,t.y,t.width,t.height):"shape"==t.type&&"ellipse"==t.shape?this.drawEllipse(this.resultContext,t.x,t.y,t.width,t.height):"text"==t.type?this.drawText(this.resultContext,t.text,t.x,t.y,t.maxWidth,t.fontSize):"brush"==t.type&&(this.resultContext.globalCompositeOperation=t.clearState?"destination-out":"source-over",this.drawPath(this.resultContext,t)),this.resultContext.restore()},_clear:function(t){t.clearRect(0,0,this.width,this.height)},clear:function(){this._clear(this.resultContext),this.history.length=0,this.redoStack.length=0,this.onhistorychange(this.history,this.redoStack)},undo:function(){this._clear(this.resultContext),this.redoStack.push(this.history.pop()),this.onhistorychange(this.history,this.redoStack);for(var t=0,e=this.history.length;e>t;t++)this.doCommand(this.history[t])},redo:function(){var t=this.redoStack.pop();null!=t&&(this.doCommand(t),this._pushHistory(t))},destroy:function(){this.clearEvents(),this.element.html("")},refreshPosition:function(){this.offset=this.resultCanvas.offset(),this.width=this.resultCanvas.width(),this.height=this.resultCanvas.height()},getResult:function(t){return t=t||"image/png",this.resultCanvas[0].toDataURL(t)},_dataURLtoBlob:function(t){for(var e=atob(t.split(",")[1]),i=t.split(",")[0].split(":")[1].split(";")[0],s=new ArrayBuffer(e.length),n=new Uint8Array(s),o=0;o<e.length;o++)n[o]=e.charCodeAt(o);var a=window.MozBlobBuilder||window.WebKitBlobBuilder||window.BlobBuilder;if(a){var r=new a;return r.append(s),r.getBlob(i)}return Blob?new Blob([s],{type:i}):null},getResultAsBlob:function(t){return t=t||"image/png",this._dataURLtoBlob(this.getResult(),t)}}}),_.Module.define({path:"tbui/widget/sketchpad",requires:["tbui/widget/sketchpad/sketchpad_core","tbui/widget/image_uploader_manager"],sub:{template:['<div class="tbui_sketchpad">','<div class="tb_picasso_content"></div>','<div class="sketchpad_v_toolbar">',"<ul>","<li>",'<ul class="color_panel clearfix">','<li><div style="background: #FFFFFF;border: 1px solid #FFFFFF;"></div></li>','<li><div style="background: #B5B5B5;border: 1px solid #B5B5B5;"></div></li>','<li><div style="background: #F79579;border: 1px solid #F79579;"></div></li>','<li><div style="background: #FDC58B;border: 1px solid #FDC58B;"></div></li>','<li><div style="background: #80C99C;border: 1px solid #80C99C;"></div></li>','<li><div style="background: #000000;border: 1px solid #000000;"></div></li>','<li><div style="background: #626262;border: 1px solid #626262;"></div></li>','<li class="focus"><div style="background: #ED2329;border: 1px solid #ED2329;"></div></li>','<li><div style="background: #F79323;border: 1px solid #F79323;"></div></li>','<li><div style="background: #00A451;border: 1px solid #00A451;"></div></li>','<li><div style="background: #6CCEF7;border: 1px solid #6CCEF7;"></div></li>','<li><div style="background: #F499C0;border: 1px solid #F499C0;"></div></li>','<li><div style="background: #00ACEE;border: 1px solid #00ACEE;"></div></li>','<li><div style="background: #EC008B;border: 1px solid #EC008B;"></div></li>','<li><div style="background: #D8003D;border: 1px solid #D8003D;"></div></li>',"</ul>","</li>",'<li class="sketchpad_button_brush">','<ul class="sketchpad_brush_panel clearfix">','<li class="brush_button brush_small" data-brush-type="brush">1</li>','<li class="brush_button brush_middle focus" data-brush-type="brush">3</li>','<li class="brush_button brush_big" data-brush-type="brush">5</li>',"</ul>","</li>",'<li class="sketchpad_button_eraser">','<ul class="sketchpad_brush_panel clearfix">','<li class="brush_button brush_small" data-brush-type="eraser">1</li>','<li class="brush_button brush_middle" data-brush-type="eraser">3</li>','<li class="brush_button brush_big" data-brush-type="eraser">5</li>',"</ul>","</li>","<li>",'<div class="sketchpad_bg_input">','<button type="button" class="sketchpad_add_bg">\u6dfb\u52a0\u80cc\u666f</button>','<input type="file" class="sketchpad_image_input" />',"</div>","</li>","<li>",'<button type="button" class="sketchpad_remove_bg disabled">\u5220\u9664\u80cc\u666f</button>',"</li>","</ul>","</div>",'<div class="sketchpad_h_toolbar">','<button type="button" class="sketchpad_undo" disabled="disabled">\u4e0a\u4e00\u6b65</button>','<button type="button" class="sketchpad_redo" disabled="disabled">\u4e0b\u4e00\u6b65</button>','<button type="button" class="sketchpad_clear" disabled="disabled">\u6e05\u7a7a</button>','<button type="button" class="sketchpad_finish">\u753b\u597d\u4e86</button>',"</div>",'<canvas class="sketchpad_sign" width="416" height="335"  style="display: none;" ></canvas>','<div class="picasso_message" style="display: none;">',"<p>\u5c1a\u672a\u4f5c\u753b\uff0c\u767d\u7eb8\u4e00\u5f20\uff01&gt;.&lt;</p>",'<p><button type="button" class="picasso_message_apply">\u786e\u5b9a</button></p>',"</div>","</div>"].join(""),_tbsURL:"//web.archive.org/web/20201117141157/https://tieba.baidu.com/dc/common/imgtbs",_uploadURL:"https://web.archive.org/web/20201117141157/https://uploadphotos.baidu.com/upload/pic",picItemPath:"https://web.archive.org/web/20201117141157/https://imgsa.baidu.com/forum/pic/item/",uploading:!1,initial:function(t){var e=this;e.container=$(t),e.container.html(this.template),e.currentColor="#ED2329",e.brushType="brush";var i=e.container.find(".tb_picasso_content");this.sketchpad=this.requireInstance("SketchpadCore",[i,{fixCanvas:!0,onhistorychange:function(t,i){0==t.length?(e.undoButton.tbprop("disabled",!0),e.clearButton.tbprop("disabled",!0)):(e.undoButton.tbprop("disabled",!1),e.clearButton.tbprop("disabled",!1)),0==i.length?e.redoButton.tbprop("disabled",!0):e.redoButton.tbprop("disabled",!1)}}]),this.sketchpad.setPaintColor("#ED2329"),e.container.find(".color_panel").on("click","div",function(){var t=this.style.backgroundColor;$(this).parent().siblings(".focus").removeClass("focus").end().addClass("focus"),e.currentColor=t,"brush"==e.brushType&&e.sketchpad.setPaintColor(t)}),e.brushButtons=e.container.find(".brush_button"),e.brushButtons.click(function(){e.brushButtons.filter(".focus").removeClass("focus");var t=$(this).addClass("focus"),i=t.data("brushType"),s=t.text()-0;e.sketchpad.setLineWidth(s),"eraser"==i?(e.sketchpad.setClear(!0),e.sketchpad.setPaintColor("black")):(e.sketchpad.setClear(!1),e.sketchpad.setLineWidth(s),e.sketchpad.setPaintColor(e.currentColor)),e.brushType=i}),e.deleteBgButton=e.container.find(".sketchpad_remove_bg").click(function(){e.sketchpad.removeBackgroundImage(),e.deleteBgButton.addClass("disabled")}),e.undoButton=e.container.find(".sketchpad_undo").click(function(){e.sketchpad.undo()}),e.redoButton=e.container.find(".sketchpad_redo").click(function(){e.sketchpad.redo()}),e.clearButton=e.container.find(".sketchpad_clear").click(function(){e.sketchpad.clear()}),e.container.find(".sketchpad_finish").click(function(){if(1==e.uploading)return!1;if(e.uploading=!0,0==e.sketchpad.history.length)return void e.messagePanel.show();var t=e.container.find(".sketchpad_sign")[0],i=t.getContext("2d");i.fillStyle="#EEEEEE",i.fillRect(0,0,416,335),i.fillStyle="#FFFFFF",i.fillRect(8,8,400,300),i.drawImage(e.sketchpad.bgCanvas[0],8,8,400,300),i.drawImage(e.sketchpad.resultCanvas[0],8,8,400,300);var s="By "+PageData.user.name,n=i.measureText(s);i.font="12px '\u5b8b\u4f53'",i.fillStyle="black",i.fillText(s,400-n.width,325),i.fillText("\u8d34\u5427\u6d82\u9e26",8,325),e._uploadImage(t)}),e.container.find(".sketchpad_add_bg").click(function(){e.container.find(".sketchpad_image_input").click()}),e.container.find(".sketchpad_image_input").change(function(){var t=this;if(t.files.length>0){var i=t.files[0];if(/^image/.test(i.type)){var s=new FileReader;s.onload=function(t){var i=new Image;i.onload=function(){e.sketchpad.setBackgroundImage(i),e.deleteBgButton.removeClass("disabled")},i.src=t.target.result},s.readAsDataURL(i)}}}),e.messagePanel=e.container.find(".picasso_message"),e.messagePanel.find(".picasso_message_apply").click(function(){e.messagePanel.hide()}),e.uploader=this.requireInstance("tbui/widget/image_uploader_manager")},_uploadImage:function(t){var e=this;e.uploader.uploadBase64(t.toDataURL().replace(/^.*base64\,/,""),function(t){var i,s;if(0!=t.errorCode)alert("\u4e0a\u4f20\u5931\u8d25\uff0c\u8bf7\u7a0d\u5019\u91cd\u8bd5");else{0!=t.response.error_code&&alert("\u4e0a\u4f20\u5931\u8d25\uff0c\u8bf7\u7a0d\u5019\u91cd\u8bd5");var n=t.response.info.host||"imgsa.baidu.com";i=t.response.info.pic_id_encode,s="https://"+n+"/forum/pic/item/"+i+".jpg",e.trigger("finish",s),e.destroy()}})},refreshPosition:function(){this.sketchpad.refreshPosition()},destroy:function(){this.sketchpad.destroy(),this.container.html("")}}});_.Module.define({path:"ueditor/widget/scrawl",requires:["tbui/widget/sketchpad"],sub:{initial:function(i,t){i=i||window.UE,t=t||window.EditorUI,this.cdnCache=!0,this.initPlugin(i,this),this.initLayer(t,this),this.initModel(t,this),this.initAdapter(i,t,this)},initPlugin:function(){},initLayer:function(i,t){i.registerLayer("scrawl",function(i,e){var a='<div style="padding:10px;">\u54a6\uff0c\u6b64\u529f\u80fd\u9700\u8981\u62e5\u6709\u672c\u54276\u7ea7\u5934\u8854\u624d\u80fd\u4f7f\u7528\uff0c\u518d\u52aa\u529b\u4e00\u4e0b\uff01&nbsp;<a href="//web.archive.org/web/20201117141157/https://tieba.baidu.com/f/like/level?ie=utf-8&kw=#{name}#level_main" target="_blank">\u67e5\u770b\u5347\u7ea7\u79d8\u7c4d</a></div>',n=function(t,e){i.trigger("insertscrawl",e)};if(i.bind("show",function(){if(e.user.level>=6){t.init({forumName:e.forum.name,userName:e.user.name});var i=t;i.unbind("ok",n),i.bind("ok",n)}}),e.user.level<6){var s=$.eduipopup().on("beforeshow",function(){var i=s.edui().getBodyContainer();i.html($.tb.format(a,e.forum))});i.setWidget(s)}})},initModel:function(i){i.registerModel("scrawl",function(){var t=new i.EditorModel;i.bindLayer("scrawl",t);var e=$.eduibutton({icon:"scrawl",title:""});return t.setButton(e),t})},initAdapter:function(i,t){i.registerUI("scrawl",function(i){var e=this,a=this,n=t.getModel(i),s=n.getButton(),o=n.getWidget();return s.click(function(){n.trigger("show"),o&&(o.parent().length||e.$container.find(".edui-dialog-container").append(o),o.css("zIndex",e.options.zIndex+1).edui().show(s,{offsetTop:-10,caretLeft:20,caretTop:-8})),$.stats.track("scrawl_btn","ueditor")}),s.edui().register("click",s,function(){o&&o.hide()}),n.bind("insertscrawl",function(i,t){a.execCommand("insertimage",[{url:t,picType:5,width:416,height:335}])}),s})},_layerModal:'<div class="p_layer_modal" id="j_sketchapad_modal" style="display:none;position:absolute;z-index:100;width:499px;height:396px;top:0px;left:0px;" ><div class="p_layer_modal_s"></div><div class="p_layer_modal_content"><p >\u60a8\u6b63\u5728\u7f16\u8f91\u6d82\u9e26\uff0c\u73b0\u5728\u9000\u51fa\u5c06\u4e0d\u4f1a\u4fdd\u5b58\uff0c\u60a8\u786e\u5b9a\u8981\u9000\u51fa\u5417\uff1f</p><div style="margin:30px auto;" ><a href="#" style="margin-right:30px;" class="btn_default btn_middle j_ok">\u786e \u5b9a</a><a href="#" class="btn_sub btn_middle j_cancel">\u53d6 \u6d88</a></div></div></div>',init:function(i){this.options=i;var t=!!document.createElement("canvas").getContext;this._closeDialog=!1;var e="undefined"!=typeof FileReader;t&&e?this.canvas():this.flash()},canvas:function(){var i=this,t=$("<div></div>");this.sketchpad=this.requireInstance("tbui/widget/sketchpad",t),t.append('<div class="p_layer_modal" id="j_sketchapad_modal" style="display:none;position:absolute;z-index:100;width:519px;height:396px;top:0px;left:0px;" ><div class="p_layer_modal_s"></div><div class="p_layer_modal_content"><p >\u60a8\u6b63\u5728\u7f16\u8f91\u6d82\u9e26\uff0c\u73b0\u5728\u9000\u51fa\u5c06\u4e0d\u4f1a\u4fdd\u5b58\uff0c\u60a8\u786e\u5b9a\u8981\u9000\u51fa\u5417\uff1f</p><div style="margin:30px auto;" ><a href="#" style="margin-right:30px;" class="btn_default btn_middle j_ok">\u786e \u5b9a</a><a href="#" class="btn_sub btn_middle j_cancel">\u53d6 \u6d88</a></div></div></div>'),this.sketchpad.bind("finish",function(t,e){i.close(),i.trigger("ok",e)}),this.dialog=new $.dialog({title:"\u6d82\u9e26",width:520,fixed:!1,draggable:!1,html:t}),this.dialog.bind("onclose",function(){return i._closeDialog?void 0:($("#j_sketchapad_modal").show(),!1)}),$.browser.msie&&$.browser.version<7&&t.closest(".dialogJcontent").css({padding:"9px 0px 9px 9px;"}),this.sketchpad.refreshPosition(),this.eventInit()},close:function(){this._closeDialog=!0,this.dialog.close()},eventInit:function(){var i=this;$("#j_sketchapad_modal").find(".j_ok").click(function(){return i._closeDialog=!0,i.dialog.close(),!1}),$("#j_sketchapad_modal").find(".j_cancel").click(function(){return i._closeDialog=!1,$("#j_sketchapad_modal").hide(),!1})},flash:function(){var i=this,t=$('<div id="sketchpad_init" style="font-size:12px;line-height:340px;text-align:center">\u6d82\u9e26\u6b63\u5728\u521d\u59cb\u5316\u4e2d\uff0c\u8bf7\u7a0d\u5019...</div><div id="flash_sketchpad" ></div>'+i._layerModal);this.dialog=new $.dialog({title:"\u6d82\u9e26",width:500,height:340,html:t}),this.dialog.show(),$.browser.msie&&$.browser.version<7&&t.closest(".dialogJcontent").css({padding:"9px 0px 9px 9px;"}),this.dialog.bind("onclose",function(){return i._closeDialog?void 0:($("#j_sketchapad_modal").show(),!1)}),this.eventInit(),i.insertFlash("flash_sketchpad","picasso","//web.archive.org/web/20201117141157/https://tb2.bdstatic.com/tb/img/picasso_df6b152.swf",490,340,{upload_url:"https://web.archive.org/web/20201117141157/https://uploadphotos.baidu.com/upload/pic",pic_url:"https://web.archive.org/web/20201117141157/https://imgsa.baidu.com/forum/pic/item/",user_name:i.options.userName,forum_name:i.options.forumName})},insertFlash:function(i,t,e,a,n,s){var o=this;new $.swf(e,{id:t,container:$("#"+i),width:a,height:n,params:{wmode:"transparent"},vars:s,callBacks:{jsReady:function(){return document.getElementById("flash_sketchpad").style.display="block",document.getElementById("sketchpad_init").style.display="none",!0},insertImage:function(i){o.trigger("ok",i),o._closeDialog=!0,o.dialog.close()}}})}}});_.Module.define({path:"ueditor/widget/jquery_caret",sub:{initial:function(){var e=document.createElement("input"),t={setSelectionRange:"setSelectionRange"in e||"selectionStart"in e,createTextRange:"createTextRange"in e||"selection"in document},n=/\r\n/g,r=/\r/g,a=function(e){return"undefined"!=typeof e.value?e.value:$(e).text()},o=function(e,t){"undefined"!=typeof e.value?e.value=t:$(e).text(t)},i=function(e,t){var n=a(e).replace(r,""),o=n.length;return"undefined"==typeof t&&(t=o),t=Math.floor(t),0>t&&(t=o+t),0>t&&(t=0),t>o&&(t=o),t},c=function(e,t){return e.hasAttribute?e.hasAttribute(t):"undefined"!=typeof e[t]},u=function(e,t,n,r){this.start=e||0,this.end=t||0,this.length=n||0,this.text=r||""};u.prototype.toString=function(){return JSON.stringify(this,null,"    ")};var s=function(e){return e.selectionStart},l=function(e){var t,r,o,i,c,u;return e.focus(),e.focus(),r=document.selection.createRange(),r&&r.parentElement()===e?(i=a(e),c=i.length,o=e.createTextRange(),o.moveToBookmark(r.getBookmark()),u=e.createTextRange(),u.collapse(!1),t=o.compareEndPoints("StartToEnd",u)>-1?i.replace(n,"\n").length:-o.moveStart("character",-c)):0},g=function(e){return e?t.setSelectionRange?s(e):t.createTextRange?l(e):void 0:void 0},f=function(e,t){e.setSelectionRange(t,t)},d=function(e,t){var n=e.createTextRange();n.move("character",t),n.select()},h=function(e,n){e.focus(),n=i(e,n),t.setSelectionRange?f(e,n):t.createTextRange&&d(e,n)},v=function(e,t){var n=g(e),i=a(e).replace(r,""),u=+(n+t.length+(i.length-n)),s=+e.getAttribute("maxlength");if(c(e,"maxlength")&&u>s){var l=t.length-(u-s);t=t.substr(0,l)}o(e,i.substr(0,n)+t+i.substr(n)),h(e,n+t.length)},m=function(e){var t=new u;t.start=e.selectionStart,t.end=e.selectionEnd;var n=Math.min(t.start,t.end),r=Math.max(t.start,t.end);return t.length=r-n,t.text=a(e).substring(n,r),t},x=function(e){var t=new u;e.focus();var n=document.selection.createRange();if(n&&n.parentElement()===e){var r,o,i,c,s=0,l=0,g=a(e);r=g.length,o=g.replace(/\r\n/g,"\n"),i=e.createTextRange(),i.moveToBookmark(n.getBookmark()),c=e.createTextRange(),c.collapse(!1),i.compareEndPoints("StartToEnd",c)>-1?s=l=r:(s=-i.moveStart("character",-r),s+=o.slice(0,s).split("\n").length-1,i.compareEndPoints("EndToEnd",c)>-1?l=r:(l=-i.moveEnd("character",-r),l+=o.slice(0,l).split("\n").length-1)),s-=g.substring(0,s).split("\r\n").length-1,l-=g.substring(0,l).split("\r\n").length-1,t.start=s,t.end=l,t.length=t.end-t.start,t.text=o.substr(t.start,t.length)}return t},p=function(e){return e?t.setSelectionRange?m(e):t.createTextRange?x(e):void 0:void 0},R=function(e,t,n){e.setSelectionRange(t,n)},S=function(e,t,n){var r=e.createTextRange();r.moveEnd("textedit",-1),r.moveStart("character",t),r.moveEnd("character",n-t),r.select()},T=function(e,n,r){n=i(e,n),r=i(e,r),t.setSelectionRange?R(e,n,r):t.createTextRange&&S(e,n,r)},b=function(e,t){var n=$(e),r=n.val(),a=p(e),o=+(a.start+t.length+(r.length-a.end)),i=+n.attr("maxlength");if(n.is("[maxlength]")&&o>i){var c=t.length-(o-i);t=t.substr(0,c)}var u=r.substr(0,a.start),s=r.substr(a.end);n.val(u+t+s);var l=a.start,g=l+t.length;T(e,a.length?l:g,g)},E=function(e){var t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)},y=function(e){var t=document.body.createTextRange();t.moveToElementText(e),t.select()},w=function(e){var n=$(e);return n.is("input, textarea")||e.select?void n.select():void(t.setSelectionRange?E(e):t.createTextRange&&y(e))},k=function(){document.selection?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges()};$.extend($.fn,{caret:function(){var e=this.filter("input, textarea");if(0===arguments.length){var t=e.get(0);return g(t)}if("number"==typeof arguments[0]){var n=arguments[0];e.each(function(e,t){h(t,n)})}else{var r=arguments[0];e.each(function(e,t){v(t,r)})}return this},range:function(){var e=this.filter("input, textarea");if(0===arguments.length){var t=e.get(0);return p(t)}if("number"==typeof arguments[0]){var n=arguments[0],r=arguments[1];e.each(function(e,t){T(t,n,r)})}else{var a=arguments[0];e.each(function(e,t){b(t,a)})}return this},selectAll:function(){return this.each(function(e,t){w(t)})}}),$.extend($,{deselectAll:function(){return k(),this}})}}});_.Module.define({path:"ueditor/widget/ueditor_topic",sub:{$container:null,initial:function(i){function t(i,t){for(var c="",n=0;n<i.length;n++)c=c+'<li class="topic_item"><span class="topic_name">'+i[n].topic_name+"</span></li>";for(var a="",n=0;n<t.length;n++)a=3>n?a+'<li class="topic_item"><span class="topic_flag_hot">'+(n+1)+'</span><span class="topic_name">'+t[n].topic_name+'</span><span class="topic_num">'+t[n].discuss_num+"</span></li>":a+'<li class="topic_item"><span class="topic_flag">'+(n+1)+'</span><span class="topic_name">'+t[n].topic_name+'</span><span class="topic_num">'+t[n].discuss_num+"</span></li>";var o='<div class="topic_list_box"><div class="topic_list_title">\u5e38\u7528\u70ed\u8bae\u8bdd\u9898</div><ul class="topic_list_common topic_list"></ul></div>',p='<div class="topic_list_box"><div class="topic_list_title">\u70ed\u8bae\u699c\u5355</div><ul class="topic_list_hot topic_list"></ul></div>',l=i.length?o+p:""+p;s.$container.find(".topic_loading").remove(),s.$container.append(l),s.$container.find(".topic_list_common").append(c),s.$container.find(".topic_list_hot").append(a),s.$container.find(".topic_item").on("click",function(){var i="#"+$(this).find(".topic_name").text()+"#";s.trigger("inserttopic",i)})}this.$container=i.container;var s=this,c='<div class="topic_header"><a href="#">#\u63d2\u5165\u6211\u7684\u65b0\u8bdd\u9898#</a></div><div class="topic_loading">\u8bdd\u9898\u52a0\u8f7d\u4e2d...</div>';this.$container.append(c),this.$container.find(".topic_header").click(function(i){i.preventDefault(),s.trigger("insertcustomtopic")}),$.ajax({type:"POST",url:"/hottopic/browse/topicList",data:{}}).done(function(i){var s=i.data.user_his_topic.topic_list.slice(0,3),c=i.data.bang_topic.topic_list.slice(0,10);t(s,c)})}}});_.Module.define({path:"ueditor/widget/topic",requires:["ueditor/widget/ueditor_topic"],sub:{initial:function(i,t){i=i||window.UE,t=t||window.EditorUI,this.initPlugin(i,this),this.initLayer(t,this),this.initModel(t,this),this.initAdapter(i,t,this)},initPlugin:function(){},initLayer:function(i,t){i.registerLayer("topic",function(i){var e='<div class="topic_container"></div>',n=$(e),o=$.eduipopup().on("beforeshow",function(){if(!i.getValue("UeditorTopic")){var e=o.edui().getBodyContainer();e.html(""),e.append(n);var r=t.requireInstance("ueditor/widget/ueditor_topic",[{container:n}]);i.setValue("UeditorTopic",r),r.bind("inserttopic",function(t,e){i.trigger("inserttopic",e)}),r.bind("insertcustomtopic",function(){i.trigger("insertcustomtopic")})}$.browser.msie&&6==$.browser.version&&$("#tb_rich_poster").find(".j_sign_id").hide()});return $.browser.msie&&6==$.browser.version&&o.on("afterhide",function(){$("#tb_rich_poster").find(".j_sign_id").show()}),i.setWidget(o),o})},initModel:function(i){i.registerModel("topic",function(){var t=new i.EditorModel;i.bindLayer("topic",t);var e=$.eduibutton({icon:"topic",title:"\u9009\u62e9\u8bdd\u9898"});return t.setButton(e),t})},initAdapter:function(i,t){i.registerUI("topic",function(i){var e=this,n=t.getModel(i),o=n.getButton(),r=n.getWidget();return o.click(function(){r.parent().length||e.$container.find(".edui-dialog-container").append(r),r.css("zIndex",e.options.zIndex+1).edui().show(o,{offsetTop:-10,offsetLeft:110,caretLeft:130,caretTop:-8}),n.trigger("aftershow"),$.stats.track("\u8bdd\u9898\u5feb\u6377\u5f39\u7a97:\u5185\u5bb9\u5904\u5f39\u7a97","\u5427\u53cb\u70ed\u8bae","frs","click",{client_type:"pc_web"})}),r.edui().register("click",r,function(i){o[0]===i.target||$.contains(o[0],i.target)||r.edui().hide()}),n.bind("inserttopic",function(i,t){e.execCommand("inserthtml",t),r.hide()}),n.bind("insertcustomtopic",function(){var i=$("<span>#</span>")[0],t=$("<span>#</span>")[0],n=e.selection.getRange();n.insertNode(t),n.insertNode(i),n.setStartAfter(i),n.setEndAfter(i),n.setCursor(),e.focus(),r.hide()}),o})}}});_.Module.define({path:"ueditor/widget/topic_suggestion",sub:{initial:function(t,i){t=t||window.UE,i=i||window.EditorUI,this.initPlugin(t,this),this.initLayer(i,this),this.initModel(i,this),this.initAdapter(t,i,this)},initPlugin:function(t){t.plugins.topic_suggestion=function(){function i(t,i){var e=this;this.$root=$("<div class='edui_at_box' style='display: none;'><div class='topic_sug_box_title'>\u6dfb\u52a0\u4ec0\u4e48\u8bdd\u9898?</div><ul class='topic_list_sug'></ul></div>").appendTo(t),this.$list=this.$root.children("ul"),this.$list.on({mouseenter:function(){e.setFocus(this)},click:function(){e.hide(),i(e.getValue())}},"li"),this.shown=!1}function e(t){var i=t.selection.getRange();if(i.collapsed){var e=$("<span class='topic_suggestion'>#</span>")[0];i.setStart(i.startContainer,i.startOffset-1).select().deleteContents().insertNode(e).setStart(e,1).collapse(!0).select(),t.topicBox.show(e),t.topicBox.loadSuggestion()}}function s(i){var e=o.selection.getRange(),s=o.selection.getStart(),n=t.dom.domUtils.findParent(s,function(t){return $(t).is(".topic_suggestion")&&"SPAN"==t.tagName},!0);e.setStartAfter(n).collapse(!0).select(),o.execCommand("inserthtml","#"+i+"#"),t.dom.domUtils.remove(n)}var o=this;i.prototype={loadSuggestion:function(t){var i,e=this;void 0==t&&(t=""),$.browser.msie&&(t=t.replace(decodeURIComponent("%E2%80%8B"),"")),$.ajax({type:"GET",url:"/hottopic/browse/topicList?prefix="+t}).done(function(s){i=""==t?s.data.bang_topic.topic_list.slice(0,8):s.data.sug_topic.topic_list.slice(0,5);for(var o=i.length,n="",c=0;o>c;c++)n=n+"<li>"+i[c].topic_name+"</li>";e.$list.html(n),e.first()})},clearList:function(){this.$list.html("")},isShown:function(t){return t?this.shown&&this.target==t:this.shown},show:function(t){t!=this.target&&this.clearList(),this.target=t,this.shown=!0;var i=$(t).position();this.$root.css({left:i.left,top:i.top+16}).show()},hide:function(){this.$root.hide(),this.shown=!1},first:function(){this.setFocus(this.$list.children(":first"))},last:function(){this.setFocus(this.$list.children(":last"))},next:function(){var t=this.$list.children(".focus");0==t.size()?this.first():t.index()==this.$list.children().size()-1?this.first():this.setFocus(t.next())},prev:function(){var t=this.$list.children(".focus");0==t.size()?this.last():0==t.index()?this.last():this.setFocus(t.prev())},setFocus:function(t){$(t).siblings(".focus").removeClass("focus").end().addClass("focus")},getValue:function(){var t=this.$list.find(".focus").text();return t}};var n=!1,c=null;o.addListener("ready",function(){o.topicBox=new i(o.$body.parent(),s)}),o.addListener("keydown",function(t,i){if(o.topicBox.isShown()){var e=!1;switch(i.keyCode){case 38:o.topicBox.prev(),e=!0;break;case 40:o.topicBox.next(),e=!0;break;case 13:var a=o.topicBox.getValue();o.topicBox.hide(),s(a),e=!0;break;case 32:o.topicBox.hide()}if(e)return i.preventDefault&&i.preventDefault(),!1}else 16==i.keyCode&&(clearTimeout(c),n=!0)}),o.addListener("keyup",function(t,i){51==i.keyCode&&n?e(this):16==i.keyCode&&(c=setTimeout(function(){n=!1},100))}),o.addListener("contentchange",function(){var i=o.selection.getRange();if(i.collapsed){var e=o.selection.getStart(),s=t.dom.domUtils.findParent(e,function(t){return"topic_suggestion"==t.className},!0);s?this.topicBox.isShown(s)&&this.topicBox.loadSuggestion($(s).text().substring(1)):this.topicBox.isShown()&&this.topicBox.hide()}}),o.getSmileyNum=function(){return $(o.body).find(".BDE_Smiley").size()}}},initLayer:function(){},initModel:function(){},initAdapter:function(){}}});_.Module.define({path:"ueditor/widget/fullscreen",sub:{initial:function(e,t){e=e||window.UE,t=t||window.EditorUI,this.initPlugin(e,this),this.initLayer(t,this),this.initModel(t,this),this.initAdapter(e,t,this)},initPlugin:function(){},initLayer:function(e){e.registerLayer("fullscreen",function(){})},initModel:function(e){e.registerModel("fullscreen",function(){var t=new e.EditorModel;e.bindLayer("fullscreen",t);var i=$.eduibutton({icon:"fullscreen",title:"\u5168\u5c4f"});return self.$bodywrap&&self.$bodywrap.length?self.$bodywrap:self.$body,t.setButton(i),t})},initAdapter:function(e,t){e.registerUI("fullscreen",function(e){function i(){$("html").addClass("tb-ueditor-fullscreen"),a?r.resize(500,h.fullscreenHeight):r.resize(708,g.fullscreenHeight),r.disableHeightLimit(),c.trigger("onSetFullScreen")}function l(e){$("html").removeClass("tb-ueditor-fullscreen"),a?r.resize(500,h.defaultHeight):r.resize(708,g.defaultHeight),r.enableHeightLimit(),c.trigger("restored.draft"),c.removeClass("edui-toolbar-fixed"),e||($("body").scrollTop($("body").outerHeight()),$("html").scrollTop($("body").outerHeight()))}function n(){var e=$(".j_title").val(),t=Math.ceil($.tb.getByteLength(e)/2);d.html(t>30?30:t),setTimeout(function(){n()},1e3)}var r=this,o=t.getModel(e),s=o.getButton(),u=!1,c=(r.$bodywrap&&r.$bodywrap.length?r.$bodywrap:r.$body,r.$container),a=(c.find(".edui-toolbar"),!1),d=$(".j-fullscreen-wl"),f=$(".j_submit"),h={fullscreenWidth:500,defaultWidth:500,fullscreenHeight:260,defaultHeight:50},g={fullscreenWidth:980,defaultWidth:690,fullscreenHeight:350,defaultHeight:220};return s.click(function(){u?($.stats.track("\u70b9\u51fb\u5168\u5c4f\u6309\u94ae-\u590d\u539f","\u65b0\u53d1\u8d34\u4f18\u5316\u7edf\u8ba1","frs","click"),f.data("fullscreen","\u9ed8\u8ba4"),l()):($.stats.track("\u70b9\u51fb\u5168\u5c4f\u6309\u94ae-\u5168\u5c4f","\u65b0\u53d1\u8d34\u4f18\u5316\u7edf\u8ba1","frs","click"),f.data("fullscreen","\u5168\u5c4f"),i()),u=!u,$.stats.track("fullscreen_btn","ueditor")}),$("#tb_rich_poster_container").on("scroll",function(e){if(u){var t=e.target.scrollTop;t>125?c.addClass("edui-toolbar-fixed"):c.removeClass("edui-toolbar-fixed")}}),c.on("setbackground",function(e,t){a="bubble"===t}),$(".j_clear_fullscreen").on("click",function(){l(),r.focus()}),r.commands.clearfullscreen={execCommand:function(){u&&l(!0)}},n(),r.ready(function(){var e=$(".j_title"),t=e.val(),i=Math.ceil($.tb.getByteLength(t)/2);d.html(i>30?30:i)}),o.getButton()})}}});

}
/*
     FILE ARCHIVED ON 14:11:57 Nov 17, 2020 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 08:30:53 Feb 18, 2021.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
*/
/*
playback timings (ms):
  exclusion.robots: 0.376
  captures_list: 656.318
  esindex: 0.017
  CDXLines.iter: 80.861 (3)
  PetaboxLoader3.resolve: 214.451 (3)
  LoadShardBlock: 568.092 (3)
  load_resource: 353.462 (2)
  exclusion.robots.policy: 0.36
  PetaboxLoader3.datanode: 181.176 (5)
  RedisCDXSource: 1.233
*/